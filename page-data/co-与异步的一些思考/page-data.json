{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/co-与异步的一些思考","result":{"data":{"post":{"__typename":"MdxPost","slug":"/co-与异步的一些思考","title":"co 与异步的一些思考","date":"19.03.2020","tags":[{"name":"SourceCode","slug":"source-code"},{"name":"Thinking","slug":"thinking"},{"name":"Async","slug":"async"}],"description":"通过对 co 源码的探索，进一步思考，得到异步解决方案的本质思路，一切竟然如此简单","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"co 与异步的一些思考\",\n  \"date\": \"2020-03-19T00:00:00.000Z\",\n  \"author\": \"ahabhgk\",\n  \"description\": \"通过对 co 源码的探索，进一步思考，得到异步解决方案的本质思路，一切竟然如此简单\",\n  \"tags\": [\"SourceCode\", \"Thinking\", \"Async\"]\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"JavaScript \\u7684\\u5F02\\u6B65\\u7F16\\u7A0B\\u53D1\\u5C55\\u7ECF\\u8FC7\\u4E86\\u56DB\\u4E2A\\u9636\\u6BB5\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u56DE\\u8C03\\u51FD\\u6570\\u3001\\u53D1\\u5E03\\u8BA2\\u9605\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Promise\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"co \\u81EA\\u6267\\u884C\\u7684 Generator \\u51FD\\u6570\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"async / await\"))), mdx(\"p\", null, \"\\u7B2C\\u4E09\\u9636\\u6BB5\\u73B0\\u5728\\u57FA\\u672C\\u4E0D\\u7528\\u4E86\\uFF0C\\u4F46\\u4E5F\\u8D77\\u5230\\u4E86\\u627F\\u4E0A\\u542F\\u4E0B\\u7684\\u4F5C\\u7528\"), mdx(\"h2\", null, \"\\uD83D\\uDCDD co \\u6E90\\u7801\"), mdx(\"p\", null, \"co \\u63A5\\u6536\\u4E00\\u4E2A generator \\u51FD\\u6570\\uFF0C\\u8FD4\\u56DE\\u4E00\\u4E2A promise\\uFF0Cgenerator \\u51FD\\u6570\\u4E2D yieldable \\u5BF9\\u8C61\\u6709\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"promises\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"thunks (functions)\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"array (parallel execution)\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"objects (parallel execution)\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"generators (delegation)\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"generator functions (delegation)\"))), mdx(\"p\", null, \"\\u5176\\u4E2D array \\u548C objects \\u662F\\u5E76\\u884C\\u6267\\u884C\\u7684\\uFF0C\\u91CC\\u9762\\u7684\\u503C\\u4ECD\\u7136\\u662F promise \\u548C thunk \\u51FD\\u6570\\uFF0C\\u800C generators \\u548C generator functions \\u662F\\u901A\\u8FC7\\u4EE3\\u7406\\u6267\\u884C\\uFF0C\\u5185\\u90E8\\u518D\\u6B21\\u8C03\\u7528 co\\uFF0C\\u6240\\u4EE5\\u7B80\\u5355\\u6765\\u8BF4\\u90FD\\u662F\\u57FA\\u4E8E promise \\u548C thunk \\u51FD\\u6570\\u7684\\uFF0C\\u800C co \\u5185\\u90E8\\u5BF9\\u4E8E thunk \\u7684\\u5904\\u7406\\u662F\\u628A thunk \\u4E5F\\u8F6C\\u5316\\u6210 promise\\uFF0C\\u6240\\u4EE5\\u76F4\\u63A5\\u770B\\u5BF9\\u4E8E yield \\u4E00\\u4E2A promise \\u7684 generator \\u600E\\u4E48\\u81EA\\u52A8\\u6267\\u884C\"), mdx(CodeWave, {\n    mdxType: \"CodeWave\"\n  }, mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"function* gen() {\\n  const foo = yield Promise.resolve(1)\\n  const bar = yield Promise.resolve(2)\\n  console.log(foo)\\n  console.log(bar)\\n}\\n\")), mdx(\"p\", null, \"\\u8FD9\\u91CC\\u6211\\u4EEC\\u5199\\u4E00\\u4E2A GeneratorFunction\\uFF0C\\u6BCF\\u6B21\\u90FD yield \\u51FA\\u4E00\\u4E2A promise\\uFF0C\\u6211\\u4EEC\\u5982\\u4F55\\u8BA9\\u8FD9\\u6BB5\\u4EE3\\u7801\\u4EE5\\u7C7B\\u4F3C\\u540C\\u6B65\\u7684\\u6267\\u884C\\u65B9\\u5F0F\\u4ECE\\u4E0A\\u5230\\u4E0B\\u6267\\u884C\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"const gen = gen()\\ng.next()\\n\")), mdx(\"p\", null, \"\\u5148\\u5F97\\u5230\\u4E00\\u4E2A generator\\uFF0C\\u7136\\u540E next\\uFF0C\\u6B64\\u65F6 generatorFunction \\u6267\\u884C\\u5230 yield \\u5904\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"const gen = gen()\\ng.next().value.then((data) => {\\n  // next\\n})\\n\")), mdx(\"p\", null, \"\\u8FD4\\u56DE\\u7684\\u7ED3\\u679C\\u7684 value \\u662F yield \\u51FA\\u6765\\u7684 promise \\u5BB9\\u5668\\u5305\\u88F9\\u7684\\u6570\\u503C 1\\uFF0C\\u90A3\\u4E48 then \\u65B9\\u6CD5\\u7684 callback \\u7684\\u53C2\\u6570\\u5C31\\u662F 1\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"const gen = gen()\\ng.next().value.then((data) => {\\n  g.next(data)\\n})\\n\")), mdx(\"p\", null, \"\\u4E3A\\u4E86\\u8BA9 yield \\u5DE6\\u8FB9\\u7684\\u53D8\\u91CF foo \\u5F97\\u5230\\u5F02\\u6B65\\u4EE3\\u7801\\u7684\\u7ED3\\u679C\\uFF0C\\u6211\\u4EEC\\u53EA\\u9700\\u8981\\u628A data \\u901A\\u8FC7 generator \\u7684 next \\u65B9\\u6CD5\\u4F20\\u5165\\u5C31\\u53EF\\u4EE5\\u4E86\\uFF0C\\u540C\\u65F6 generatorFunction \\u7684\\u63A7\\u5236\\u6743\\u4E5F\\u56DE\\u5230 generatorFunction \\u624B\\u4E2D\\uFF0CgeneratorFunction \\u7EE7\\u7EED\\u6267\\u884C\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"const gen = gen()\\ng.next().value.then((data) => {\\n  g.next(data).value.then((data) => {\\n    g.next(data)\\n  })\\n})\\n\")), mdx(\"p\", null, \"\\u4E4B\\u540E\\u518D\\u6B21 yield \\u51FA promise \\u7684\\u5F02\\u6B65\\u64CD\\u4F5C\\uFF0C\\u4EA4\\u51FA\\u63A7\\u5236\\u6743\\uFF0C\\u540C\\u6837\\u7684\\u901A\\u8FC7 next \\u8FD4\\u56DE\\u7ED3\\u679C\\u548C\\u63A7\\u5236\\u6743\\u8BA9 generatorFunction \\u7EE7\\u7EED\\u6267\\u884C\\uFF0C\\u8FD9\\u6837\\u5C31\\u5B9E\\u73B0\\u4E86\\u5305\\u542B\\u5F02\\u6B65\\u64CD\\u4F5C\\u7684 generatorFunction \\u7684\\u540C\\u6B65\\u6267\\u884C\")), mdx(\"p\", null, \"\\u5728\\u76F4\\u63A5\\u5957\\u7528 co \\u6E90\\u7801\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"function co(gen) {\\n  // ...\\n  return new Promise((resolve, reject) => {\\n    const g = gen()\\n\\n    const gResult = g.next() // \\u7B2C\\u4E00\\u6B21 next\\n    if (gResult.done) resolve(gResult.value)\\n    if (gResult.value && isPromise(gResult.value)) {\\n      value.then((res) => {\\n\\n        const gResult = g.next(res) // \\u7B2C\\u4E8C\\u6B21 next\\n        if (gResult.done) resolve(gResult.value)\\n        if (gResult.value && isPromise(gResult.value)) {\\n          value.then((res) => {\\n\\n            const gResult = g.next(res) // \\u7B2C\\u4E09\\u6B21 next\\uFF0Cdone \\u4E3A true\\n            if (gResult.done) resolve(gResult.value) // resolve \\u6389 generator \\u4E2D return \\u7684\\u7ED3\\u679C\\n          })\\n        }\\n      })\\n    }\\n  })\\n}\\n\")), mdx(\"p\", null, \"\\u5728\\u770B co \\u6574\\u4F53\\u4EE3\\u7801\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"function co(gen) {\\n  var ctx = this; // \\u90A3 this\\uFF0C\\u4E00\\u822C\\u662F co.call \\u8FD9\\u6837\\u8C03\\u7528\\n  var args = slice.call(arguments, 1) // generator \\u7684\\u53C2\\u6570\\u53EF\\u4EE5\\u5728 gen \\u540E\\u9762\\u4F20\\u5165\\n\\n  return new Promise(function(resolve, reject) {\\n    // \\u68C0\\u67E5 gen\\n    if (typeof gen === 'function') gen = gen.apply(ctx, args); // \\u666E\\u901A\\u51FD\\u6570\\u5C31\\u4F1A\\u8C03\\u7528\\u5F97\\u5230\\u8FD4\\u56DE\\u503C\\uFF0C\\u4E0B\\u4E00\\u884C resolve \\u8FD4\\u56DE\\u503C\\n    if (!gen || typeof gen.next !== 'function') return resolve(gen);\\n\\n    onFulfilled();\\n\\n    function onFulfilled(res) {\\n      var ret;\\n      try {\\n        ret = gen.next(res);\\n      } catch (e) { // try / catch \\u505A\\u9519\\u8BEF\\u6355\\u83B7\\n        return reject(e);\\n      }\\n      next(ret);\\n    }\\n\\n    function onRejected(err) {\\n      var ret;\\n      try {\\n        ret = gen.throw(err);\\n      } catch (e) {\\n        return reject(e);\\n      }\\n      next(ret);\\n    }\\n\\n    function next(ret) {\\n      if (ret.done) return resolve(ret.value);\\n      var value = toPromise.call(ctx, ret.value); // \\u628A\\u5176\\u4ED6\\u7684 yieldable \\u8F6C\\u5316\\u6210 promise\\n      if (value && isPromise(value)) return value.then(onFulfilled, onRejected);\\n      return onRejected(new TypeError('You may only yield a function, promise, generator, array, or object, '\\n        + 'but the following object was passed: \\\"' + String(ret.value) + '\\\"'));\\n    }\\n  });\\n}\\n\")), mdx(\"p\", null, \"\\u5176\\u4E2D toPromise \\u9488\\u5BF9\\u4E0D\\u540C\\u7684 yieldable \\u8FDB\\u884C xxxToPromise\\uFF0CarrayToPromise \\u662F\\u901A\\u8FC7 Promise.all(value.map(toPromise)) \\u8FDB\\u884C\\u8F6C\\u6362\\uFF0CobjectToPromise \\u7B49\\u5F85\\u5BF9\\u8C61\\u7684\\u6240\\u6709\\u7684\\u503C\\u90FD resolve \\u540E\\uFF0C\\u5E76\\u6DFB\\u52A0\\u5230\\u65B0\\u7684\\u5BF9\\u8C61\\u4E2D\\uFF0C\\u7136\\u540E\\u518D resolve\\uFF0C\\u7C7B\\u4F3C\\u4E8E Promise.all\"), mdx(\"p\", null, \"thunkToPromise \\u7C7B\\u4F3C\\u4E8E\\u4E00\\u822C Node.js \\u7684 API \\u7684 promisify\\uFF0C\\u53EA\\u4E0D\\u8FC7\\u662F thunk \\u51FD\\u6570\\u5DF2\\u7ECF\\u4F20\\u5165\\u4E86\\u7B2C\\u4E00\\u4E2A\\u53C2\\u6570\\uFF0Cpromisify \\u65F6\\u53EA\\u9700\\u8981\\u4F20\\u5165\\u53E6\\u4E00\\u4E2A\\u53C2\\u6570\\u5C31\\u53EF\\u4EE5\\u4E86\\uFF0C\\u6211\\u4EEC\\u4E5F\\u53EF\\u4EE5\\u770B\\u51FA\\u8FD9\\u91CC thunk \\u662F\\u9488\\u5BF9 Node.js \\u7684 API \\u7684\\uFF0C\\u4E0E curry \\u7684\\u4E0D\\u540C\\u5728\\u4E8E thunk \\u662F\\u5206\\u4E3A\\u4E24\\u6B21\\u53C2\\u6570\\u4F20\\u5165\\u7684\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"function thunkToPromise(fn) {\\n  var ctx = this;\\n  return new Promise(function (resolve, reject) {\\n    fn.call(ctx, function (err, res) {\\n      if (err) return reject(err);\\n      if (arguments.length > 2) res = slice.call(arguments, 1);\\n      resolve(res);\\n    });\\n  });\\n}\\n\")), mdx(\"p\", null, \"isPromise \\u7684\\u5224\\u65AD\\u4E5F\\u662F\\u901A\\u8FC7\\u67E5\\u770B\\u53C2\\u6570\\u7684 then \\u662F\\u4E0D\\u662F\\u4E00\\u4E2A\\u51FD\\u6570\\uFF0C\\u4F53\\u73B0\\u4E86\\u9E2D\\u5B50\\u7C7B\\u578B\\u7684\\u7279\\u70B9\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"function isPromise(obj) {\\n  return 'function' == typeof obj.then;\\n}\\n\")), mdx(\"h2\", null, \"\\u2699\\uFE0F \\u539F\\u7406\"), mdx(\"p\", null, \"co \\u7684\\u539F\\u7406\\u5176\\u5B9E\\u662F\\u901A\\u8FC7 generator.next() \\u5F97\\u5230 generatorResult\\uFF0C\\u7531\\u4E8E yield \\u51FA\\u662F\\u4E00\\u4E2A promise\\uFF0C\\u901A\\u8FC7 generatorResult.value.then \\u518D\\u628A promise \\u7684\\u7ED3\\u679C\\u901A\\u8FC7 generator.next \\u7684\\u53C2\\u6570\\u4F20\\u7ED9 yield \\u7684\\u5DE6\\u8FB9\\uFF0C\\u8BA9 generator \\u81EA\\u52A8\\u6267\\u884C\\uFF0C\\u901A\\u8FC7 generatorResult.done \\u5224\\u65AD\\u662F\\u5426\\u6267\\u884C\\u7ED3\\u675F\"), mdx(\"h2\", null, \"\\uD83E\\uDD14 \\u5BF9\\u4E8E JavaScript \\u5F02\\u6B65\\u7684\\u601D\\u8003\"), mdx(\"h3\", null, \"3.1 raw callback\"), mdx(\"p\", null, \"\\u6211\\u4EEC\\u770B\\u6700\\u5F00\\u59CB\\u6700\\u6734\\u7D20\\u7684 raw callback\\uFF0C\\u662F\\u5C06 callback \\u4EA4\\u7ED9\\u53E6\\u4E00\\u4E2A\\u51FD\\u6570\\u6267\\u884C\\uFF0C\\u4E5F\\u5C31\\u662F\\u8BF4\\u6211\\u4EEC\\u628A callback \\u7684\\u63A7\\u5236\\u6743\\u4EA4\\u7ED9\\u8FD9\\u4E2A\\u51FD\\u6570\\uFF0C\\u8FD9\\u4E2A\\u51FD\\u6570\\u5728\\u8FDB\\u884C\\u5B8C\\u5F02\\u6B65\\u64CD\\u4F5C\\u4E4B\\u540E\\u8C03\\u7528 callback\\uFF0C\\u4EE5\\u6B64\\u5B9E\\u73B0\\u5F02\\u6B65\"), mdx(\"h3\", null, \"3.2 Promise callback\"), mdx(\"p\", null, \"\\u800C\\u4E4B\\u540E promise \\u4E5F\\u662F\\u901A\\u8FC7\\u4F20\\u5165 callback \\u7684\\u65B9\\u5F0F\\uFF0C\\u53EA\\u4E0D\\u8FC7\\u628A\\u4E4B\\u524D\\u5D4C\\u5957\\u5F0F\\u7684\\u5F62\\u5F0F\\u5C55\\u5F00\\u6210\\u94FE\\u5F0F\\uFF0C\\u5176\\u5B9E\\u901A\\u8FC7\\u94FE\\u8868\\u4E3A\\u51FD\\u6570\\u589E\\u52A0 next \\u5C5E\\u6027\\uFF0C\\u4E5F\\u53EF\\u4EE5\\u4F7F\\u5D4C\\u5957\\u5F0F\\u5C55\\u5F00\\u6210\\u94FE\\u5F0F\"), mdx(\"p\", null, \"promise \\u901A\\u8FC7\\u5B8C\\u6210\\u5F02\\u6B65\\u64CD\\u4F5C\\u540E\\u8FDB\\u884C resolve \\u6216 reject\\uFF0C\\u6765\\u63A7\\u5236 callback \\u7684\\u6267\\u884C\\uFF0C\\u800C\\u4E14\\u63D0\\u4F9B\\u4E86 then \\u8FD4\\u56DE\\u4E00\\u4E2A promise \\u7684\\u81EA\\u52A8\\u8FDB\\u884C flat\\uFF08flatMap\\uFF09\\uFF0C\\u5B9E\\u73B0\\u4E86 then \\u4E2D\\u7EE7\\u7EED\\u6267\\u884C\\u5F02\\u6B65\\u7684\\u64CD\\u4F5C\\uFF0C\\u6240\\u4EE5\\u63D0\\u4F9B callback \\u53C2\\u6570\\u5BF9\\u4E8E promise \\u6765\\u8BF4\\u4E5F\\u662F\\u4E00\\u79CD\\u63A7\\u5236\\u6743\\u7684\\u8F6C\\u79FB\\uFF0C\\u53EA\\u4E0D\\u8FC7\\u662F\\u4ECE\\u4EE5\\u524D\\u76F4\\u63A5\\u7684\\u51FD\\u6570\\u8C03\\u7528\\u6539\\u6210\\u4E86 resolve\\u3001reject \\u63A7\\u5236 callback \\u7684\\u8C03\\u7528\\u65F6\\u673A\"), mdx(\"p\", null, \"\\u540C\\u65F6\\u662F\\u4E00\\u79CD\\u6807\\u51C6\\u7684\\u5B9E\\u73B0\\u4E5F\\u76F8\\u8F83\\u4E8E\\u539F\\u6765\\u7684 raw callback \\u4FDD\\u8BC1\\u4E86\\u5185\\u90E8\\u7684\\u53EF\\u63A7\\u6027\\u4E0E\\u5B89\\u5168\\u6027\"), mdx(\"h3\", null, \"3.3 co + Generator\"), mdx(\"p\", null, \"GeneratorFunction \\u5F97\\u5230\\u7684 Generator \\u53EF\\u4EE5\\u901A\\u8FC7 next \\u6253\\u65AD GeneratorFunction \\u7684\\u6267\\u884C\\uFF0C\\u7531\\u4E8E\\u53EA\\u80FD\\u901A\\u8FC7 Generator \\u8C03\\u7528 next \\u628A GeneratorFunction \\u7684\\u6267\\u884C\\u6743\\u8FD8\\u7ED9 GeneratorFunction\\uFF0C\\u6240\\u4EE5\\u79F0\\u4F5C\\u201C\\u534A\\u534F\\u7A0B\\u201D\"), mdx(\"p\", null, \"\\u901A\\u8FC7\\u4FDD\\u5B58 GeneratorFunction \\u7684\\u6267\\u884C\\u4E0A\\u4E0B\\u6587\\uFF0C\\u4F7F GeneratorFunction \\u53EF\\u4E2D\\u65AD\\u6267\\u884C\\uFF0C\\u4ECE\\u800C\\u628A GeneratorFunction \\u63A7\\u5236\\u6743\\u4EA4\\u7ED9 Generator\\uFF0CGenerator \\u62FF\\u5230\\u63A7\\u5236\\u6743\\u540E\\u901A\\u8FC7 yield \\u51FA\\u6765\\u7684 promise \\u5B8C\\u6210\\u5F02\\u6B65\\u64CD\\u4F5C\\uFF0C\\u7B49 resolve \\u4E4B\\u540E\\u518D\\u901A\\u8FC7 then \\u4E2D\\u8C03\\u7528 next \\u628A\\u5F02\\u6B65\\u7684\\u7ED3\\u679C\\u548C GeneratorFunction \\u7684\\u63A7\\u5236\\u6743\\u4EA4\\u7ED9 GeneratorFunction\\uFF0C\\u4EE5\\u7EE7\\u7EED\\u6267\\u884C yield \\u540E\\u7684\\u64CD\\u4F5C\"), mdx(\"h3\", null, \"3.4 async / await\"), mdx(\"p\", null, \"async \\u51FD\\u6570\\u662F\\u5BF9 GeneratorFunction + co \\u7684\\u8BED\\u4E49\\u5316\\u548C\\u6807\\u51C6\\u5316\\u7684\\u8BED\\u6CD5\\u7CD6\"), mdx(\"p\", null, \"\\u4FBF\\u6377\\u6027\\u63D0\\u5347\\u7684\\u540C\\u65F6\\u4E5F\\u610F\\u5473\\u7740\\u7075\\u6D3B\\u6027\\u7684\\u51CF\\u5C11\\uFF0C\\u7531\\u4E8E async / await \\u662F\\u8BED\\u6CD5\\uFF0C\\u800C promise\\u3001callback \\u662F\\u5BF9\\u8C61\\uFF0C\\u5BF9\\u8C61\\u53EF\\u4EE5\\u5230\\u5904\\u4F20\\u9012\\uFF0CReact \\u4E5F\\u901A\\u8FC7 throw \\u4E00\\u4E2A promise \\u5982\\u6B64 creative and hacking \\u7684\\u6A21\\u62DF\\u4E86 \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://overreacted.io/algebraic-effects-for-the-rest-of-us/\"\n  }), \"Algebraic Effects\"), \" \\u5B9E\\u73B0 Suspense\"), mdx(\"p\", null, \"\\u540C\\u65F6 Promise \\u548C GeneratorFunction \\u4E5F\\u76F8\\u5BF9\\u4E8E raw callback \\u7EA6\\u675F\\uFF0CPromise \\u662F onFulfilled\\u3001onRejected \\u7684\\u7EA6\\u675F\\uFF0CGeneratorFunction \\u662F next\\u3001done \\u7684\\u7EA6\\u675F\\uFF0CNode.js APIs \\u4E2D\\u4E5F\\u9650\\u5236\\u4E86 cb \\u7684\\u53C2\\u6570\\uFF0C\\u6240\\u4EE5\\u4E5F\\u80FD\\u88AB\\u7EDF\\u4E00\\u7684 thunk \\u5316\\uFF0C\\u8FD9\\u79CD\\u7EA6\\u675F\\u7C7B\\u4F3C\\u4E8E\\u8BED\\u6CD5\\u7CD6\\uFF0C\\u89C4\\u8303\\u7684\\u540C\\u65F6\\u4E5F\\u4E27\\u5931\\u4E86\\u4E9B\\u8BB8\\u7075\\u6D3B\\u6027\"), mdx(\"h3\", null, \"3.5 RxJS\"), mdx(\"p\", null, \"// TODO: RxJS \\u4E0E async \\u533A\\u522B\\uFF0CRxJS \\u7406\\u5FF5\\u7B49\"), mdx(\"h3\", null, \"3.6 \\uD83D\\uDD11 the keys\"), mdx(\"p\", null, \"\\u5F02\\u6B65\\u7684\\u5173\\u952E\\u5C31\\u5728\\u4E8E\\u8C03\\u7528 callback \\u7684\\u65F6\\u673A\\uFF0C\\u56E0\\u4E3A\\u6211\\u4EEC\\u4E0D\\u77E5\\u9053\\u5F02\\u6B65\\u64CD\\u4F5C\\u9700\\u8981\\u591A\\u5C11\\u65F6\\u95F4\\uFF0C\\u6211\\u4EEC\\u81EA\\u7136\\u4E5F\\u5C31\\u4E0D\\u77E5\\u9053\\u4F55\\u65F6\\u8C03\\u7528\\u5F02\\u6B65\\u4E4B\\u540E\\u7684\\u64CD\\u4F5C\\uFF0C\\u6240\\u4EE5\\u6211\\u4EEC\\u901A\\u8FC7 callback \\u5C06\\u4E4B\\u540E\\u64CD\\u4F5C\\u7684\\u63A7\\u5236\\u6743\\u4EA4\\u7ED9\\u5F02\\u6B65\\u64CD\\u4F5C\\uFF0C\\u5B9E\\u73B0\\u63A7\\u5236\\u53CD\\u8F6C\\uFF0C\\u5728\\u5F02\\u6B65\\u64CD\\u4F5C\\u5B8C\\u6210\\u4E4B\\u540E\\u81EA\\u52A8\\u8C03\\u7528 callback\\uFF0C\\u5C31\\u5B8C\\u6210\\u4E86\\u5728\\u5408\\u9002\\u7684\\u65F6\\u673A\\u8FDB\\u884C\\u5408\\u9002\\u7684\\u64CD\\u4F5C\"), mdx(\"h2\", null, \"ref\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://es6.ruanyifeng.com/#docs/generator-async\"\n  }), \"Generator \\u51FD\\u6570\\u7684\\u5F02\\u6B65\\u5E94\\u7528\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://zhuanlan.zhihu.com/p/83965949\"\n  }), \"100 \\u884C\\u4EE3\\u7801\\u5B9E\\u73B0 Promises/A+ \\u89C4\\u8303\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://staltz.com/javascript-getter-setter-pyramid.html\"\n  }), \"JAVASCRIPT GETTER-SETTER PYRAMID\")));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"JavaScript 的异步编程发展经过了四个阶段： 回调函数、发布订阅 Promise co 自执行的 Generator 函数 async / await 第三阶段现在基本不用了，但也起到了承上启下的作用 📝 co 源码 co 接收一个 generator…","timeToRead":2,"banner":null}},"pageContext":{"slug":"/co-与异步的一些思考","formatString":"DD.MM.YYYY"}}}