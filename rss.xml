<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Minimal Blog - @lekoarts/gatsby-theme-minimal-blog]]></title><description><![CDATA[ahabhgk's blog, for code, for love, for life.]]></description><link>https://ahabhgk.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Sun, 22 Mar 2020 12:22:49 GMT</lastBuildDate><item><title><![CDATA[co 与异步的一些思考]]></title><link>https://ahabhgk.github.io/co-与异步的一些思考</link><guid isPermaLink="false">https://ahabhgk.github.io/co-与异步的一些思考</guid><pubDate>Wed, 18 Mar 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;JavaScript 的异步编程发展经过了四个阶段：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;回调函数、发布订阅&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Promise&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;co 自执行的 Generator 函数&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;async / await&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;第三阶段现在基本不用了，但也起到了承上启下的作用&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;📝 co 源码&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;co 接收一个 generator 函数，返回一个 promise，generator 函数中 yieldable 对象有：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;promises&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;thunks (functions)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;array (parallel execution)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;objects (parallel execution)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;generators (delegation)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;generator functions (delegation)&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;其中 array 和 objects 是并行执行的，里面的值仍然是 promise 和 thunk 函数，而 generators 和 generator functions 是通过代理执行，内部再次调用 co，所以简单来说都是基于 promise 和 thunk 函数的，而 co 内部对于 thunk 的处理是把 thunk 也转化成 promise，所以直接看对于 yield 一个 promise 的 generator 怎么自动执行&lt;/p&gt;&lt;style data-emotion-css=&quot;zj4xys&quot;&gt;.css-zj4xys{width:100%;margin-top:40px;margin-left:0;margin-bottom:40px;position:relative;display:block;}@media screen and (min-width:640px){.css-zj4xys{width:960px;margin-left:calc(50% - 480px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}&lt;/style&gt;&lt;div class=&quot;css-zj4xys&quot;&gt;&lt;style data-emotion-css=&quot;1nb27sf&quot;&gt;.css-1nb27sf{width:100vw;margin-left:calc(50% - 50vw);position:-webkit-sticky;position:sticky;top:0;z-index:1;height:50vh;}@media screen and (min-width:640px){.css-1nb27sf{width:50%;margin-left:0;position:static;top:auto;z-index:auto;height:auto;}}&lt;/style&gt;&lt;div class=&quot;css-1nb27sf&quot;&gt;&lt;div style=&quot;height:100%;width:100%&quot;&gt;&lt;style data-emotion-css=&quot;1ulb8t5&quot;&gt;.css-1ulb8t5{position:static;width:100%;height:100%;top:auto;border:none;border-color:var(--theme-ui-colors-secondary,#5f6c80);}@media screen and (min-width:640px){.css-1ulb8t5{position:-webkit-sticky;position:sticky;height:60vh;top:20vh;border:1px solid;}}&lt;/style&gt;&lt;div class=&quot;css-1ulb8t5&quot;&gt;&lt;div style=&quot;overflow:auto;height:100%;width:100%&quot;&gt;&lt;div style=&quot;overflow:auto;height:100%;width:100%&quot;&gt;&lt;div class=&quot;cs-container&quot; style=&quot;width:100%;height:100%;max-height:100%;position:relative&quot;&gt;&lt;style data-emotion-css=&quot;e4qd9l&quot;&gt;.css-e4qd9l{color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);}.css-e4qd9l .token-comment,.css-e4qd9l .token-cdata,.css-e4qd9l .token-doctype{font-style:italic;}.css-e4qd9l .token-builtin,.css-e4qd9l .token-changed,.css-e4qd9l .token-keyword,.css-e4qd9l .token-punctuation,.css-e4qd9l .token-operator,.css-e4qd9l .token-tag,.css-e4qd9l .token-deleted,.css-e4qd9l .token-string,.css-e4qd9l .token-attr-value,.css-e4qd9l .token-char,.css-e4qd9l .token-number,.css-e4qd9l .token-inserted{color:var(--theme-ui-colors-primary,#6b46c1);}&lt;/style&gt;&lt;pre class=&quot;cs-content css-e4qd9l&quot; style=&quot;margin:0;height:100%;overflow:hidden&quot;&gt;&lt;style data-emotion-css=&quot;o6vt5y&quot;&gt;.css-o6vt5y{color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);}&lt;/style&gt;&lt;code class=&quot;cs-scaled-content css-o6vt5y&quot; style=&quot;display:block;height:100%;transform:scale(1);transform-origin:center 0px&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;transform:translateX(250px);height:0;opacity:0&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-0&quot;&gt;&lt;span class=&quot;token-keyword&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; gen &lt;/span&gt;&lt;span class=&quot;token-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-function&quot;&gt;gen&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;height:100px;opacity:1;transform:translateX(0px)&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-9&quot;&gt;&lt;span class=&quot;token-keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token-operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-function&quot;&gt;gen&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;height:100px;opacity:1;transform:translateX(0px)&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-10&quot;&gt;&lt;span class=&quot;token-plain&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;token-keyword&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; foo &lt;/span&gt;&lt;span class=&quot;token-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-keyword&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-known-class-name&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;height:100px;opacity:1;transform:translateX(0px)&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-11&quot;&gt;&lt;span class=&quot;token-plain&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;token-keyword&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; bar &lt;/span&gt;&lt;span class=&quot;token-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-keyword&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-known-class-name&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;height:100px;opacity:1;transform:translateX(0px)&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-12&quot;&gt;&lt;span class=&quot;token-plain&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;token-console&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;height:100px;opacity:1;transform:translateX(0px)&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-13&quot;&gt;&lt;span class=&quot;token-plain&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;token-console&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-14&quot;&gt;&lt;span class=&quot;token-punctuation&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:auto;height:100%;width:100%&quot;&gt;&lt;div class=&quot;cs-container&quot; style=&quot;width:100%;height:100%;max-height:100%;position:relative&quot;&gt;&lt;pre class=&quot;cs-content css-e4qd9l&quot; style=&quot;margin:0;height:100%;overflow:hidden&quot;&gt;&lt;code class=&quot;cs-scaled-content css-o6vt5y&quot; style=&quot;display:block;height:100%;transform:scale(1);transform-origin:center 0px&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;height:100px;opacity:1;transform:translateX(0px)&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-0&quot;&gt;&lt;span class=&quot;token-keyword&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; gen &lt;/span&gt;&lt;span class=&quot;token-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-function&quot;&gt;gen&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;transform:translateX(250px);height:0;opacity:0&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-1&quot;&gt;&lt;span class=&quot;token-plain&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-property-access&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-parameter&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-arrow&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-14&quot;&gt;&lt;span class=&quot;token-punctuation&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:auto;height:100%;width:100%&quot;&gt;&lt;div class=&quot;cs-container&quot; style=&quot;width:100%;height:100%;max-height:100%;position:relative&quot;&gt;&lt;pre class=&quot;cs-content css-e4qd9l&quot; style=&quot;margin:0;height:100%;overflow:hidden&quot;&gt;&lt;code class=&quot;cs-scaled-content css-o6vt5y&quot; style=&quot;display:block;height:100%;transform:scale(1);transform-origin:center 0px&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;opacity:0.3&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-1&quot;&gt;&lt;span class=&quot;token-plain&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-property-access&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-parameter&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-arrow&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;opacity:1&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-14&quot;&gt;&lt;span class=&quot;token-punctuation&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:auto;height:100%;width:100%&quot;&gt;&lt;div class=&quot;cs-container&quot; style=&quot;width:100%;height:100%;max-height:100%;position:relative&quot;&gt;&lt;pre class=&quot;cs-content css-e4qd9l&quot; style=&quot;margin:0;height:100%;overflow:hidden&quot;&gt;&lt;code class=&quot;cs-scaled-content css-o6vt5y&quot; style=&quot;display:block;height:100%;transform:scale(1);transform-origin:center 0px&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-1&quot;&gt;&lt;span class=&quot;token-plain&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-property-access&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-parameter&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-arrow&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;transform:translateX(250px);height:0;opacity:0&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-2&quot;&gt;&lt;span class=&quot;token-plain&quot;&gt;  g&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-property-access&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-parameter&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-arrow&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;opacity:0.3&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-14&quot;&gt;&lt;span class=&quot;token-punctuation&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:auto;height:100%;width:100%&quot;&gt;&lt;div class=&quot;cs-container&quot; style=&quot;width:100%;height:100%;max-height:100%;position:relative&quot;&gt;&lt;pre class=&quot;cs-content css-e4qd9l&quot; style=&quot;margin:0;height:100%;overflow:hidden&quot;&gt;&lt;code class=&quot;cs-scaled-content css-o6vt5y&quot; style=&quot;display:block;height:100%;transform:scale(1);transform-origin:center 0px&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-2&quot;&gt;&lt;span class=&quot;token-plain&quot;&gt;  g&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-property-access&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token-method&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token-parameter&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-arrow&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;token-plain&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token-punctuation&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)&quot;&gt;&lt;div style=&quot;display:inline-block&quot; class=&quot;cs-line cs-line-14&quot;&gt;&lt;span class=&quot;token-punctuation&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;style data-emotion-css=&quot;1nws0ue&quot;&gt;.css-1nws0ue{-webkit-flex:1;-ms-flex:1;flex:1;padding-left:0;padding-top:50px;}@media screen and (min-width:640px){.css-1nws0ue{padding-left:50px;padding-top:0;}}&lt;/style&gt;&lt;div class=&quot;scroller css-1nws0ue&quot;&gt;&lt;style data-emotion-css=&quot;oecwa5&quot;&gt;.css-oecwa5{position:relative;padding:0;min-height:250px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-left:none;}@media screen and (min-width:640px){.css-oecwa5{padding:0 10px;border-left:3px solid transparent;}}&lt;/style&gt;&lt;div class=&quot;css-oecwa5&quot;&gt;&lt;style data-emotion-css=&quot;16nu9xf&quot;&gt;.css-16nu9xf{position:absolute;left:-12px;background-color:var(--theme-ui-colors-primary,#6b46c1);}@media screen and (min-width:640px){.css-16nu9xf{left:-3px;}}&lt;/style&gt;&lt;div style=&quot;top:0%;bottom:0%;width:3px&quot; class=&quot;css-16nu9xf&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这里我们写一个 GeneratorFunction，每次都 yield 出一个 promise，我们如何让这段代码以类似同步的执行方式从上到下执行&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;css-oecwa5&quot;&gt;&lt;div style=&quot;top:0%;bottom:100%&quot; class=&quot;css-16nu9xf&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;先得到一个 generator，然后 next，此时 generatorFunction 执行到 yield 处&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;css-oecwa5&quot;&gt;&lt;div style=&quot;top:0%;bottom:100%&quot; class=&quot;css-16nu9xf&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;返回的结果的 value 是 yield 出来的 promise 容器包裹的数值 1，那么 then 方法的 callback 的参数就是 1&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;css-oecwa5&quot;&gt;&lt;div style=&quot;top:0%;bottom:100%&quot; class=&quot;css-16nu9xf&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;为了让 yield 左边的变量 foo 得到异步代码的结果，我们只需要把 data 通过 generator 的 next 方法传入就可以了，同时 generatorFunction 的控制权也回到 generatorFunction 手中，generatorFunction 继续执行&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;css-oecwa5&quot;&gt;&lt;div style=&quot;top:0%;bottom:100%&quot; class=&quot;css-16nu9xf&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;之后再次 yield 出 promise 的异步操作，交出控制权，同样的通过 next 返回结果和控制权让 generatorFunction 继续执行，这样就实现了包含异步操作的 generatorFunction 的同步执行&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在直接套用 co 源码：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在看 co 整体代码：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;其中 toPromise 针对不同的 yieldable 进行 xxxToPromise，arrayToPromise 是通过 Promise.all(value.map(toPromise)) 进行转换，objectToPromise 等待对象的所有的值都 resolve 后，并添加到新的对象中，然后再 resolve，类似于 Promise.all&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;thunkToPromise 类似于一般 Node.js 的 API 的 promisify，只不过是 thunk 函数已经传入了第一个参数，promisify 时只需要传入另一个参数就可以了，我们也可以看出这里 thunk 是针对 Node.js 的 API 的，与 curry 的不同在于 thunk 是分为两次参数传入的&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;isPromise 的判断也是通过查看参数的 then 是不是一个函数，体现了鸭子类型的特点&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;⚙️ 原理&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;co 的原理其实是通过 generator.next() 得到 generatorResult，由于 yield 出是一个 promise，通过 generatorResult.value.then 再把 promise 的结果通过 generator.next 的参数传给 yield 的左边，让 generator 自动执行，通过 generatorResult.done 判断是否执行结束&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;🤔 对于 JavaScript 异步的思考&lt;/h2&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;3.1 raw callback&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;我们看最开始最朴素的 raw callback，是将 callback 交给另一个函数执行，也就是说我们把 callback 的控制权交给这个函数，这个函数在进行完异步操作之后调用 callback，以此实现异步&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;3.2 Promise callback&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;而之后 promise 也是通过传入 callback 的方式，只不过把之前嵌套式的形式展开成链式，其实通过链表为函数增加 next 属性，也可以使嵌套式展开成链式&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;promise 通过完成异步操作后进行 resolve 或 reject，来控制 callback 的执行，而且提供了 then 返回一个 promise 的自动进行 flat（flatMap），实现了 then 中继续执行异步的操作，所以提供 callback 参数对于 promise 来说也是一种控制权的转移，只不过是从以前直接的函数调用改成了 resolve、reject 控制 callback 的调用时机&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;同时是一种标准的实现也相较于原来的 raw callback 保证了内部的可控性与安全性&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;3.3 co + Generator&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;GeneratorFunction 得到的 Generator 可以通过 next 打断 GeneratorFunction 的执行，由于只能通过 Generator 调用 next 把 GeneratorFunction 的执行权还给 GeneratorFunction，所以称作“半协程”&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过保存 GeneratorFunction 的执行上下文，使 GeneratorFunction 可中断执行，从而把 GeneratorFunction 控制权交给 Generator，Generator 拿到控制权后通过 yield 出来的 promise 完成异步操作，等 resolve 之后再通过 then 中调用 next 把异步的结果和 GeneratorFunction 的控制权交给 GeneratorFunction，以继续执行 yield 后的操作&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;3.4 async / await&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;async 函数是对 GeneratorFunction + co 的语义化和标准化的语法糖&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;便捷性提升的同时也意味着灵活性的减少，由于 async / await 是语法，而 promise、callback 是对象，对象可以到处传递，React 也通过 throw 一个 promise 如此 creative and hacking 的模拟了 &lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://overreacted.io/algebraic-effects-for-the-rest-of-us/&quot; class=&quot;css-1od09yo&quot;&gt;Algebraic Effects&lt;/a&gt; 实现 Suspense&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;同时 Promise 和 GeneratorFunction 也相对于 raw callback 约束，Promise 是 onFulfilled、onRejected 的约束，GeneratorFunction 是 next、done 的约束，Node.js APIs 中也限制了 cb 的参数，所以也能被统一的 thunk 化，这种约束类似于语法糖，规范的同时也丧失了些许灵活性&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;3.5 RxJS&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;// TODO: RxJS 与 async 区别，RxJS 理念等&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;3.6 🔑 the keys&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;异步的关键就在于调用 callback 的时机，因为我们不知道异步操作需要多少时间，我们自然也就不知道何时调用异步之后的操作，所以我们通过 callback 将之后操作的控制权交给异步操作，实现控制反转，在异步操作完成之后自动调用 callback，就完成了在合适的时机进行合适的操作&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;ref&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;https://es6.ruanyifeng.com/#docs/generator-async&quot; class=&quot;css-1od09yo&quot;&gt;Generator 函数的异步应用&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/83965949&quot; class=&quot;css-1od09yo&quot;&gt;100 行代码实现 Promises/A+ 规范&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;https://staltz.com/javascript-getter-setter-pyramid.html&quot; class=&quot;css-1od09yo&quot;&gt;JAVASCRIPT GETTER-SETTER PYRAMID&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Koa2 源码分析]]></title><link>https://ahabhgk.github.io/koa-2-源码分析</link><guid isPermaLink="false">https://ahabhgk.github.io/koa-2-源码分析</guid><pubDate>Wed, 11 Mar 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Koa 由 express 同一个团队打造，目的是代替 express 成为下一代 Node.js 后端框架，Koa 由于十分简洁，其实更适合做一些框架的基础（egg.js、think.js），如今看来并不能代替 express，express 本身自带一些中间件支持，基于 express 编写的 nest 更是大而全，结合 TypeScript 写起来真的爽，虽然 Koa 用的人不如 express 多，但 Koa 确实有其进步的地方：支持 &lt;code class=&quot;css-0&quot;&gt;async/await&lt;/code&gt; 的异步中间件机制&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;本文由创建服务开始，讲述了 &lt;code class=&quot;css-0&quot;&gt;new Koa()&lt;/code&gt; 到 &lt;code class=&quot;css-0&quot;&gt;app.listen&lt;/code&gt; Koa 所做的事，再由一条 http 请求详细介绍了 Koa 异步中间件机制，之后讲述对 ctx 的修改如何改动原生 req res，并带出一些 http 相关的知识，最后讲了 Koa 如何进行错误处理&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;🐣 创建服务&lt;/h2&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;1.1 new Koa() 实例化&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;继承 EventEmitter，constructor 初始化参数&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;1.2 app.use(fn) 添加中间件&lt;/h3&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如何判断一个函数是 generator 函数：&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://github.com/ljharb/is-generator-function/&quot; class=&quot;css-1od09yo&quot;&gt;is-generator-function&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;1.3 app.listen(8080) 监听端口&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;就是调用 http 创建服务的 listen，关键在于 createServer 的参数&lt;/p&gt;&lt;style data-emotion-css=&quot;1slx2ud&quot;&gt;.css-1slx2ud{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1slx2ud{font-size:1.5rem;}}@media screen and (min-width:768px){.css-1slx2ud{font-size:1.875rem;}}&lt;/style&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;1.3.1 this.callback() 返回什么&lt;/h4&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;组合中间件&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过 EventEmitter 监听 error 事件，触发 error 时用 this.onerror 处理&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;返回 handleRequest，作为 createServer 的回调函数，其中创建 ctx 然后调用自己的 handleRequest 传入 ctx 和组合好的中间件来处理请求&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;style data-emotion-css=&quot;1g1owk0&quot;&gt;.css-1g1owk0{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1g1owk0{font-size:1.25rem;}}@media screen and (min-width:768px){.css-1g1owk0{font-size:1.5rem;}}&lt;/style&gt;&lt;h5 class=&quot;css-1g1owk0&quot;&gt;1.3.1.1 this.createContext(req, res)&lt;/h5&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;创建 ctx，挂载 Koa 的 request 和 response，挂载原生的 req 和 res&lt;/p&gt;&lt;h5 class=&quot;css-1g1owk0&quot;&gt;1.3.1.2 this.handleRequest(ctx, fn)&lt;/h5&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这个可以说是第一个中间件，处理默认的 onerror 和最后用户响应的 respond&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;最后 &lt;code class=&quot;css-0&quot;&gt;fnMiddleware(ctx).then(handleResponse).catch(onerror)&lt;/code&gt; 可以看出组合的中间件返回一个 promise，之后调用 respond(ctx) 发送响应，这里 catch 是默认的错误处理&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;中间件中通过给 ctx.body 赋值，传到 respond 中，对于不存在的状态码的请求响应 res.end()，respond 对于 HEAD 请求返回 res.end()，对于字符串和 Buffer 的 body 响应 res.end(body)，对于流的 body 响应 body.pipe(res)，最后通过 JSON.stringify(body) 处理其他的形式，如果是 JSON 则 res.end(body) 返回 stringify 得 JSON，如果报错通过后面 catch 处理，同时 fnMiddleware 中其他报错也通过 catch 处理&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;🐥 一条 http 请求：Koa 核心 - 异步中间件机制&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;直接先看怎样组合中间件&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;返回一个组合后的中间件，参数也和普通的中间件一样，dispatch 返回一个 Promise.resolve，从 dispatch(0) 开始展开写得到的 fnMiddleware 就是这样的：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过 fnMiddleware(ctx) 传入 context，各个 middleware 对 ctx 上的属性进行更改添加（ctx.body、ctx.type……）由于 ctx 对象传入 middlware context 参数的值是 ctx 的地址，所以之后的 middleware 中可以得到之前 middleware 中修改后的 ctx，内部调用 &lt;code class=&quot;css-0&quot;&gt;await next()&lt;/code&gt; 就是 resolve 下一个 middleware，这样就实现了 Koa 的洋葱模型机制&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;我们发现这其实和 JS 的 FP 中 compose 很像，我们用 reduce 实现试试：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这时发现只会停顿 1 秒，然后顺序也不对，而换成官方的 compose 就一切正常，停顿两秒同时顺序正确，这是因为 reduce 和 reduceRight 是同步的，只停顿一秒是因为两个 sleep 并行了（类似 &lt;code class=&quot;css-0&quot;&gt;Promise.all([asyncFn1, asyncFn2])&lt;/code&gt;），Koa 中间件的特殊与对处理请求的进步点就在于此，不同于 express 和 redux 的中间件机制，Koa 实现的是&lt;strong class=&quot;css-0&quot;&gt;异步中间件&lt;/strong&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;同时这样也可以通过 i 来检查一个 middleware 中是否多次调用 next 的作用，Koa 没有使用这种方式也是为了保证 i 可以检查多次调用 next&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;看完中间件机制再来看 http 请求从接受到响应就简单了，this.callback 返回的就是 http.createServer 的回调函数，所以 req res 从这里接收，之后 req res 进入 createContext 挂载到 ctx 对象上，之后把组合好的 fnMiddleware 和 ctx 传入 this.handleRequest，这里处理好 onerror 和 respond 之后开始把 ctx 传入 fnMiddleware，通过开发者编写的中间件对 req res 进行真正的处理，最后处理好后通过 &lt;code class=&quot;css-0&quot;&gt;.then(() =&amp;gt; respond(ctx))&lt;/code&gt; 作出响应&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;⛅️ request response 代理原生 req res&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;我们对 ctx 上处理一般是对 ctx.request 和 ctx.response 处理，但 request response 只是对原生 req res 通过 __defineGetter__ 和 __defineSetter__ 做的代理，最终的修改还是对 req res 的修改，我们通过几处看看这层代理有什么作用&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;__defineGetter__、__defineSetter__ 并不是标准，不推荐使用&lt;/p&gt;&lt;/blockquote&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;request 的 get 方法，这里为了那请求头的字段，对 referer 和 referrer 做了兼容&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Referer 的正确拼写是 Referrer，但是写入标准的时候，不知为何，没人发现少了一个字母 r。标准定案以后，只能将错就错，所有头信息的该字段都一律错误拼写成 Referer&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;get set 中处理 req res，是开发者更方便的拿到一些数据&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;response 中 body 的处理，对于不同格式 body 的赋值，在 set 中对 type、length 等连同一起处理，方便开发者&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;response 中 redirect 的封装，context 中 cookie 的封装，提供一些封装好的方法&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;提供 toJSON 方便调试&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;其他还有在 ctx 用 &lt;a href=&quot;https://github.com/tj/node-delegates&quot; class=&quot;css-1od09yo&quot;&gt;delegate 库&lt;/a&gt;对一些常用数据直接代理到 ctx 对象上（ctx.body === ctx.response.body）&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;3.1 引出的一些 http 协议知识点&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;// TODO&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;👾 错误处理&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;官方有三种方式：&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;中间件中 &lt;code class=&quot;css-0&quot;&gt;try/catch&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;添加错误处理中间件（或使用默认的）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;处理 error 事件（默认是打 log）&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;第一种没什么好说的，第二种中默认的就是 &lt;code class=&quot;css-0&quot;&gt;this.handleRequest&lt;/code&gt; 中的 onerror，直接使用 &lt;code class=&quot;css-0&quot;&gt;const onerror = err =&amp;gt; ctx.onerror(err)&lt;/code&gt; 处理，ctx.onerrer 会用 &lt;a href=&quot;https://github.com/jshttp/statuses&quot; class=&quot;css-1od09yo&quot;&gt;statuses 库&lt;/a&gt;对 error.code 作出对应的响应信息，同时 ctx.onerror 还会触发（emit）error 事件（Application 继承 EventEmitter），app 默认的 &lt;code class=&quot;css-0&quot;&gt;on(&amp;#x27;error&amp;#x27;, this.onerror)&lt;/code&gt; 是对错误信息打 log&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一般默认的就够用了，如果有其他需求可以修改 app.onerror 或添加错误中间件处理&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这里相当于在第一个中间件 catch 之后中间件的错误，在 respond 之前处理好错误然后通过 respond 响应，错误就不会被之后 &lt;code class=&quot;css-0&quot;&gt;.catch&lt;/code&gt; 抓住，以此覆盖默认的 onerror&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;🌊 One more thing --- 流&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;http 请求非常适合看作一个流，Koa 中 use 的中间件相当于一个管道，对 ctx 流的数据进行处理，处理完后 respond&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;结合 RxJS 的伪代码：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当然非常不完整，只是一个想法的体现，其实已经有人实现了用 RxJS 的后端框架：&lt;a href=&quot;https://github.com/marblejs/marble&quot; class=&quot;css-1od09yo&quot;&gt;marblejs&lt;/a&gt;，当然我们还是要结合实际进行选择&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;🥳 结语&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用 TypeScript 实现了一个简易版的 Koa，删减了很多 ctx 对 request response 的处理，只体现了核心思路，感兴趣可以看看：&lt;a href=&quot;https://github.com/ahabhgk/js-koa-core&quot; class=&quot;css-1od09yo&quot;&gt;js-koa-core&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过看 Koa 源码同时简单看了看相关依赖的库的源码，也算对以前不理解的地方有了更清晰的理解&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;以前对 cookie、etag 什么的不知道到底怎么写的，现在发现其实就是对 node 的 req res 的修改，当然 node 底层也做了很多，但也算在一定抽象层次上明白了后端其实是对 req res 的处理，同时作出 side effect，复杂时就需要处理复杂情况&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;还用中间件机制为什么 compose 与 FP 常写的 compose 很不一样，还有 i 对多次调用 next 的检查真的非常巧妙，真的非常佩服 TJ 大神&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《7 周 7 语言》- Ruby]]></title><link>https://ahabhgk.github.io/读《-7-周-7-语言》-ruby</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-7-周-7-语言》-ruby</guid><pubDate>Wed, 26 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1cr8ha5&quot;&gt;.css-1cr8ha5{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:2.25rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1cr8ha5{font-size:3rem;}}@media screen and (min-width:768px){.css-1cr8ha5{font-size:4rem;}}&lt;/style&gt;&lt;h1 class=&quot;css-1cr8ha5&quot;&gt;Ruby&lt;/h1&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;解释执行&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;无需声明变量&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;每条代码都有返回值&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;纯面向对象，“真一切皆为对象”&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;简洁的判断语句：&lt;code class=&quot;css-0&quot;&gt;order.calculate_tax unless order.nil?&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;鸭子类型&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;符号&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;代码块（匿名函数）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;yield 代码块&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&amp;amp;block 闭包&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;类&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Mixin 多继承：Java 通过接口实现，Ruby 通过 Mixin，先定义类的主要部分，然后用模块添加额外功能&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可枚举（枚举模块）：让类可枚举，必须实现 each&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可比较（比较模块）：让类可比较，必须实现 &amp;lt;=&amp;gt;&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;元编程：写能写程序的程序&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;开放类：可以对类重新定义&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;method_missing：找不到默方法时调用，可以复写 method_missing 方法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;动态的改变类：模块被另一模块包含，Ruby 就会调用该模块的 included 方法，类也是模块&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;think&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;自由（有点像 JS 中修改原型，但平时更多是限制的）&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《7 周 7 语言》- Io]]></title><link>https://ahabhgk.github.io/读《-7-周-7-语言》-io</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-7-周-7-语言》-io</guid><pubDate>Wed, 26 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1cr8ha5&quot;&gt;.css-1cr8ha5{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:2.25rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1cr8ha5{font-size:3rem;}}@media screen and (min-width:768px){.css-1cr8ha5{font-size:4rem;}}&lt;/style&gt;&lt;h1 class=&quot;css-1cr8ha5&quot;&gt;Io&lt;/h1&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Io 语法只不过把消息全部串联起来，每个消息都返回一个对象，每条消息都也都带有括号内的可选参数
Io 中，一切皆为消息，且每条消息都会返回另一条接受消息的对象
Io 没有类，只需要与对象打交道，必要时把对象复制一下就行，这些被复制的对象叫原型，原型语言中，每个对象都不是类的复制品，而是一个实实在在的对象&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;所有事物都是对象，对由于对象交互的都是消息&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;消息：左边的是对象，右边的是消息，把消息发给对象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;原型&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;List&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Map&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;true false nil 都是单例&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;条件和循环&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;运算符&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;消息：由 sender target arguments 组成&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;DSL&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;🤣做 XOR&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;解析 JSON&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;method_missing：编写简易 HTML&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Io 中的 method_missing 是类的 forward&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;JavaScript 中通过模版字符串实现类似功能&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;并发&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://iolanguage.org/guide/guide.html#Concurrency&quot; class=&quot;css-1od09yo&quot;&gt;Io 并发&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;异步消息：@ 前缀的消息返回 future，@@ 前缀的消息返回 nil 并在自身上下文中触发消息&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;协程：“轻量级线程”&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可以想象成带有多个入口和出口的函数，每次 yield 都会保存当前上下文，并把控制权交给另一上下文当中&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;actor：能接收消息并基于其执行运算，也可以发送消息给其他 Actor。Actors 之间相互隔离，它们之间并不共享内存&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一个 actor 只能改变自身的状态，并通过严格的队列接触其他 actor，而线程可以不受限制的改变彼此状态，有竞争条件的并发问题&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Io 中发送异步消息的对象就是 actor&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;future：@ 调用消息时返回，一段时间后会变成结果值，如果未产生结果是使用 future 就会阻塞直到产生结果&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;类似于 JavaScript 中的 async/await（async/await 通过 Promise 实现，但写法上 future 更像 async/await）&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;think&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;占用空间小，容易安装&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对象与消息，简单强大&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;简洁的语法，Lisp + OOP&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;很自由，DSL 能力强大&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;先进的并发模型&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;性能不行&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;社区太太太太小&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《7 周 7 语言》- Prolog]]></title><link>https://ahabhgk.github.io/读《-7-周-7-语言》-prolog</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-7-周-7-语言》-prolog</guid><pubDate>Wed, 26 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1cr8ha5&quot;&gt;.css-1cr8ha5{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:2.25rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1cr8ha5{font-size:3rem;}}@media screen and (min-width:768px){.css-1cr8ha5{font-size:4rem;}}&lt;/style&gt;&lt;h1 class=&quot;css-1cr8ha5&quot;&gt;Prolog&lt;/h1&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;逻辑编程语言，不是通过算法来解决逻辑问题&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;基本构造单元：事实、规则、查询&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;常量小写开头，变量大写开头&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;例：地图着色&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;递归&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;列表长度可变 &lt;code class=&quot;css-0&quot;&gt;[1, 2, 3]&lt;/code&gt;，元组长度不可变 &lt;code class=&quot;css-0&quot;&gt;(1, 2, 3)&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;例：八皇后、数独&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;think&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;strong class=&quot;css-0&quot;&gt;逻辑&lt;/strong&gt;编程&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- RxJS 驱动 React]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-rx-js-驱动-react</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-rx-js-驱动-react</guid><pubDate>Fri, 21 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用 Subject 类似 EventBus 实现数据交互&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Rx 实现 Redux&lt;/h2&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 掌握时间的 Scheduler]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-掌握时间的-scheduler</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-掌握时间的-scheduler</guid><pubDate>Thu, 20 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据结构：它知道如何根据优先级或其他条件存储和排队任务&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;执行环境：表示执行任务的位置和时间（例如同步、宏任务、微任务、下一动画帧）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;虚拟时钟：通过 Scheduler 上的 now 提供“时间”的概念，在特定的任务将仅遵守该时钟指示的时间&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 多播]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-多播</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-多播</guid><pubDate>Wed, 19 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;多播就是让一个数据流的内容被多个 Observer 订阅&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Subject&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;BehaviorSubject&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;ReplaySubject&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;AsyncSubject&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;数据流的多播&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;单播&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;多播&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;广播&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;广播会影响全局环境，筛选消息的责任在接收方，同时多个广播时容易混乱，所以 RxJS 不支持多播&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Cold Observable 无法实现多播，每次订阅都会是彼此之间不同的 Observable 对象&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Hot 数据流&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;fromPromise、fromEvent、fromEventPattern 产生 Hot Observable，这些数据源都来自外部（DOM、Promise、EventPattern、WebSocket……），与 Observable 无关&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Hot Observable 实现多播，但有时 Cold Observable 也需要实现多播，这时就需要 Subject，将 Cold Observable 变为 Hot Observable&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Subject&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;为了保证 RxJS 的 Immutable 特性，Cold Observable 转换为 Hot Observable 时不能改变本身，而是产生一个新的对象，这个对象订阅 Cold Observable，同时被订阅，所以 Subject 需要有订阅和被订阅的能力（是一个 Observable 同时是一个 Observer，因此 &lt;code class=&quot;css-0&quot;&gt;next*(error|complete)?&lt;/code&gt;）&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;实现多播&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Subject 可以有多个上游&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;new Subject 得到的是一个有 next、error、compete 方法的对象，同时具有 subscribe 方法进行订阅，对于 observer 的那三个方法就类似发布者一样，依次通知所有的订阅者，所以对于上游的数据 subject 实例只是调用那三个方法依次通知订阅者，不论是那个上游&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Subject 错误处理&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Observable 内部类似这样处理 subscribe，忽略了一些其他的逻辑&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这里 observer 就是 subject，subject 内部使用类似 &lt;code class=&quot;css-0&quot;&gt;this.observers.forEach((ob) =&amp;gt; ob.next(data))&lt;/code&gt; 处理数据&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;subject 就是一个转接头，上游的数据通过 subject 传给下游&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;多播操作符&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;multicast 最基本的操作符&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;multicast 返回一个 ConnectableObservable，可以通过 connect 方法控制多播的时机&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果同步的数据流，通过 subject 实现多播，在 subject 订阅之前就订阅 subject，那就没有任何输出：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果之后订阅 subject，则会正常输出：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;此时就可以通过 connect 控制多播时机&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;但是此时如果我们退订，就需要在多个订阅者都退订后，在手动退订 subject（ConnectableObservable），这样就造成逻辑冗杂，RxJS 通过 refCount 解决这一问题，refCount 就像自动对订阅者计数一样&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;refCount makes the multicasted Observable automatically start executing when the first subscriber arrives, and stop executing when the last subscriber leaves.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;之前：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;之后：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;multicast 参数也可以是一个 SubjectFactory 函数，与直接使用 Subject 实例的区别在于，使用 refCount 自动退订 subject 后，之后再有订阅就没有用，因为 Subject 实例退订后生命周期结束，而使用工厂函数时会重新调用该函数，产生一个新的 Subject 实例&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;selector 参数：只要指定了 selector 参数，就指定了 multicast 返回的 Observable 对象的生成方法&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;publish&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;share&lt;/h3&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;高级多播，增强的 Subject&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;publishLast AsyncSubject&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;publishReplay ReplaySubject&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;publishBehavior BehaviorSubject&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;publishLast AsyncSubject&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;publishReplay ReplaySubject&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;replay 有回放的能力，只订阅一次数据源，pipe 只运行一次，把数据记录下来在吐出一遍，而 re-subscribe 是多次订阅，pipe 运行多次，把所有数据都重新产生一遍&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;tap 原来叫 do，tap 有窃听的意思，不能改变数据，但常用来触发副作用&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;publishBehavior BehaviorSubject&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;提供一个“默认数据”，当添加 Observer 的时候，即使上游还没有吐出数据 Observer 也会立即获得这个“默认数据”；而且，这个 “默认数据” 总是会被上游吐出的最新数据替代&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 异常错误处理]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-异常错误处理</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-异常错误处理</guid><pubDate>Tue, 18 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;异常处理的难点&lt;/h2&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;虽然必要，但会让代码更加复杂&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;try / catch&lt;/code&gt; 只支持同步，因为 try / catch 是同步执行，执行后里面的异步代码还没有执行，就抓不到异步代码的错误&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;因此出现 callback，通过传递 cb 参数把异步之后的逻辑传入，相应错误处理也放到异步代码内部，但是有 cbhell 问题&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;之后出现 Promise，虽然也是传入 cb 处理，但是将 cb 嵌套结构展平成链式结构，解决代码结构问题，但是设计上由于 Promise 最终转换为 fulfilled 或 rejected 态就结束了，重试的逻辑不能由 promise 本身处理&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Promise 和 Observable 同属 Monod，Promise 中的 then 相当于 map&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;RxJS 的异常处理&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在函数式编程中，&lt;code class=&quot;css-0&quot;&gt;throw new Error()&lt;/code&gt; 相当于增加了函数一个新的出口，抛出去的异常可能会导致副作用，导致函数不纯&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;同时从 caller 的角度，不仅需要处理返回值，还有处理可能的异常，这更加重了 caller 的负担&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在 $ 中，异常只会在自己的管道中处理掉，或是流到下游通过 theObserver.error 处理，不会影响其他的流或是全局的状态&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;管道中的处理分为&lt;strong class=&quot;css-0&quot;&gt;恢复&lt;/strong&gt;和&lt;strong class=&quot;css-0&quot;&gt;重试&lt;/strong&gt;：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;恢复：虽然产生了错误，但是依然让运算进行下去，比如通过 defaultValue&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;重试：要有上限，最终不行还是要用恢复&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;catchError 恢复&lt;/h3&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;selector: a function that takes as arguments err, which is the error, and caught, which is the source observable, in case you&amp;#x27;d like to &amp;quot;retry&amp;quot; that observable by returning it again. Whatever observable is returned by the selector will be used to continue the observable chain&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;用作重试：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;给 theObserver.error 处理：&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;retry 重试&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;retry&amp;lt;T&amp;gt;(count: number = -1): MonoTypeOperatorFunction&amp;lt;T&amp;gt;&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;retry 是立即执行重试的，有时需要等到某个时机再重试：&lt;strong class=&quot;css-0&quot;&gt;retryWhen&lt;/strong&gt;&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Returns an Observable that mirrors the source Observable with the exception of an error. If the source Observable calls error, this method will emit the Throwable that caused the error to the Observable returned from notifier. If that Observable calls complete or error then this method will call complete or error on the child subscription. Otherwise this method will resubscribe to the source Observable.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;同样可以抽象出延迟并有上限的重试等其他操作符&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;finalize&lt;/h3&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Callback will call a specified function when the source terminates on complete or error.&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;重试的本质&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;重新订阅，先退订然后再订阅&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 转化数据流]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-转化数据流</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-转化数据流</guid><pubDate>Mon, 17 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;转化类操作符&lt;/h2&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对每个数据进行转化，映射&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;不转化单个数据，而是把数据重新组合，比如上游传下来 1、2、3 传给下游 [1, 2, 3]，无损回压控制&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;映射&lt;/h2&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;map&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;project 中的 this 指向 thisArg，相当于一个 context 对象，当然也可以用闭包产生一个 context&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;mapTo&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;pluck&lt;/h3&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;缓存窗口：无损回压控制&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;支持数组的以 buffer 开头，支持 Observable 对象的以 window 开头&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;windowTime、bufferTime&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:44.99999999999999%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABLElEQVQoz61S2W6DMBDk/z+okdIvSCU+AUgAc4obEu7JjltXJFLfamm01l4zu7bVdR3qusa+71BKQYUKYRAgUhH8m4/ADwS+jvliwzAU/w2B5MRRhKt3lVwFz/NQlSWsZVkwz7Nu2Evzvu/RHawBY1377W/b9jdX38U2TYNpmmDhn49F9rIoUIrcz/MZSZJgGAbN3DatZv26XGDbNsbHqNdDNazL0hSnj5OMWqERf11VsNZ1BccmbrIbBtjQjMx7KoUk3bZNr8fkkyyOYyw/PsZeRqaqSlgMqLqQRmzOAh7u+gjjIxlhHQMsouL3Q5V5nmtQKS2JCE7xZ0Nao+R4zKgccRxHPO53bYlB1Bs/a18aMuC6LhzHQZ5liOSfEXwo7pF4n4D/k4/Df0m1T3rUta0o2G0eAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;windowTime&quot; title=&quot;windowTime&quot; src=&quot;/static/534d0d123fdf368868954cc378241111/7d769/windowTime.png&quot; srcSet=&quot;/static/534d0d123fdf368868954cc378241111/5243c/windowTime.png 240w,/static/534d0d123fdf368868954cc378241111/ab158/windowTime.png 480w,/static/534d0d123fdf368868954cc378241111/7d769/windowTime.png 960w,/static/534d0d123fdf368868954cc378241111/87339/windowTime.png 1440w,/static/534d0d123fdf368868954cc378241111/490f5/windowTime.png 1636w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:35%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA70lEQVQoz61S226FIBDk39v0J9p+yDnvp/0Lo3gjRkBBo8bLlN1TjTHpWzeZDCzLMAuIvu/hnEPbtkiSBFmWQSkFmUge53mONE2RZ4GlZJahrigKFGEtjmOoUiGKIlhjIeZ5BoGEjTGw1sIFcV1rNE3DsCHPHNaIjdZsoP2tI0M65KZpgsA/h/DOo65rEPtwkmuf8N5jGAZG33Xshpw0wWVZlofjcRxZaNs2hliWhVsmPo+JP98/8PbyyldBsee7cMB+Veu6HoLs8C/rVPD9+ML9dmNBmtPmXeBae7S8W73iHNQ+vXRVVfwDrm2eRX8AjeEb42XLeCcAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;bufferTime&quot; title=&quot;bufferTime&quot; src=&quot;/static/97eb9d5162af6d8edea12c1126e38d77/7d769/bufferTime.png&quot; srcSet=&quot;/static/97eb9d5162af6d8edea12c1126e38d77/5243c/bufferTime.png 240w,/static/97eb9d5162af6d8edea12c1126e38d77/ab158/bufferTime.png 480w,/static/97eb9d5162af6d8edea12c1126e38d77/7d769/bufferTime.png 960w,/static/97eb9d5162af6d8edea12c1126e38d77/87339/bufferTime.png 1440w,/static/97eb9d5162af6d8edea12c1126e38d77/490f5/bufferTime.png 1636w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;第一个参数表示缓存窗口时间长度，第二个参数表示缓存窗口创建时间间隔，第三个参数表示每个缓存窗口存的数据最大个数&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;windowCount、bufferCount&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缓存窗口长度根据数据个数&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;windowWhen、bufferWhen、windowToggle、bufferToggle&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据 Observable 控制开始结束时机&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;window、buffer&lt;/h3&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;notifer: An Observable that completes the previous window and starts a new window.&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;高阶 map&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:98.33333333333334%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAABfklEQVQ4y62U64rCMBCF8/7PVAX9oVDE2qpQxUoRxLvF+6Xq2T0Ds3RLt62ygZA0nZx8mZmMuV6vCMMQlUoFg8EA9XodvV4PzWYT7XYbrVYLtm3DdV00Gg30+33UajWxrVarGI1GsCwLQRDIXvN6vRBFERzHwWKxkA3T6RTD4VAOGo/HsmkymcD3fflHm/l8Ds/zsFqt0Ol0sF6v0e12YfDd7vc7drsd/qOJYBzH2O/3eDweoAuez6es6ZicF41yZW232w2z2UyIafCOIGFEkEIUZefP8/ks4+l0EiM1LE2odElSipD0crnIOr/fElQxJVW/0oi+pStUuGg06SglRSnI9Dgej78OKfRh1rVVWE9mWtEF6pLShFkHkGK5XOaSZhJmXTsdrO12KxmQJqVwacIk6WazEUHONV8LCYtIuZHvXp9racEsUu2Hw+EnT0laKih5okrGYNENXCtNmEdKSnYtLObd8vQXKesia6L5pOYlCbXTj4y++bSQZpHy6l8+Wx1cOaEqeQAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;HOmap&quot; title=&quot;HOmap&quot; src=&quot;/static/71ec08cf36495c81cebf65fb9dbc2ae9/7d769/HOmap.png&quot; srcSet=&quot;/static/71ec08cf36495c81cebf65fb9dbc2ae9/5243c/HOmap.png 240w,/static/71ec08cf36495c81cebf65fb9dbc2ae9/ab158/HOmap.png 480w,/static/71ec08cf36495c81cebf65fb9dbc2ae9/7d769/HOmap.png 960w,/static/71ec08cf36495c81cebf65fb9dbc2ae9/d284e/HOmap.png 1144w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;concatMap = map + concatAll&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;mergeMap = map + mergeAll&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;switchMap = map + switch&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;exhaustMap = map + exhaust&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;把 map 产生的高阶 Observable 利用对应的组合操作符合并为一阶的 Observable 对象&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;concatMap&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;拖拽：&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;mergeMap&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;其他的 Rx 和之前的版本都叫 flatMap&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;AJAX：&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;switchMap&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;flatMapLatest&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可以用来解决 AJAX 竞态问题&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;exhaustMap&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;flatMapFirst&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;高阶 mapTo&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;concatMapTo&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;mergeMapTo&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;switchMapTo&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;expand&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这个操作符类似于 mergeMap，但是，所有 expand 传递给下游的数据，同时也会传递给自己，就像是逐层“展开”所有的数据，expand构成了一个逻辑死循环，除非发生异常，或者 expand 的函数参数 project 代码中限定在某些情况下不再产生数据&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;2 的 n 次方：&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;数据分组&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;groupBy&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;groupBy 作为一个内容分发器，对上游推送的数据检测 key 值，如果 key 第一次出现，就产生一个新的 Observable 对象，否则就给相应 key 的 Observable 对象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据奇偶性分组：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:27.500000000000004%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAArUlEQVQY05WQyQrEIBBE/f//SY455FP0kkAWDWQhWw1PxkFyGGaExi7Lrio1TdOoKApZa1WWpZxzGsdRXdep7/ufaxgGtW0rM8+zqqqKInVdy3uv8zy173us4zg+e6qcy/lt22Tu+9ayLEI49ThO06R1XeP5E5M+x6QLIcRZQxoGUKdwIiX9dV0xLZdz/OSTOLNG70W6f5M9eZLGJ7NwwxmSHjf+9RvmPs9MGPEX8bvNPtClHn4AAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;groupBy&quot; title=&quot;groupBy&quot; src=&quot;/static/44a4e402bb2a7bc26a37a6636abbb657/7d769/groupBy.png&quot; srcSet=&quot;/static/44a4e402bb2a7bc26a37a6636abbb657/5243c/groupBy.png 240w,/static/44a4e402bb2a7bc26a37a6636abbb657/ab158/groupBy.png 480w,/static/44a4e402bb2a7bc26a37a6636abbb657/7d769/groupBy.png 960w,/static/44a4e402bb2a7bc26a37a6636abbb657/d284e/groupBy.png 1144w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据 key 产生的 Observable 对象是一个 GroupedObservable，有 key 属性可以分辨&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;事件委托：&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;partition&lt;/h3&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;It&amp;#x27;s like filter, but returns two Observables: one like the output of filter, and the other with values that did not pass the condition.&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;累计数据&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;之前所有操作符，上游的数据之间都不会产生影响，非常符合 FP，但是有时需要依赖之前的数据&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;scan&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;参数类似 reduce 的参数，这俩区别在于 scan 对上游每一个数据都会产生一个规约结果，而 reduce 是对上游所有数据进行规约；reduce 最多只给下游传递一个数据，如果上游数据永不完结，那 reduce 也永远不会产生数据，而 scan 完全可以处理一个永不完结的上游 Observable 对象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;scan 常用来维持应用状态&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;scan 源码中内部 acc 就是 seed，seed 的赋值同时要改变 &lt;code class=&quot;css-0&quot;&gt;private hasSeed: boolean&lt;/code&gt;，通过 &lt;code class=&quot;css-0&quot;&gt;set seed()&lt;/code&gt; 将改变 hasSeed 和 seed 赋值的逻辑进行耦合&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;mergeScan&lt;/h3&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;It&amp;#x27;s like scan, but the Observables returned by the accumulator are merged into the outer Observable.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;懒加载：&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 过滤类数据流]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-过滤类数据流</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-过滤类数据流</guid><pubDate>Sun, 16 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;过滤类操作符&lt;/h2&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;filter&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;first、last&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;take 限定上游数据数量&lt;/h3&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;takeLast&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;takeLast 只有确定上游数据完结的时候才能产生数据，而且是一次性产生所有数据&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;takeWhile&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;takeUntil&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Emits the values emitted by the source Observable until a notifier Observable emits a value.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;repeatWhen 也利用了 notifier 参数&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;作为 takeUntil 的 notifier 参数如果在吐出数据或者完结之前抛出了错误，那 takeUntil 也会把这个错误抛给下游，从而关闭了上下游之间的通道&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;skip&lt;/h3&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Returns an Observable that skips the first count items emitted by the source Observable.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:36.25%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA10lEQVQoz4WRjQ6DIAyEef9X9C8x0YyxTdCIIuqNNsMxY7JLGgr0il8V+74jDVJctdaoyhJ1XUNKia7rkOc5lFJH3dknzg3jJWldV7jZwTmHaZp4P88zvPc/D6degQtt23bk0UTNzo3OtSTR9z2apoG6KxhjGLMsCsib5DzLMhht0LZtwK8wDAPKMAbymHBffEZAtTqMRKQYMcZxZEy/eNjR8hnVWGv5SwnffTx0tiwLB+0vkf8pRU5zRn49X/wHSYRPGIRI+Bz6uxJWRKYRMHIYz0M9DuQ3FgAgsaU+3pEAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;skip&quot; title=&quot;skip&quot; src=&quot;/static/b462801a392dee3e97ae8325bd717e95/7d769/skip.png&quot; srcSet=&quot;/static/b462801a392dee3e97ae8325bd717e95/5243c/skip.png 240w,/static/b462801a392dee3e97ae8325bd717e95/ab158/skip.png 480w,/static/b462801a392dee3e97ae8325bd717e95/7d769/skip.png 960w,/static/b462801a392dee3e97ae8325bd717e95/87339/skip.png 1440w,/static/b462801a392dee3e97ae8325bd717e95/76593/skip.png 1534w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;skipWhile skipUntil&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;类似 takeWhile、takeUntil&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;回压控制&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;zip 就出现了这种问题&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有损回压控制（本章）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;无损回压控制（下一章转化数据）&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;throttle(Time)、debounce(Time)&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:34.583333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA+ElEQVQoz4VQi26EMAzr//8k03H0wZtSngW8Ojumm7RpkaqmSezaUdd14bfDCCHAOYemaXBH3COqqpL6vu9Se8cp/BHHcQhgnmds24YjRsTXWZYF67pK/zzPHzh1D7DBnENd16FNqkhEddM0CbGzToi892jbVmbrupY3c/bUmsj6vhe5WyrQJi2VZYkwBhhtpE+Q1hrjOErPGvv1CVeSSInzg4dikYoIohKqpRJrreQkYH0YBuSPx/ebBLx1oYWQPKwpLplA2qNs2iY5P7l3RiDV03587Y075s05quecWMY/QXu0aoxBnucongU+sgzPlGfp9kn5e3wC9xYeNKDXquEAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;throttle&quot; title=&quot;throttle&quot; src=&quot;/static/a5d549d17e1ecd27be02526a2acd9c29/7d769/throttle.png&quot; srcSet=&quot;/static/a5d549d17e1ecd27be02526a2acd9c29/5243c/throttle.png 240w,/static/a5d549d17e1ecd27be02526a2acd9c29/ab158/throttle.png 480w,/static/a5d549d17e1ecd27be02526a2acd9c29/7d769/throttle.png 960w,/static/a5d549d17e1ecd27be02526a2acd9c29/87339/throttle.png 1440w,/static/a5d549d17e1ecd27be02526a2acd9c29/eec6c/throttle.png 1652w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:40%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABAUlEQVQoz3WSiW6EMAxE8/9fiUALlGO572M2L6pbVKmWrIkHxx47uHmeVVWVtm3Tfd+apklJHOsrz5W+XiqKQkmSBIw9XxZliMEQl6WiKFLzfqvve7nrurTvu0AMpAkNKL6uq8ZxDGi8xeMwhHj2ecdx6DpPuWVZhD+LoQ7V8BSFo0iWZeq6Tsv8y6MqTdOAcI4OuBlj13UdEmgQOn9j5cejyemVGI9SxmZK3PEB0tzG55IloWr1hWhGPhwi4DnD/xREJuM1TRMS2AvqBo+MCbJ8VPONmDtd2wa+9Tg87jj9YzYWztnWYcqf/NMcSX8dQx2/Bwt/8jwEynL/cBS1RuYfd3lsb2LwBbwAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;debounce&quot; title=&quot;debounce&quot; src=&quot;/static/b78b8d91179caae49188e02be2d426c7/7d769/debounce.png&quot; srcSet=&quot;/static/b78b8d91179caae49188e02be2d426c7/5243c/debounce.png 240w,/static/b78b8d91179caae49188e02be2d426c7/ab158/debounce.png 480w,/static/b78b8d91179caae49188e02be2d426c7/7d769/debounce.png 960w,/static/b78b8d91179caae49188e02be2d426c7/87339/debounce.png 1440w,/static/b78b8d91179caae49188e02be2d426c7/13e26/debounce.png 1630w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;audit(Time)&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可以认为 audit 是做 throttle 类似的工作，不同的是在“节流时间”范围内，throttle 把第一个数据传给下游，audit 是把最后一个数据传给下游&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:48.33333333333333%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABP0lEQVQoz3WSi26DMAxF+f9/7GihBRIo0PIq5eHleAsCdbNkxbKvr6+TBM/nU/q+l9zmktxuUlWVdG0n1+tVxtdL0iSRx+Mh4OI4FmuswyVyc1hy2Lqu6ljQtq28XGNZlpJlmdSOkAHWWkc4SpEX0jSNgDOZkTzP1YnJfxCiCEJjjCoZhkHPxCnruk6y9GdIXdcag2Uwfe/3eyPaCFEzz7MqJMbGcVQVgKqykqEfNHe/3zVXupNh9H0QsgoF5ONxFGkjShkSR7GuSx5VRVFImqaqGMyyLEdCP4WTIhftgawECXWugXVRSjxN06bwcIfyayQgAIhx0gwxRDRTx8lR89g9abBnB7ifusUuT43YrwiZ79vbQeFfMeaJ/UDcK/Q5Hx8U/hdH7kG4Wx7pHJ4lDEN9pMvlog/EZ/86nfRnfANQxAkDABAQLQAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;audit&quot; title=&quot;audit&quot; src=&quot;/static/61800ca4b0ab24002aa98205f34e0d2d/7d769/audit.png&quot; srcSet=&quot;/static/61800ca4b0ab24002aa98205f34e0d2d/5243c/audit.png 240w,/static/61800ca4b0ab24002aa98205f34e0d2d/ab158/audit.png 480w,/static/61800ca4b0ab24002aa98205f34e0d2d/7d769/audit.png 960w,/static/61800ca4b0ab24002aa98205f34e0d2d/87339/audit.png 1440w,/static/61800ca4b0ab24002aa98205f34e0d2d/a381e/audit.png 1574w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;throttle 传了 5 个数据，audit 传了 4 个数据，因为最后一个数据在节流时间范围内完结了，audit 直接 complete&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;sample(Time)&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;sample 表示采样，与 throttle 不同在于连续的隔一段时间吐出数据，而 throttle 可能会断开&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:22.083333333333332%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAnUlEQVQY062QjQqFIAxGff9XjMBZWd7USA0So++6PUOD4UGO7kfd941931FKAQezIQPSJHfrusIuizBpjeM44LtDRJinCcYYYbdteJ4HqrUmcq1VPiy5IMaI4IMI6Txx9mQvhABu4LouYfY4vffivO8LhY9DcTVrLX7OIYaInLNUHYYBUx9nHMc+2oyUkjB35rrLrPsK+OSV8Due4g/EYDIuQYyFNAAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;sample&quot; title=&quot;sample&quot; src=&quot;/static/fecae9b3564b5408634b1a0169dfbc2f/7d769/sample.png&quot; srcSet=&quot;/static/fecae9b3564b5408634b1a0169dfbc2f/5243c/sample.png 240w,/static/fecae9b3564b5408634b1a0169dfbc2f/ab158/sample.png 480w,/static/fecae9b3564b5408634b1a0169dfbc2f/7d769/sample.png 960w,/static/fecae9b3564b5408634b1a0169dfbc2f/87339/sample.png 1440w,/static/fecae9b3564b5408634b1a0169dfbc2f/6950f/sample.png 1612w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;虽然不是连续的，但是间隔为那段时间的整数倍&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;比如对逝去时间的采样：&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;distinct 根据数据序列做回压控制&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;distinct&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;只返回从没出现过的数据&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;内部维护了一个集合 Set&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;第一个参数 Optional function to select which value you want to check as distinct，第二个参数是一个 Observable 对象，每当这个 Observable 对象产生数据时，distinct 就清空 Set，防止存的过多导致了内存泄露&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;distinctUntilChanged&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;拿到一个数据不是和一个 Set 比较，而是直接和上一个数据比较，也就是说，这个操作符要保存上游产生的上一个数据就足够，当然，也就没有了 distinct 潜在的内存泄露问题&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;也有一个可选的 compare 参数&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;其它过滤方法&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;不一定实用&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;ignoreElements&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;忽略上游产生的所有元素&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;elementAt&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;获取制定下标的那个，没有返回第二个参数（默认值）&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;single&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;检查上游是否只有一个满足对应条件的数据，如果答案为“是”，就向下游传递这个数据；如果答案为“否”，就向下游传递一个异常&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 辅助类数据流]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-辅助类数据流</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-辅助类数据流</guid><pubDate>Sat, 15 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;数学类操作符&lt;/h2&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这些操作符必定会遍历上游 Observable 对象中吐出的所有数据才给下游传递数据，也就是说，它们只有在上游完结的时候，才给下游传递唯一数据&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;count 统计数据个数&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;max、min&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;reduce 规约&lt;/h3&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;条件布尔类操作符&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;every&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;find、findIndex&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;isEmpty&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;defaultIfEmpty&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;接受一个参数做默认值，如果上游空的话会返回&lt;strong class=&quot;css-0&quot;&gt;一个&lt;/strong&gt;默认值给下游，没有没传默认值则为 null&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 合并数据流]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-合并数据流</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-合并数据流</guid><pubDate>Fri, 14 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;合并类操作符&lt;/h2&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;concat 首尾相连&lt;/h3&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;concat 先从第一个 Observable 对象获取数据，第一个 Observable 就是调用 concat 的那个对象（类似 &lt;code class=&quot;css-0&quot;&gt;[1, 2].concat([3, 4])&lt;/code&gt;），第一个 complete 之后 concat 会订阅第二个 Observable 以此类推，直至最后一个 Observable complete，concat 的 Observable 才完结&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;因此前一个 Observable 不 complete，后一个 Observable 就不会开始&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;merge 先到先得快速通过&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;merge 会同时订阅所有的上游对象，一般用于异步数据流&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;merge 同时订阅是相对于异步来说，实际上仍然是依次订阅，由于订阅 &lt;code class=&quot;css-0&quot;&gt;of(1, 2, 3)&lt;/code&gt; 后还没有来得及订阅后一个，就已经吐出数据，所以输出与 concat 一样&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有一个 concurrent: number 可选参数用来限流&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这样 source3$ 就不会进行订阅，除非 source1$ 或 source2$ complete&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;例子：因为在移动设备上 touchend 事件出现得比 click 更早，这两个事件的处理是一模一样的但是 fromEvent 不能同时获得两个事件的数据流，这时候就要借助 merge 的力量&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;zip 拉链式组合&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;就像拉链一样组合&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于步调不一致时或数量不一致时，会把提前的自动延后，多的删减成少的&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:52.083333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFklEQVQoz42S64qEMAyFff83nAXxhzBe1rvVTr1l/IKFDuzKBEJiPE3OSRsdxyF/OWbGUdq2Va/rWuMwDNL3vZRlKdZaxXk8MZIbA7Btm+z7Ls45db7XddWcusd5j5jC9HmedWKeZVJXlTJomkaKolBm2fMpxpiPIb55qCqi6CcDQhLNx1MuA2gyTZN0XSfLsuihsCEeKrqVTEP2RWQAOV5dCvDqt9IaKojKkANMhz6Rmj/sXk7ZmdEojjXAGBWsg9wzhbXusKkbBfMTJvMZ8zzXw3a2msPAN2HAdGHaExPareRv7eOWw0Jo0Pe1/3Jkhm9QG0Ld3954PVpqSZJImqa6CvLsfE7U4ziW8pTN7f88HvoqwoZvkmEMMkVW+H4AAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;zip&quot; title=&quot;zip&quot; src=&quot;/static/cb8544845fbd3f413158f5e1e49b65fe/7d769/zip.png&quot; srcSet=&quot;/static/cb8544845fbd3f413158f5e1e49b65fe/5243c/zip.png 240w,/static/cb8544845fbd3f413158f5e1e49b65fe/ab158/zip.png 480w,/static/cb8544845fbd3f413158f5e1e49b65fe/7d769/zip.png 960w,/static/cb8544845fbd3f413158f5e1e49b65fe/c1ff3/zip.png 1168w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据积压问题：如果一个吐出速度过慢，zip 会保存吐出速度过快的数据，等待另一个吐出数据，这时如果保存数据量过大，就会占用大量内存，zip 自身解决不了，会有其他方式解决&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;combineLatest 合并最后一个数据&lt;/h3&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Whenever any input Observable emits a value, it computes a formula using the latest values from all the inputs, then emits the output of that formula.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:62.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABV0lEQVQ4y61T2XKEQAj0/79RLY/y1tX1vlmaBDOmUps8hCoWGaCXZhiLWM7zvClkXVdK05SiKKKiKCiJEwrDkKqqIt/3yfd8yvOcgiCgOI5p33epsxTAFJwBcNs2WpZFvmHneZYz2Gma5BzfsCoWfoCORNW+76UA59B5YiAuOo7jAtGYCQpfAB/VQ+jBAixgSqCK76ZphB5od10nlG3bpmfzFD9JEs4PJG8cxw/KUPy7SdkchRn7yTdzLXoj3+f7DugCxCFooHVY0GjbVhRUsiwT6qDoeR7VdS0+RuCzjzzU3CibN2gqEhAzffP24Wvsdin/KRbWA90t83J1o130TGXm+DAMkjP0n5Z91Ol6wb86xHpkaSazqsqvGcI6vB54Ba7jyKtwXZfKshSb8Zphpojj5aAG4H+irAuty6wLrbNf2d5u+TfVFUHX6AhdyntmdWxH3rOu1AswJPN29WE6KAAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;combineLatest&quot; title=&quot;combineLatest&quot; src=&quot;/static/f596efc030f5aaf729e510f274e37e9e/7d769/combineLatest.png&quot; srcSet=&quot;/static/f596efc030f5aaf729e510f274e37e9e/5243c/combineLatest.png 240w,/static/f596efc030f5aaf729e510f274e37e9e/ab158/combineLatest.png 480w,/static/f596efc030f5aaf729e510f274e37e9e/7d769/combineLatest.png 960w,/static/f596efc030f5aaf729e510f274e37e9e/87339/combineLatest.png 1440w,/static/f596efc030f5aaf729e510f274e37e9e/27584/combineLatest.png 1624w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于同步的，类似于 merge&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;最后一个参数可以是一个 resultSelector 函数，相当于 &lt;code class=&quot;css-0&quot;&gt;.pipe(map(/* codes */))&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于多重依赖的 source，就像 cpp 中的多重继承一样，会出现一些反常识的问题&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:46.666666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABF0lEQVQoz12SiwqDMAxF9///qHagoKD2qfjOcuMi3Qqh7TXNPU19EY91XclaSyklauqGvPcUQpBwzlHTNM8+xkjjOFJd1xS/GsI7TykmeqHgcRw0z/NdmJOxP89TYts21qysVUceiuaazlJwWZaH0Bhzk4QoNI71N2uyZx05wzCQqSohUurAt8I3KagOCFzxnxCa7q/rEsJcy+MhhCvcqrJ6XOEIQtBgrxpyy7KUteo4k3iWgnBVSqDnNDsTosCPtu+3xvl69iGES9/30mQ4mcrIK+tLj3ywKIr7Nb+aFWojRbV/aIG8ct6//LXgjEAPQZTfQtdoleb+9PB/TNNEbdvS0A/iDHoQ49fCYRB2XSczeozvmGH+Ab9ruK+00xK/AAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;combineLatest-glitch&quot; title=&quot;combineLatest-glitch&quot; src=&quot;/static/d759a2e3cf1411b6094ec73fc3d10a05/7d769/combineLatest-glitch.png&quot; srcSet=&quot;/static/d759a2e3cf1411b6094ec73fc3d10a05/5243c/combineLatest-glitch.png 240w,/static/d759a2e3cf1411b6094ec73fc3d10a05/ab158/combineLatest-glitch.png 480w,/static/d759a2e3cf1411b6094ec73fc3d10a05/7d769/combineLatest-glitch.png 960w,/static/d759a2e3cf1411b6094ec73fc3d10a05/87339/combineLatest-glitch.png 1440w,/static/d759a2e3cf1411b6094ec73fc3d10a05/27584/combineLatest-glitch.png 1624w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果想要纯正的输出，可以使用 withLatestFrom&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;withLatestFrom&lt;/h3&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Whenever the source Observable emits a value, it computes a formula using that value plus the latest values from other input Observables, then emits the output of that formula.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:59.166666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABS0lEQVQoz62T2W6DQAxF+f//awJ9CBJbQtj3JEDcOW4nUhGV8tCRLuMxtrnXHhwx6/l8/kLXdVKVpVyvV0We54rS+M7nszweD9nLAw6P7VqW5YW+73W3flvsr+XwWNdVA9u2lbIo9DwMgyRJIvM8yzRNcrlcXnHWf7/f1cZnz1oQR13XUphiBCAZqf7JV4bYn54nVVVJmqbiHo9qZ1kmh4+DNE2jZKixK3m7brebMiaJXsKYD1GIIruSSaJHnUki0AbDuq7qbxY/fot2E8tHtSD6SRzHUXsVx7EkBnEU6R7pnugZOwojCcNQ24MdGTsIAm2NI/+8HNghF9hpAXpE42nD0A+qAD8q8iwXm8dgyAM6ZRK5KiTTA4CPafq+rwWwPTNl3lHAcz2N4aK7rqu3AtDLtyUzuLck7/0+9iohl18NubCEHYAJDPfyvgAz5aIKROqeCwAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;withLatestFrom&quot; title=&quot;withLatestFrom&quot; src=&quot;/static/27b2d70e1a6d89176e5a0d1e62306e27/7d769/withLatestFrom.png&quot; srcSet=&quot;/static/27b2d70e1a6d89176e5a0d1e62306e27/5243c/withLatestFrom.png 240w,/static/27b2d70e1a6d89176e5a0d1e62306e27/ab158/withLatestFrom.png 480w,/static/27b2d70e1a6d89176e5a0d1e62306e27/7d769/withLatestFrom.png 960w,/static/27b2d70e1a6d89176e5a0d1e62306e27/87339/withLatestFrom.png 1440w,/static/27b2d70e1a6d89176e5a0d1e62306e27/27584/withLatestFrom.png 1624w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;所以如果要合并完全独立的 Observable 对象，使用 combineLatest，如何要把一个Observable对象“映射”成新的数据流，同时要从其他 Observable 对象获取“最新数据”，就是用 withLatestFrom&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;race 胜者通吃&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;startWith&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;startWith 的所有参数都是同步吐出的，如果需要异步吐出参数，那还是只能利用 concat&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;forkJoin&lt;/h3&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;高阶 Observable&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;HO$::$ -&amp;gt; $&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;每产生一个数据，就对应产成一个 $&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:30.83333333333333%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAnklEQVQY052QQQrEIAxFvf+BehZx3Y0Lq1Kr1VYz/EDKMAsLE/j4SeIzUfXeKaVExhhyzpHWmhDI/yPVWqN1XWlZFobiFOB93yzx13U9uV+hBin6ClwcY/DEIYQH5r2n4zi4B/WZlJhaK4NyzhRj5PVLKXSeJ3vU0Pe6srwqAYCAtm1jGDwmtNbyOQMrgcmk8l/wmBYAad73nTeZrf4BrTLVTt66towAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;HO$&quot; title=&quot;HO$&quot; src=&quot;/static/7b3412ff8e7dbe2da06c93067d2e37e2/7d769/HO%24.png&quot; srcSet=&quot;/static/7b3412ff8e7dbe2da06c93067d2e37e2/5243c/HO%24.png 240w,/static/7b3412ff8e7dbe2da06c93067d2e37e2/ab158/HO%24.png 480w,/static/7b3412ff8e7dbe2da06c93067d2e37e2/7d769/HO%24.png 960w,/static/7b3412ff8e7dbe2da06c93067d2e37e2/601e5/HO%24.png 1146w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;HO$ 的意义&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;用 Observable 来管理多个 Observable&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据流管理的是数据，但数据流本身也可以看作一种数据，使 Observable 对象通过 Observable 对象来管理&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;过程对数据进行抽象，同时过程也是数据，通过高阶过程对过程进行抽象&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;操作高阶 Observable 的合并类操作符&lt;/h3&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;concatAll&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Flattens an Observable-of-Observables by putting one inner Observable after the other.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:12.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAfElEQVQI112OuwrFIBBE/f8vs9TCwi6kjYopfMXHXHYh4SYDwzC7Z2HFdV243XtHKQXOObTWuJNjjDjP8+m11hdDt2MMZgQtjuNghxCwbRuklNj3nTvNtdYwxsB7zyZGKcV5M5TWWgh8NOfkj9ZazyylhJzzi6Fv/hkSMT/kD+YI7dUujAAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;concatAll&quot; title=&quot;concatAll&quot; src=&quot;/static/e37ff88d5612bd8de13e245df4d4dc76/7d769/concatAll.png&quot; srcSet=&quot;/static/e37ff88d5612bd8de13e245df4d4dc76/5243c/concatAll.png 240w,/static/e37ff88d5612bd8de13e245df4d4dc76/ab158/concatAll.png 480w,/static/e37ff88d5612bd8de13e245df4d4dc76/7d769/concatAll.png 960w,/static/e37ff88d5612bd8de13e245df4d4dc76/601e5/concatAll.png 1146w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当第一个 Observable 对象完结的时候，才会去订阅第二个内部 Observable 对象。虽然高阶 Observable 对象已经产生了第二个 Observable 对象，不代表 concatAll 会立刻去订阅它&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;mergeAll&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Flattens an Observable-of-Observables.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:12.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAgElEQVQI122OywrEIBRD+/9/1m1BQdqNWx+liljfGa7QYRgaOJDFvUmWUgoeaq1IKcEYg5wzrLWIMcI5B+89QghQSoE0xnhloWet9eQ8T0gpsa4r9n0HYwxCCGzbBs45juOYnkpaa98Rvyz4U+8d13VNT6voiALu+54BVPosfNMHI9vm9a+DMFgAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;mergeAll&quot; title=&quot;mergeAll&quot; src=&quot;/static/408ff5d07e9144a823698dd54e138336/7d769/mergeAll.png&quot; srcSet=&quot;/static/408ff5d07e9144a823698dd54e138336/5243c/mergeAll.png 240w,/static/408ff5d07e9144a823698dd54e138336/ab158/mergeAll.png 480w,/static/408ff5d07e9144a823698dd54e138336/7d769/mergeAll.png 960w,/static/408ff5d07e9144a823698dd54e138336/601e5/mergeAll.png 1146w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;zipAll&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:18.333333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAg0lEQVQY032OSwoDIRBEvay3cOctBo/l0r2DqAO68DNohRYSSGJS8BZddFU3a61hRykF3nvknNF7R60V53kunzTG2MJCCIgxvqD5ui6klGCMWTOVUpnWeu1Q8L7vL+gwww8dxwHOOYQQcM4tj76cc+KfGC18QlJKrTIpJay1b6Fd5skD1wwwchMZ7HgAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;zipAll&quot; title=&quot;zipAll&quot; src=&quot;/static/57b267f81d21d877f734c6aae94f4277/7d769/zipAll.png&quot; srcSet=&quot;/static/57b267f81d21d877f734c6aae94f4277/5243c/zipAll.png 240w,/static/57b267f81d21d877f734c6aae94f4277/ab158/zipAll.png 480w,/static/57b267f81d21d877f734c6aae94f4277/7d769/zipAll.png 960w,/static/57b267f81d21d877f734c6aae94f4277/601e5/zipAll.png 1146w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;现在，zipAll 的上游是一个永不完结的 Observable，当它拿到 2 个内部 Observable 的时候，无法确定是不是还有新的内部 Observable 产生，而根 据“拉链”的工作方式，来自不同数据源的数据要一对一配对，这样一来，zipAll就只能等待，等待上游高阶 Observable 完结，这样才能确定内部 Observable对象的数量。如果上游的高阶 Observable 不完结，那么 zipAll 就不会开始工作&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;combineAll（combineLatestAll 有点啰嗦）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:18.333333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAmElEQVQY032PuwrEIBBF/WGrBKu0afwZ8WsC6QJWQWOheT9umCmWLGT3wIGZUS4zYl1XvLksC7z3yDlzP88zuq7j/rounOf5qgghYBgGlmoyxoi+79E0DZxzHJZSQtu2XBPHcWDf9y+3bYPAH+gTYYxBURSQUqIsS9R1jXEc+Y22fSJo8Es6gbDWQinFQVVVQWuNaZo+gU9vzUQrO38teMQAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;combineAll&quot; title=&quot;combineAll&quot; src=&quot;/static/80e5282dc542d350caf7b538f32ec816/7d769/combineAll.png&quot; srcSet=&quot;/static/80e5282dc542d350caf7b538f32ec816/5243c/combineAll.png 240w,/static/80e5282dc542d350caf7b538f32ec816/ab158/combineAll.png 480w,/static/80e5282dc542d350caf7b538f32ec816/7d769/combineAll.png 960w,/static/80e5282dc542d350caf7b538f32ec816/601e5/combineAll.png 1146w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;combineAll 和 zipAll 一样，必须上游高阶 Observable 完结之后才能开始给下游产生数据，因为只有确定了作为输入的内部 Observable 对象的个数，才能拼凑出第一个传给下游的数据&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;没有 withLatestFromAll 是因为以上 All 后缀的操作符中所有 Observable 地位都是平等的，而 withLatestFrom 会有一个 Observable 来控制节奏，其他的只是提供数据，并不是平等的&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;进化的高阶 Observable 处理&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;switchAll&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;总是切换到最新的内部 Observable 对象获取数据。每当 switch 的上游高阶 Observable 产生一个内部 Observable 对象，switch 都会立刻订阅最新的内部 Observable 对象上，如果已经订阅了之前的内部 Observable 对象，就会退订那个过时的内部 Observable 对象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:52.916666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABNUlEQVQoz62SyY6DMAyGef/X6qCOCmcOiF0sojAsZV/d2CIoTTmOpV9YjrE/O1GA2TzPsG0bhGEI2uOBIQiCADRNI9+xHdB1nfx1XSlXFo8rmNS2LcmyLPi53aiBaZqgqir5hmHA7/0OvPmyLN9icSyq7PsOshVFAUmSQN/3RM0Nc6/ovggxkQsPpmmCuq5hGAZ4se84jkSBcTH3SichFWM/iR2xUFmW4Ps+UUdhRGf8Z5HsJOQFcTdxHJ87kolHRltV1UleldXl6B+E4j7nY8mYhD7SEmUUUWGkFW/8g1AWHqRpSjePiSjZri4TTYF/NuV17ASfCApHy/McbPYm0f9jvus4tMdn+gTXdWl0h8U4vSgFl9yx0ZqmIXVdB1mWgW3b0B++67jUDNfgeR41wYZURHrgby+XV7NWL8YHAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;switchAll&quot; title=&quot;switchAll&quot; src=&quot;/static/64bda03996057a823bd27a4c0e0037db/7d769/switchAll.png&quot; srcSet=&quot;/static/64bda03996057a823bd27a4c0e0037db/5243c/switchAll.png 240w,/static/64bda03996057a823bd27a4c0e0037db/ab158/switchAll.png 480w,/static/64bda03996057a823bd27a4c0e0037db/7d769/switchAll.png 960w,/static/64bda03996057a823bd27a4c0e0037db/850cc/switchAll.png 1226w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;exhaust&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在耗尽当前内部 Observable 的数据之前不会切换到下一个内部 Observable 对象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:54.166666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABXklEQVQoz41SXXOCQAz0//8o9ak+yYsv9smWURAKyPeHKGs2NZRanWlmQu643GZvkxnErtcr+r5HU9dw1mt0bYc0TeE4Do+x3++x2Wx0zbzL5fLj9/35fMYwDJgxiZuiKJAkCRbzObIsg+/7WC6W6LoO79stVm8rvVhL0aZp/nhdVUpsRtRHI7jv+agkyfM8ZWXsWPyZs7Ay5GfqRr8sSwU+nU7I81zB+W8K0j/E8cmvrG1bFHkB13UV2Be2U/1GYGE+MsxFrzAMNTkIAn0qYxRFMDmoDQGoLZtF5oz2IjtXQC60c+I8sI4zmjGRwqfCkoXYvDiOR2a/NOQF6sMuaWIUj0y4Z1Oo3X9NAY02q9gYcG37Z5PwEpAdtNlq70BkzGHOhCW1LUUzNuhLtCbjMJB4+B4n/ucdRp1DE9nGgpGN+tjtkIhO7qerY8OCbNZBCh2PR40KSCIC1tSNAt4A3JdU6qfMnP0AAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;exhaust&quot; title=&quot;exhaust&quot; src=&quot;/static/a4754a57cfb0d70039272971c0f85436/7d769/exhaust.png&quot; srcSet=&quot;/static/a4754a57cfb0d70039272971c0f85436/5243c/exhaust.png 240w,/static/a4754a57cfb0d70039272971c0f85436/ab158/exhaust.png 480w,/static/a4754a57cfb0d70039272971c0f85436/7d769/exhaust.png 960w,/static/a4754a57cfb0d70039272971c0f85436/359c8/exhaust.png 1164w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;上游高阶 Observable 完结并且当前内部 Observable 也完结，switchAll、exhaust 产生的 Observable 对象才会完结&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果上游高阶 Observable 对象没有完结，意味着可能会有新的内部 Observable 产生；如果内部 Observable 没有完结，毫无疑问应该继续产生数据&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;产生的数据依然是 Observable 对象的 Observable，称为高阶 Observable，RxJS 提供了合并高阶 Observable 对象中数据的操作符，实际上只是把多个 Observable 对象参数改成了一个高阶 Observable 对象&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 创建数据流]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-创建数据流</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-创建数据流</guid><pubDate>Thu, 13 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;RxJS 提供的创建类操作符覆盖了几乎所有的数据流创建模式，没有必要重复发明轮子&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;创建同步操作流&lt;/h2&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;产生哪些数据&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据之间先后顺序&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;create&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;of 列举数据&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;of 产生 Cold Observable&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;range 指定范围&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:12.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAIklEQVQI163DBw0AAAgDsPmXvIsJmhRt9wm2J+klySHJPh/2FO2mOiZFVAAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;range&quot; title=&quot;range&quot; src=&quot;/static/1050566df480734d9bbbdb0107e0b026/7d769/range.png&quot; srcSet=&quot;/static/1050566df480734d9bbbdb0107e0b026/5243c/range.png 240w,/static/1050566df480734d9bbbdb0107e0b026/ab158/range.png 480w,/static/1050566df480734d9bbbdb0107e0b026/7d769/range.png 960w,/static/1050566df480734d9bbbdb0107e0b026/c0d05/range.png 1166w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;range 只能每次递增 1，range(1.5, 3) 吐出 1.5、2.5、3.5&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;generate 循环创建&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;repeat 重复数据&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:12.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAmklEQVQI112OWQ6DMAxEc/9zcQQSBChAQG36AwTCGpZpbfWntTSaGfnJsvDeg2YcR3b/deovayGlRJ7nsJ8cRRHquoZSCkVR4Lou/I9I0xRaa2RZxhAd0GWJ9vlA2xjOSZLwPo5jGGOYIbaqKszzjPM8cRwHQggQzjms64qu67BtG/q+ZyjsO2uaJgzD8MOQU1+WhY/d983fkt6KBuIvIkdvagAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;repeat&quot; title=&quot;repeat&quot; src=&quot;/static/e72285264a8d11a3e9c7fa8d3f080dc9/7d769/repeat.png&quot; srcSet=&quot;/static/e72285264a8d11a3e9c7fa8d3f080dc9/5243c/repeat.png 240w,/static/e72285264a8d11a3e9c7fa8d3f080dc9/ab158/repeat.png 480w,/static/e72285264a8d11a3e9c7fa8d3f080dc9/7d769/repeat.png 960w,/static/e72285264a8d11a3e9c7fa8d3f080dc9/c0d05/repeat.png 1166w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果去掉 &lt;code class=&quot;css-0&quot;&gt;setTimeout(() =&amp;gt; ob.complete(), 4000)&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:12.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAW0lEQVQI152MSQrAIAAD/f//PCiIRw+uKKKCMEU/UNpACANJRGuNo1rrzcN7b/5KKKUwxqC1xlqLlPJySgnvPSGEV59ejBHnHKKUwhjjHsw5yTnTe2et9dln/wDhFOcKAv6SrgAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;repeat2&quot; title=&quot;repeat2&quot; src=&quot;/static/49875eba929a778711e99c4ecb2414bd/7d769/repeat2.png&quot; srcSet=&quot;/static/49875eba929a778711e99c4ecb2414bd/5243c/repeat2.png 240w,/static/49875eba929a778711e99c4ecb2414bd/ab158/repeat2.png 480w,/static/49875eba929a778711e99c4ecb2414bd/7d769/repeat2.png 960w,/static/49875eba929a778711e99c4ecb2414bd/c0d05/repeat2.png 1166w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;所以 repeat 依赖于上游完结的时机&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;empty、never、throwError&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:12.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAIElEQVQI12P4T2XA8OvXr/+/f/+mCgaZxfD379//1MQA9Sfto7DoKxAAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;empty&quot; title=&quot;empty&quot; src=&quot;/static/378eb3e8c1c79c7fbd9f457ba6ae5aaf/7d769/empty.png&quot; srcSet=&quot;/static/378eb3e8c1c79c7fbd9f457ba6ae5aaf/5243c/empty.png 240w,/static/378eb3e8c1c79c7fbd9f457ba6ae5aaf/ab158/empty.png 480w,/static/378eb3e8c1c79c7fbd9f457ba6ae5aaf/7d769/empty.png 960w,/static/378eb3e8c1c79c7fbd9f457ba6ae5aaf/c0d05/empty.png 1166w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:12.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAKklEQVQI163DsREAMAgDMe+/qAtwD9VniKA7iWPqbn5XFUmwjXaXqzPDAx+b6SMMQiEqAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;never&quot; title=&quot;never&quot; src=&quot;/static/4c55f38561f5093a6b0f41c2541a474c/7d769/never.png&quot; srcSet=&quot;/static/4c55f38561f5093a6b0f41c2541a474c/5243c/never.png 240w,/static/4c55f38561f5093a6b0f41c2541a474c/ab158/never.png 480w,/static/4c55f38561f5093a6b0f41c2541a474c/7d769/never.png 960w,/static/4c55f38561f5093a6b0f41c2541a474c/c0d05/never.png 1166w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:12.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAIElEQVQI12P4T2XA8OvXr/+/f/+mCgaZxfD379//1MQA9Sfto7DoKxAAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;throwError&quot; title=&quot;throwError&quot; src=&quot;/static/cab9b8f5d6a63fe434d8b6c6ba9af96c/7d769/throwError.png&quot; srcSet=&quot;/static/cab9b8f5d6a63fe434d8b6c6ba9af96c/5243c/throwError.png 240w,/static/cab9b8f5d6a63fe434d8b6c6ba9af96c/ab158/throwError.png 480w,/static/cab9b8f5d6a63fe434d8b6c6ba9af96c/7d769/throwError.png 960w,/static/cab9b8f5d6a63fe434d8b6c6ba9af96c/c0d05/throwError.png 1166w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;创建异步操作流&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;相比创建同步操作流，还需要关心数据之间的时间间隔问题&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;interval、timer 定时产生数据&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;都是从 0 开始吐出数据，timer 第一个参数表示开始时间，默认 0，第二个参数同 interval&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;from Observable-like to Observable&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Observable-like: an Array, an array-like object, a string, a Promise, an iterable object, an Observable-like object&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;fromPromise from(promise)&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;fromEvent&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;fromEvent 产生 Hot Observable，数据的产生和订阅是无关的，数据的产生完全不受 RxJS 控制&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;fromEventPattern&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;fromEvent 显然不能覆盖所有的 Event，有的 Event 接口是不一致的，fromEventPattern 就是用来适配其他的 Event 接口&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;ajax&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;ajax:&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;fetch:&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;repeatWhen&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据完结的时机重复，但如果上游不是同步，那完结时机也不确定，那使用 interval 重新订阅的时机也难以确定，这时可以通过 notifier 的参数 notifications，它也是一个 Observable&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;defer&lt;/h3&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Creates the Observable lazily, that is, only when it is subscribed.&lt;/p&gt;&lt;/blockquote&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 操作符基础]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-操作符基础</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-操作符基础</guid><pubDate>Wed, 12 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;操作符其实就是解决某个具体应用问题的模式。当我们要用 RxJS 解决问题时，首先需要创建 Observable 对象，于是需要创建类操作符；当需要将多个数据流中的数据汇合到一起处理时，需要合并类操作符；当需要筛选去除一些数据时，需要过滤类操作符；当希望把数据流中的数据变化为其他数据时，需要转化类操作符；而对数据流的处理可能引起异常，所以为了让程序更加强壮，我们需要异常处理类操作符；最后，要让一个数据流的数据可以提供给多个观察者，我们需要多播类操作符&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;为什么需要操作符&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;每个操作符提供的只是一些通用的简单功能，但通过将这些小功能可以组合在一起，就可以用来解决复杂的问题&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数组和 Observable 在数学概念上都是 Functor&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;分类&lt;/h2&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;创建&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;转化&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;合并&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;多播&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;错误处理&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;工具&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;条件分支&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数学和合计&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;如何实现操作符&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据业务需求封装自定义操作符&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;操作符函数的实现&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;每个操作符都是一个函数，必须包含以下几点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;返回全新的 Observable&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对上游和下游的订阅和退订的处理&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;处理异常情况&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;及时释放资源&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有 React Hooks（FP）内味了&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;map 的实现：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;map 并不占资源，所以没有释放，当有利用资源时需要释放，比如 addEventListener&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:88.33333333333333%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAAC9klEQVQ4y5WTWU8TURzF+z0MsnaZmc509plOWzYTfRFeBDFpIUpAxC0u+Mojb0BMSBCjUYskoghGE0TAxCXCh2oyx3Nn2oYgJPJw8r9z597fPecuifXtn7WN3T+1j3uHtU3Wzb2Ds2v/oLa1f1h7//VXLfFh5zfm5pdx5/4DTDycwfj0Y4zfPptuTD/C3SezqG7uIPFu+0dYGZsKlVRb2K5lw5ZWKWxpl8Lz7XKzNtT87hCK262dSniuNRVmjXy49Ho9TKx+2sW167eQyfgwzBJcvwDHLcByArgeqxvApkx+Ox6rHSBnBtD1EnJsq2YeGcWGk+/DwsoqEtWtbxgZvUmgxYEF5Cw/GqSZPjSD7ZwLTfdBB+zL83/ASpAew4Qk1YXl92J++U0MvDo6CVUKELgXEXgX4Ni96OvpRqFUgkeXxaAI0y3CcHvhBP0wvB7YBNh0ZbLKXNBwuzH/jMBVAocrE+hIqgT1I29dgm8WUbREzBKsAqOWCtAd4caDZtO15UHSHDqLlZQMmFzkCHASnUmNQLojLGAM2ypA8ftg+HTjEGJ43LNipCwjyzkPacVCJmv/CxSR2zoV7iEduf2MHvBQilAYQ+ydItxwYua4TgJWjwDTqg3LYFy7B4YTuzE1Fzm60blPGcZruDqqU4GSmKx5cPR87EzE5oS0Ykagk3QqsLVDjvZGxBSObEpcD6m+XzIXE1LYVnJ+s4q+lGQeOxQC27uy0Kx431S6sxlRFy7tEmQBrQOlJtRrQtOyxWvVfeyU01o0IEX7KQ5IMk5KZlT59LinRh4Zm0IqY0YvQ+P1UOgiGzlxo3vWPIB6W5x44w4Kx2Lh6KUI4Fu+5eHyBNQuHRbfps43axGU4Yln1RiSFLF4WBonyll+E9iZ0pgqhy5KHKjKbVlYqQrgHmZm5zAwVMbg8CguXyljgGrUgaFKpMFI5ahGfdG/cr2/gtGJe1iubiCx9vk7Xq5/wdKrdSw+r2KRq4iVGvV/9PTFGlbWtrC6tYu/xAi0BpYqJyAAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;mapOperator&quot; title=&quot;mapOperator&quot; src=&quot;/static/1da29c7ad55df95a83361469c480cf43/7d769/mapOperator.png&quot; srcSet=&quot;/static/1da29c7ad55df95a83361469c480cf43/5243c/mapOperator.png 240w,/static/1da29c7ad55df95a83361469c480cf43/ab158/mapOperator.png 480w,/static/1da29c7ad55df95a83361469c480cf43/7d769/mapOperator.png 960w,/static/1da29c7ad55df95a83361469c480cf43/87339/mapOperator.png 1440w,/static/1da29c7ad55df95a83361469c480cf43/8c53e/mapOperator.png 1526w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;
不能保证类库内部 this 的指向，JS 中这里的等价代换显然不成立&lt;/p&gt;&lt;/blockquote&gt;&lt;style data-emotion-css=&quot;1slx2ud&quot;&gt;.css-1slx2ud{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1slx2ud{font-size:1.5rem;}}@media screen and (min-width:768px){.css-1slx2ud{font-size:1.875rem;}}&lt;/style&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;使用 lift&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;很多操作符都有实现 lift，功能是把 Observable 对象提升一个层次，赋予更多功能，lift 返回一个新的 Observable 对象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:35%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAEDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdyAsB//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAADAQEAAAAAAAAAAAAAAAAAATFBkf/aAAgBAQABPyF3Toof/9oADAMBAAIAAwAAABBwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAAIBBQAAAAAAAAAAAAAAAAERACExgaHB/9oACAEBAAE/EGfqBuu0FBfJn//Z&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;liftandpipe&quot; title=&quot;liftandpipe&quot; src=&quot;/static/f6b3713b01a75327f92115bc2e1b0c0a/18e3b/liftandpipe.jpg&quot; srcSet=&quot;/static/f6b3713b01a75327f92115bc2e1b0c0a/46946/liftandpipe.jpg 240w,/static/f6b3713b01a75327f92115bc2e1b0c0a/55489/liftandpipe.jpg 480w,/static/f6b3713b01a75327f92115bc2e1b0c0a/18e3b/liftandpipe.jpg 960w,/static/f6b3713b01a75327f92115bc2e1b0c0a/3af87/liftandpipe.jpg 1052w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://github.com/ReactiveX/rxjs/issues/2911&quot; class=&quot;css-1od09yo&quot;&gt;v6 中曾提议取消掉 lift，但最终留了下来，相关讨论&lt;/a&gt;&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;使用原有操作符&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;|&amp;gt;&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;https://github.com/tc39/proposal-pipeline-operator&quot; class=&quot;css-1od09yo&quot;&gt;|&amp;gt; 提案&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;https://github.com/babel/babel/tree/master/packages/babel-plugin-proposal-pipeline-operator&quot; class=&quot;css-1od09yo&quot;&gt;babel 插件&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《深入浅出 RxJS》- 入门]]></title><link>https://ahabhgk.github.io/读《深入浅出-rx-js》-入门</link><guid isPermaLink="false">https://ahabhgk.github.io/读《深入浅出-rx-js》-入门</guid><pubDate>Tue, 11 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://rxjs-dev.firebaseapp.com/guide/overview&quot; class=&quot;css-1od09yo&quot;&gt;RxJS overview&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可以把一个“数据流”对象理解为一条河流，数据就是这条河流中流淌的水，代表“流”的变量标示符，都是用 &lt;code class=&quot;css-0&quot;&gt;$&lt;/code&gt; 符号结尾&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;比如一个按钮，我们需要记录用户按下去的时间，显示到页面上，同时发送给服务器，一般我们可以这样写：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;两个函数交叉访问一个变量 startTime，易出错&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果我们用 RxJS 的方式，可以把 mouseDown 和 mouseUp 看成通过 fromEvent 创造的两个流，holdTime$ 由 mouseUp$ mouseDown$ 计算得到，通过两个 subscribe 消费 holdTime$，一个用来 render，一个用来 ajax&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;RxJS 引用了两个重要的编程思想：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;函数式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;响应式&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;函数式编程&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;声明式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;纯函数&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;函数的执行过程完全由输入参数决定，不会受除参数之外的任何数据影响（引用透明）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;函数不会修改任何外部状态，比如修改全局变量或传入的参数对象（无副作用）&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据不可变性&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;纯函数易于单元测试，不纯的需要 mock，修改代码同时也要修改测试中的 mock&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;FRP&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据流抽象了很多现实问题（DOM、WS、AJAX……）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;擅长处理异步操作（对数据“推送”，产生数据时推送数据，无需关心数据是同步还是异步产生的）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;把复杂问题分解成简单问题的组合&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Observable / Observer&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Observable：可被观察者&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Observer：观察者&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Observable 实现了&lt;strong class=&quot;css-0&quot;&gt;观察者模式&lt;/strong&gt;和&lt;strong class=&quot;css-0&quot;&gt;迭代器模式&lt;/strong&gt;，是这两个模式的组合&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;观察者模式&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;观察者模式要解决的问题，就是在一个&lt;strong class=&quot;css-0&quot;&gt;持续产生事件&lt;/strong&gt;的系统中，如何分割功能，让不同模块只需要处理一部分逻辑，这种分而治之的思想是基本的系统设计概念&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;观察者模式将逻辑分为 Publisher 和 Observer，Publisher 负责发布事件，Observer 负责处理事件&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;RxJS 中，Observable 对象作为 Publisher，subscribe 的参数作为 Observer&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;迭代器模式&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Iterator 指能够遍历一个数据集合的对象（树、数组、链表……）Iterator 的作用就是通过一个通用的接口，是开发者不必关心数据集合的具体实现方式&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;“拉”式的迭代器实现，RxJS 中是“推”式的迭代器实现，其迭代器的使用者，并不用从 Observable 上“拉”数据，而是只要 subscribe 上 Observable 对象之后，自然就能接收到消息的推送&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;拉和推是从数据消费者的角度描述，比如：AJAX 是网页（数据消费者）从服务器拉取数据，而通过 WebSocket 服务器可以推送给网页数据&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;创造 Observable&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Observable = Publisher + Iterator&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;类型上 Observer 是 interface，Subscriber 是对 Observer 的实现 class&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;跨越时间的 Observable&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Observable 用于发布事件，Observable 来做更合适&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;永无止境的 Observale&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果没有 clearInterval，数据流就不会终止，因为每次只吐出一个数据，然后被 subscriber 消化掉，所以内存不会增加。如果把所有的数据放到一个数组中，数组所占内存大小就会随数据的增加而增加&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;大部分数据流会终止，上面例子中吐出 1 2 3 后就应该终止，但 Observable 如果只是停止吐出数据，只不过不再点用 next 推送，并不能给予 subscriber 一个终止信号，subscriber 依然准备着接收数据&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Observable 的完结和错误处理&lt;/h3&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;next*(error|complete)?&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:58.75%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABhElEQVQoz51T22rCQBTM/3+GuRibF/XBRMEH75cHwfhQK1gUxUSjCVHBu9OcQ7ekwbbUA0Oy7Mmc2ZmN5HkeBoMBNpsNLpcLjscjzucz7vf7U5Bc18VquUQQBNiGW+x2OywWC9xuN4iixngl1/GSAj/4WqzXa8b7eIz5fA4aRoMECQ0RZL7vw3EcLCMxBOql00q0OBwO/GG5XIZpmrAsC5ZpoVAooNVqwYkU230bvV4Po7cRk3U6Hd6nfvPzWalUIIVhyGRuNK1YLCKjZ5DWNMiyDE3VUKvVmICmeyuPvSY1jUYDelqHqqpQFQWKrLAgSRz3dDqxmnq9zmi322g2m7Bt+6FX/X4f1WqVewg0uNvtQoondL1e+UlqSEkQKaNBwsMkyNM4OOVHqRGZMJyuULLn15TFJqmbTCaM4esQ0+kUs9mM/Uoq/EkxKxQN+/0epVIJ+Xwe2WwWuVyO38n8OMFf9Z0wStkwDMipFHRdh/FicDhPEdIvRylTWqSKQPeK0vwP4QeTtYIZ5vW0JAAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;observable&quot; title=&quot;observable&quot; src=&quot;/static/b2184045067f492d791f0a3bb9df9feb/7d769/observable.png&quot; srcSet=&quot;/static/b2184045067f492d791f0a3bb9df9feb/5243c/observable.png 240w,/static/b2184045067f492d791f0a3bb9df9feb/ab158/observable.png 480w,/static/b2184045067f492d791f0a3bb9df9feb/7d769/observable.png 960w,/static/b2184045067f492d791f0a3bb9df9feb/87339/observable.png 1440w,/static/b2184045067f492d791f0a3bb9df9feb/b8e6a/observable.png 1656w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;退订 Observable&lt;/h2&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Hot Observable 和 Cold Observable&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于多个 Subscriber，比如第一个订阅 n 秒之后第二个在订阅，第二个是否接收错过 n 秒的数据&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于不接收错过的 n 秒数据，叫做 Hot Observable，对于从头开始接收的，叫做 Cold Observable&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;operators&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Pipeable operators：传入 Observable 返回新的 Observable&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Creation Operators：可以传入一些预定义行为调用函数来创建新的 Observable，或通过加入其他 Observable&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;弹珠图&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:16.249999999999996%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAiUlEQVQI102OgQ6DIAxE/f/vdFMqm6IIqMCNXjQZSdNLub5eh/s552AnS32eJ7z3iDFikgkfa6lXt0KMYN931vAeEEJAKQXXdbF3OWeklGjYto0fnDWAgufvjGVZqNWj8CMdrRJEhIdqrdwh8LlkjKF5bUkV+iQ049hSCo+6Bn71PVPpnmrt/wl/KAznqeOH65QAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;visualizer&quot; title=&quot;visualizer&quot; src=&quot;/static/39bf18ef5c0dbee4a70fb2d9c96dacd7/7d769/visualizer.png&quot; srcSet=&quot;/static/39bf18ef5c0dbee4a70fb2d9c96dacd7/5243c/visualizer.png 240w,/static/39bf18ef5c0dbee4a70fb2d9c96dacd7/ab158/visualizer.png 480w,/static/39bf18ef5c0dbee4a70fb2d9c96dacd7/7d769/visualizer.png 960w,/static/39bf18ef5c0dbee4a70fb2d9c96dacd7/87339/visualizer.png 1440w,/static/39bf18ef5c0dbee4a70fb2d9c96dacd7/a0792/visualizer.png 1608w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《大话数据结构》]]></title><link>https://ahabhgk.github.io/读《大话数据结构》</link><guid isPermaLink="false">https://ahabhgk.github.io/读《大话数据结构》</guid><pubDate>Tue, 11 Feb 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;程序设计 = 数据结构 + 算法&lt;/h2&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据：是描述客观事物的符号，是计算机中可以操作的对象，是能被计算机识别，并输入给计算机处理的符号集合。数据不仅仅包括整型、实型等数值类型，还包括字符及声音、图像、视频等非数值类型。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据元素：是组成数据的、有一定意义的基本单位，在计算机中通常作为整体处理。也被称为记录。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据项：一个数据元素可以由若干个数据项组成。数据项是数据不可分割的最小单位&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据对象：是性质相同的数据元素的集合，是数据的子集。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:36.25%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAyElEQVQoz4WRSQqFMBBEc/+buRGHiDjjPJ+hP68hIBL8iyKmUp1+ac2+77Isi6zrqutbnFtrVdu2eTNPmeu65DgOr7iM83EcZRgG+co6ma+unHVdJ0EQSBRF0jTNX0olJOSIXCfnMQropmnSAl+OvZNemOe5hGEoVVVp4DxPybJMvbqutfC+b50jpM9cmqaSJImUZame4VYI5nnWFRPxDZHP6/tead45XmOYC114Ep3YQ+W8OI6lbVulghAPSmZbFIW+hJ9GjrofrbIAQeVUP9wAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;data&quot; title=&quot;data&quot; src=&quot;/static/fe57e70065c774dad7dba70e6179f086/7d769/data.png&quot; srcSet=&quot;/static/fe57e70065c774dad7dba70e6179f086/5243c/data.png 240w,/static/fe57e70065c774dad7dba70e6179f086/ab158/data.png 480w,/static/fe57e70065c774dad7dba70e6179f086/7d769/data.png 960w,/static/fe57e70065c774dad7dba70e6179f086/b43a1/data.png 1092w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据结构：是相互之间存在一种或多种特定关系的数据元素的集合。&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;逻辑结构：是指数据对象中数据元素之间的相互关系&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;集合结构&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;线性结构&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;树形结构&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;图形结构&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;物理结构：数据的逻辑结构在计算机中的存储形式&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;顺序存储&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;链式存储&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:58.75%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAB00lEQVQoz32Sx4pyQRCF78OJaxeKOwMmxAQG1Hdw7TO4Ely7MWLAnAN3GHNAxQCCqJz/r4KWmUEUPtqurj5VdfpKbrcboVAI4XCY12AwyNB/l8uFeDyOy+UCv98Pu90Oj8cDuvMTh8PB8UKhAEmpVEKv18Pn87GQzWaD1+vlmEKhQCQSwXa7hVqthkql4iKBQICF6I7T6eQzIhaLQdJqtTCZTLBarTCbzYzFYuGYRqNBNBrFbreD0WiETqfjuMgTUHGDwYBEIgGpXq+jVqtBrESz2USr1UKj0cBkMsHtdkOn0/mV8xPKp/PNZgOp3+8jl8vx5Ww2yz7QiMR6vcbxeMTz+cRyuUSxWEQ+n2fhdDrN92jf7Xax3+/Za2k8HnNgMBiAxInFYsHMZjNOfDwemE6naLfb3A3lUwO0p0lIgwqeTidIdJjJZLiSWOmQmM/nOBwOLEjidJZMJrnTVCr1yidRGpcFZVnmQK/XY6jDv4L3+x2r1YoteIfIP5/PkGhU8q5SqXDlUqn0tkPaCyve8RIcDocol8vsiXjFvx5Sh5/EBDzyaDRCtVp9fSbCD4LGpKr0E7FPXK9XGnnIr0TCo9GYEa9NnsryF1b/fRKxT3x/T/APtIgS5l1e8ygAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;structure&quot; title=&quot;structure&quot; src=&quot;/static/64ae55ca2947f043d67542455bbd2e50/7d769/structure.png&quot; srcSet=&quot;/static/64ae55ca2947f043d67542455bbd2e50/5243c/structure.png 240w,/static/64ae55ca2947f043d67542455bbd2e50/ab158/structure.png 480w,/static/64ae55ca2947f043d67542455bbd2e50/7d769/structure.png 960w,/static/64ae55ca2947f043d67542455bbd2e50/179e0/structure.png 1088w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数据类型：是指一组性质相同的值的集合及定义在此集合上的一些操作的总称&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;抽象数据类型（Abstract Data Type，ADT）：是指一个数学模型及定义在该模型上的一组操作&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;算法：算法是解决特定问题求解步骤的描述，在计算机中表现为指令的有限序列，并且每条指令表示一个或多个操作&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;输入输出：入参返回&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有穷性：会结束&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;确定性：每个步骤被精确定义而无歧义&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可行性：&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;算法设计要求：正确性、可读性、健壮性、高效率、低存储量&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:47.08333333333333%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABJUlEQVQoz42SW6uCQBSF/f+/qpf0wZ5MRRPNSxoWaeRdrHVYG4whOoczoMPcPr+1HQ1Ke71e0j+fT/R9j7Zt8Xg8cDwekaYpxnHENE2ytizL+8z6sGnfgISYponNZgNd13E+nxEEAcIwxHa7hWEYqOv6/0AaFEWBeZ4xDAOSJEFZlrher9jtdqiqSlKooPX8r8DD4SBQxsyyDKfTSaxs2xbgn5E/J2nlui583xcIgRzneY79fo/L5SKGqsQbqMJUQ8dxYFmW1I6RPc8TS4Jp/mm4Nk0drI0xb7cbuq6TP00Aa9g0jUS+3+8C/JSRGvLFA7wWjMR4URSJEc04x/V1njfgm8TbkBZxHMth1oxg3jsC2BNCIPcwMj/Av819rCX3seca0/wAtRuvVdhSwgYAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;time&quot; title=&quot;time&quot; src=&quot;/static/7dafae03d58c9c7d56ee7270686f8ed5/7d769/time.png&quot; srcSet=&quot;/static/7dafae03d58c9c7d56ee7270686f8ed5/5243c/time.png 240w,/static/7dafae03d58c9c7d56ee7270686f8ed5/ab158/time.png 480w,/static/7dafae03d58c9c7d56ee7270686f8ed5/7d769/time.png 960w,/static/7dafae03d58c9c7d56ee7270686f8ed5/aeb15/time.png 1392w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;线性表&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;零个或多个数据元素的有限序列&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;顺序存储&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;无需储存元素之间的逻辑关系（指针）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可快速存取表中任意位置元素&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;插入删除需大量移动元素&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;难以确定储存空间容量&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;储存空间碎片&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;链式存储&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;存储下一个元素的位置（储存元素之间的逻辑关系）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;[_, *next] -&amp;gt; [a1, *next] -&amp;gt; [a2, *next] -&amp;gt; [a3, null]&lt;/code&gt;&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;头节点：可有可无，方便操作统一而设立&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;头指针：必须存在，指向链表中第一个节点，有头节点则是头节点&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:47.08333333333333%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB0klEQVQoz01RS6uxYRR9f4qJlInOlD+gEBO3ERnwA0yUkfwG/gFDt+QunA4ykFuIFMn9dlyOlLBOe3+d8523Vj3PXs9ee639Ch6PBzKZDBaLBQaDASqVCm9vb6hUKjCbzZBIJFCr1dBqtRCLxTCZTMxJpVLI5XIYjUZoNBqIRCJ4vV4Ifr+fGxwOB+x2O2w2G/R6PRqNBlwuF3Q6HZxOJ5+p2e12o16vQ6lUMme1WnmIQqGAz+eDcLvdUK1WkU6nUSqVePp4PAZ9+/0e3W4Xy+USk8kE1+sVz+eTuV6vh0Qigff3d+77+PjAdruF8Pn5iVwux2Q8HmdiOp3ifr9jsVhwPZVKYTAYYLVa4XA4MNdqtZDNZpHP51Eul9Fut/8J0gOaUigUuDkcDnOk1+vFrjKZDNf7/T6GwyG7JcFarYZoNIpAIIBQKMTnzWYD4Xg8sgA5o9iETqfDguQwFouxQxKNRCLs/vF48CrIRLFY5KGkcblcIHx9fbEygSz/gFzsdrvf/YxGI94bxSaOnM5mM8Z8Puf66XSCQIumxr/4EaRH5Ix2lUwmEQwGWZQcEkeiJEZJ6H4+n/8L0h/9CxKk/VKUZrPJUQn09sc9pVqv17+gyN9Vi0eZN9UsZgAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;compareArrList&quot; title=&quot;compareArrList&quot; src=&quot;/static/d09a87cb8633a05f5bc4bc15534686af/7d769/compareArrList.png&quot; srcSet=&quot;/static/d09a87cb8633a05f5bc4bc15534686af/5243c/compareArrList.png 240w,/static/d09a87cb8633a05f5bc4bc15534686af/ab158/compareArrList.png 480w,/static/d09a87cb8633a05f5bc4bc15534686af/7d769/compareArrList.png 960w,/static/d09a87cb8633a05f5bc4bc15534686af/aeb15/compareArrList.png 1392w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;style data-emotion-css=&quot;1slx2ud&quot;&gt;.css-1slx2ud{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1slx2ud{font-size:1.5rem;}}@media screen and (min-width:768px){.css-1slx2ud{font-size:1.875rem;}}&lt;/style&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;静态链表&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;用数组描述的链表&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一个数组元素存 &lt;code class=&quot;css-0&quot;&gt;{data, cur}&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:25%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAxUlEQVQY001QyQqFMBDr/3+cBz2476DgvqC4zyOBllcYksYYMyrP88T3fcnzXIIg4KRpKuu6ynEcos/3fcRxHMWyLHrgdV2XY9u21HUtKgxDQWgcxxwYsywjTtPEkPd9OQjdto2+JEmIeB/+KIqkbVtR8ncglGUp+76TL8vCpmgFjpnn2fDzPKWqKmmaxmQovQrWK4qCbYdhYAga9n1v7uDAruuo4TnagevfYgKf5+EXHcehAfp939SxLhB3zbV+XRdRB/4AEcV7EubkQNsAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;staticList&quot; title=&quot;staticList&quot; src=&quot;/static/034354a73bd5a4f96840d1ea74956e72/7d769/staticList.png&quot; srcSet=&quot;/static/034354a73bd5a4f96840d1ea74956e72/5243c/staticList.png 240w,/static/034354a73bd5a4f96840d1ea74956e72/ab158/staticList.png 480w,/static/034354a73bd5a4f96840d1ea74956e72/7d769/staticList.png 960w,/static/034354a73bd5a4f96840d1ea74956e72/8ed69/staticList.png 1386w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;静态链表其实是为了给没有指针的高级语言设计的一种实现单链表能力的方法&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;动态&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;go 的 slice、cpp 的 vector&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;超出时再开新数组进行复制并扩展&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;循环链表&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;从当中一个结点出发，访问到链表的全部结点&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;双向链表&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;克服单向性&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;栈&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;先进后出&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;两栈共享&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:506px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:53.75%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABX0lEQVQoz51Sa4vCQAzc//9rFKxaKwqiH6xaUeuzSLG1VbA+EbWKzjGBO9STHlwgTJtkJ5nsKrzZ4/FI/H7G9xhNfSc+Oe12uyGO4xeSZ4Lr9foSV0iwxWKB+XyOy+XyK0eiwWCAKIpe4up0OmG322G/34sfDocfdF0X3W4Xy+US5/MZ2+1WapkjUb/fx3g8loaMUYkqlUrQNA2ZTAaGYSCbzSKfzyOXy6FcLsu/aZpYr9fwPA++74uHYSgTFgoF6LqOSqWCer0OVa1WpVOj0cBoNJJgr9dDs9lEu92Gbdsi+5NxShKzls3IoWq1GhzHkcMcv9VqCZKISOehT8YVkJSTrlYr4VCURonpdBrFYhGpVEpkUCqR+U6ng+PxKLJJstlsZGfT6RSWZcmqOAhlK8oZDofik8lEkNKJnI7InZEsCAK5IN4+cTabSZ4ro7Mu8dn8x9T9fsdfnvT43+u+ANqXN1EEs8iFAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;two-stack&quot; title=&quot;two-stack&quot; src=&quot;/static/1c843455604b47984a69b9e9a3485b1b/f6694/twoStack.png&quot; srcSet=&quot;/static/1c843455604b47984a69b9e9a3485b1b/5243c/twoStack.png 240w,/static/1c843455604b47984a69b9e9a3485b1b/ab158/twoStack.png 480w,/static/1c843455604b47984a69b9e9a3485b1b/f6694/twoStack.png 506w&quot; sizes=&quot;(max-width: 506px) 100vw, 506px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;top1 !== top2&lt;/code&gt; 则不满&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;链栈&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:506px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:133.33333333333331%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAABYlAAAWJQFJUiTwAAACRUlEQVRIx6VVx6oCQRDc//8JEQN4EdSLoAcxIB4UFbNiQDHnnPtRzWsZV3dd3xtoZmZHa6o6jUa/436/kzqwf2e32+1pr/4Xs6YeNBoNisViNJ1OyerQAz8BdjodCgQCNBwOeV8oFKhUKlG9XqdKpcKWy+WoWq2y7fd7/p3KWpMPl8vl6dbJZELJZJL6/T7VajWeR6MRA2Ld6/VovV6/sGXA2WxGzWbzYd1ul5xOJ0WjUb7I4XCQ1+ulzWbDZ1ACFWDZbrd5XiwWDKoZBQAjlUqxXzH7/X4ql8uUzWaZeT6fp2AwSD6fj0KhEF/EgProqgOy8ENIBCOs8Q1g8O35fGY/wsRlbxm+SyN1rFYrlv8u4ppZOhgNYa2P8IOhUV5BJpyOIEAqZkTf4/Gw7/TqPgKm02kOCkBbrRYzQ1AAjLUUwEdAkQLHF4tFjrAERcDAFOn2FSDSBAxdLhenBioHYLgE1TOfz60ByiEAkLRIdoBLHsIVMIm0ZcDr9UqHw4HteDzyLAkfj8cfSlRlf0qb8XhMg8HghcBHhkYleTqduEosAVrpe9vtlu0rQLOurHfLvyUjQNILDRnqD8yCArlqUNShGbGRlIDzJQgwfENCo2IMa1nPTPaZTIZ7H94SJDUSHVVis9nIbrc/ZEvHMWQoe4Cg9wEEJYjKwLuCjo23ZblcvvZDM0A0B3Rj1LHb7eaGAECwRnLjzQE4qkZcYCoZ9SpPKRhhLXWM/phIJCgSiVA4HOZ6/xgUsIMsSN3tdjzD4DujJ+AHFq0Z0Bda69gAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;linkStack&quot; title=&quot;linkStack&quot; src=&quot;/static/b304f06458beeec5d2709ee2eac64d3b/f6694/linkStack.png&quot; srcSet=&quot;/static/b304f06458beeec5d2709ee2eac64d3b/5243c/linkStack.png 240w,/static/b304f06458beeec5d2709ee2eac64d3b/ab158/linkStack.png 480w,/static/b304f06458beeec5d2709ee2eac64d3b/f6694/linkStack.png 506w&quot; sizes=&quot;(max-width: 506px) 100vw, 506px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;注意单向链表的单向性&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;最小栈&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;实现一个栈，带有出栈（pop），入栈（push），取最小元素（getMin）三个方法。并且这三个方法的时间复杂度都是 O(1)&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;多用一个辅助栈，借用一个辅助栈 min_stack，用于存获取 stack 中最小值：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;push：push 时，如果小于等于 min_stack 栈顶值，则一起 push 到 min_stack，即更新了栈顶最小值&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;pop：判断 pop 出去的元素值是否是 min_stack 栈顶元素值（即最小值），如果是则将 min_stack 栈顶元素一起 pop，这样可以保证 min_stack 栈顶元素始终是 stack 中的最小值&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;getMin：返回 min_stack 栈顶即可&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;t: O(1) s: O(N)&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;多一个 min，在 push 时对比，比他小则更新并把原来的 min 存起来，在 pop 时对比，比他大则更新并把原来的 min 放出来&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;push：如果小于 min，则把 oldmin 在 min 之前入栈，再更新 min（入栈两个元素 [oldmin, min]）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;pop：[..., oldmin, min] min 如果 pop 值等于 min，则出两个 [oldmin, min] 并更新 min = oldmin&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;链表存 [value, min, next]&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;队列&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;先进先出&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;循环队列&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;解决“单向移动性”，充分利用数组空间&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果 front === rear 为满，则 front === rear 也为空，怎么区分？&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;加个 flag，记录上一次操作是增是减，增则为满，减则为空&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;留一个空间放 front 或 rear，&lt;code class=&quot;css-0&quot;&gt;(rear + 1) % QueueSize === front&lt;/code&gt; 为满&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;链队列&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:30.41666666666667%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA50lEQVQY032RRwqEQBBF+wre0RN4Hm8juDJsFF0YUMyYA4rpD9WDMAzDPCi6KCr+ZvigaRp4nofzPHHfN4+1bYuiKLhPsW8j8jxHkiTcZ8dxIAxDdF2HKIrg+z5vTKzriqqqkGUZ+r7HL5Zl4Q3TNMU8z2DTNGEcR8iyDMYYBEGAoig80bZtaJoG13XhOA6GYeADtm0D1dESuq7DMAyYpokgCN4bEhQQRRGSJPGz6ZxHgjiOUZYll4KaXdcFqiOj7VVV5QPrugZ7tPnHp16/oFP3fX9r+CTSSxs8H/It/L9PsSyLS0S8ANqNw4qjrQCZAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;linkQueue&quot; title=&quot;linkQueue&quot; src=&quot;/static/6f4113bc72373a3018656c2e8238accd/7d769/linkQueue.png&quot; srcSet=&quot;/static/6f4113bc72373a3018656c2e8238accd/5243c/linkQueue.png 240w,/static/6f4113bc72373a3018656c2e8238accd/ab158/linkQueue.png 480w,/static/6f4113bc72373a3018656c2e8238accd/7d769/linkQueue.png 960w,/static/6f4113bc72373a3018656c2e8238accd/9aac5/linkQueue.png 1022w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;注意单向链表的单向性&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;最小队列&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;实现一个队列，带有出队（deQueue），入队（enQueue），取最小元素（getMin）三个方法。要保证这三个方法的时间复杂度都尽可能小&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;实现类似最小栈&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;串&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;// TODO&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;树&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;度：结点拥有的子树数称为结点的度（De-gree）&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;叶节点：度为 0&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;分枝节点&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;树的度：树内各结点的度的最大值&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;双亲表示法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;孩子表示法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;孩子兄弟表示法：&lt;code class=&quot;css-0&quot;&gt;[data, *child, *rightSib]&lt;/code&gt; -&amp;gt; 复杂的树变为二叉树&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;二叉树&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;满二叉树：所有分枝结点都有左子树和右子树，所有叶子都在同一层&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;完全二叉树：不满的，各个节点的位置与满二叉树相同&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;性质&lt;/h4&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;第 i 层上最多有 2 ^ (i - 1) 个节点&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;深度为 k 的二叉树至多有 2 ^ k - 1 个结点&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;叶节点数 n0，度为 2 的节点数 n2，n0 = n2 + 1&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  n0 + n1 + n2 = n0 &lt;em class=&quot;css-0&quot;&gt; 0 + n1 &lt;/em&gt; 1 + n2 &lt;em class=&quot;css-0&quot;&gt; 2 + 1 = n1 + n2 &lt;/em&gt; 2 + 1&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  n0 = n2 + 1&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;具有 n 个结点的完全二叉树深度为 logn / 1 + 1&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  logn / 1：去掉最底部一层得到的满二叉树的层数&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;完全二叉树的结点的编号为 i，则其左孩子（如果有）编号为 2i，右孩子（如果有）编号为 2i + 1&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;存储结构&lt;/h4&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;顺序结构&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  由于二叉树的严格定义（优越性），顺序结构也可以存（性质 5）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;二叉链表&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  &lt;code class=&quot;css-0&quot;&gt;[data, *lchild, *rchild]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;遍历&lt;/h4&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;前序&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;中序&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;后序&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;层序&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;已知中序和前序或后序，都可以推导出唯一一颗二叉树&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;二叉树的建立也是一次遍历&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：O(n) 空间复杂度：O(h)（递归几层）&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;线索二叉树&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;利用二叉树的空指针域，记录前驱和后继，节省遍历的时间和空间&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;由于不能区分左右节点存的是子节点还是线索信息，所以引入布尔值 ltag 和 rtag 记录 &lt;code class=&quot;css-0&quot;&gt;[*lchild, ltag, data, rtag, *rchild]&lt;/code&gt;，区分 child 是子节点还是线索信息&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;线索化：以某种次序遍历使其成为线索二叉树的过程&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;中序的线索化：&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;树、二叉树、森林之间的转换&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;相应逆操作省略&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;树 =&amp;gt; 二叉树&lt;/h4&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;加线&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;去线&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;层次调整&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;森林 =&amp;gt; 二叉树&lt;/h4&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;树 =&amp;gt; 二叉树&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;后一颗二叉树的原根节点作为前一颗二叉树的原根节点的右孩子&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;哈夫曼树（最优二叉树）&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;压缩编码方式——哈夫曼编码&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;路径长度：两节点之间分枝数之和&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;树的路径长度：每个节点到根节点的路径长度之和&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;带权路径长度（路径长度 * 权值）最小的二叉树（最优二叉树）&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;建立最优二叉树：对最小的两个结点求和，作为其父节点的值，递归直至得到根节点&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;得到最优二叉树后进行编码，比如左为 1 右为 0（哈夫曼编码）&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;并查集&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一堆集合，每个集合没有交集&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:31.25%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAA50lEQVQY022RiY7EIAxD+/+/yl3KDfU6dCrNSBvJUgHjPNLDaI0rRoQQkLzDPTqk7rV+dd+/Es/W1x59R68Vs7WtdJ5wRiNYi73f+9Zik+YsqlJoPKv0VK22ZP/V6g0HPnVdF7wPUErDWsd1Qs4ZiZJqpJegHWwMgx8N3nsJpQ756KSQMHm2IoXmGLz3GGOgkby1jh78EySBPBfSl2yWgkXfYs4OTCnB0BzPuAMtzSefX0hXctmkM57ozqEJpQRLQ97bIqU0HDk9gVJCU9gp8geNMd9JYM6JynkGzivz2ZPhnR4h+q/+APfe0n6G+SgPAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;uf&quot; title=&quot;uf&quot; src=&quot;/static/36110e1be8cb456f8b7fe93229f46eb9/7d769/uf.png&quot; srcSet=&quot;/static/36110e1be8cb456f8b7fe93229f46eb9/5243c/uf.png 240w,/static/36110e1be8cb456f8b7fe93229f46eb9/ab158/uf.png 480w,/static/36110e1be8cb456f8b7fe93229f46eb9/7d769/uf.png 960w,/static/36110e1be8cb456f8b7fe93229f46eb9/f1720/uf.png 1024w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:812px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:70%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABuklEQVQoz31Si5KkIAzc///LGXVUQF5CeDvbqHO3tXV1KQshSZPQna+022i0nUYzDnp42mkImwhKtVrf73cruabUSqkxXht4sCIUa/zqGa22nIyU8zQhcBzHyrm1FiEyGldHa7zcSCkcg9akNdJCCR1cAh05L9P0mufzrvZ4PC4wXEyITaqFMS7EvLB5XlbGh+e4bmsHw6RSyHGeInprTWv9er3gt6jpPJxu39F7itE5V1tTUmlvb/AwjCnndhyl1pxzjHHfHfo/g0d2jgTHm6/k7F0Q3Dl9g9d1LScNPZZLSvlEdXCJgTbhOSO5Ha11qrQizoxkNzjE9KlzHSPqv3/aj2jPPN6dsKh12ncvJSjN5NEburLGlEuqDKniqVOX6vquK7pUXbpajlrRK2kVBMNKnkKI5/M8HhygkDGgIViTvAOjEJdyuNsGVRQQ3eFHTdALbjsXjIFXYyzfoJfCCsWg2bIsXIsbTBQSDDxj6f+bvG3bjDHQSUnpPUECpRQYYSsXevsQFuJPwn4ZRjUT1dqb6oZ3lkqZPpVD+A/4l3Wu/8x238W/lXH18/Ecxmkap/k1Y1QxBf8EfwM0Riwlw77hTgAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;ufimg&quot; title=&quot;ufimg&quot; src=&quot;/static/1b3659c7a4c567c52e807f2747f192c4/de514/ufimg.png&quot; srcSet=&quot;/static/1b3659c7a4c567c52e807f2747f192c4/5243c/ufimg.png 240w,/static/1b3659c7a4c567c52e807f2747f192c4/ab158/ufimg.png 480w,/static/1b3659c7a4c567c52e807f2747f192c4/de514/ufimg.png 812w&quot; sizes=&quot;(max-width: 812px) 100vw, 812px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;图&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;G(V, E)&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;V(Vertex)：点的集合&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;E(Edge)：边的集合&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;无向图：G(V, E); V = {A, B, C, D}; E = {(A, B), (B, C), (C, D), (D, A), (A, C)};&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有向图：G(V, E); V = {A, B, C, D}; E = {&amp;lt;A, D&amp;gt;, &amp;lt;B, A&amp;gt;, &amp;lt;C, A&amp;gt;, &amp;lt;B, C&amp;gt;}&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;简单图：不存在顶点到其自身的边，切同一条边不重复出现&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;无向完全图：任意两顶点都有边&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有向完全图：任意两顶点都有方向相反的两条边&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;度、出度、入度&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;连通：两顶点存在路径&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;连通图：任意两顶点都连通&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;强连通图：有向连通图&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;连通分量：极大连通（能连通的都算上）子图&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;存储结构&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;多重链表由于度有时相差很大（类似树），导致空间浪费&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;邻接矩阵&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Vertex 与 Edge 分开存，Vertex 不分主次大小所以用一维数组，Edge 需要表示顶点间关系所以用二维数组&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:450px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:95%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAABkklEQVQ4y5VU266CMBDk/7+LJ8MDKIkiogQxBAUEVC5eWDOb1BSkeM4mTVvYTndmd6uRwrqu681j34f/YBpNmHy4KAqq63r0kklAcbMcwXa7pd1ux+N2u3359QCHFMT+9XrxXFUVrVYrMk2T1us1pWn6f0DZKQxDms/n5DgO6bpOWZb1Lhz6aypNrtcrua5LcRzT/X7nKKHjZrOhtm1HE4TxiRDaRFFEeZ7z7Hke04VdLhcGFmtE+3w+R6lzhI/HgyM4HA7s7Pt+L1roJgBhZVmyn6AtJ5QBm6ah5XLJoAADNVmnJEl4yN/O5zNru9/vOZBPhGIBmgAzDONDVfzDAVw6pIiso6QwRPY1OSFYo3iRDJlOEAS8l32hNUrJsiwekKGXZVlY0EERCwMtOQkoJbCBDGAm5PiqwyHN4/HIegpwXASap9NJ2araVMshUYvFgmzb5ogALNfg2BlN1ccwAKA8QBGz6sVRAg5bCVFB+NlsxvRVYD+fL+GEloPoKGpVZ/zp+VL199Q7+PM9VGk0FR3sDbhqyMBISiWHAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;uGraph&quot; title=&quot;uGraph&quot; src=&quot;/static/4d10fe4fcfa48a2683ad46324f9465e4/7f757/uGraph.png&quot; srcSet=&quot;/static/4d10fe4fcfa48a2683ad46324f9465e4/5243c/uGraph.png 240w,/static/4d10fe4fcfa48a2683ad46324f9465e4/7f757/uGraph.png 450w&quot; sizes=&quot;(max-width: 450px) 100vw, 450px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:450px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:95%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAABsklEQVQ4y5VU147CMBD0/38MgideeKKKIjoIEDVEFNERRdQ9zUo2IVnn7lZaxXHs8ex4sopC4v1+c3rH/jl/qN8AbRtt39Rfwfb7PY1GI5rP5/9jKJV0uVyo0WjQeDym6XRKy+UysNYAShohXq8XJ2Kz2VCxWKRCocC5WCzEPYahX3ANhACbXq/H2Ww2KZFIGIZ6nRdUSTogBoMB5fN51gxxPB7JcRwedzqdL5ZeUKVPwgJsQHmz2YxLg1461us1px5Ho1HRUgzoui61223abrdULpfN6Yjn82lAdrudmT+dTtTtduVbBmAmk6F6vc6LNIhXy1arRY/H42seh2AeBKCrYYjThsMh1Wo1SiaTbA8vGIBisRjd7/eAnUqlEoNBrtVq9bkUAIAZPoJtPB43gNfrlavw3yjMXqlUKJfLsa3AVEkGBdtIJEL9fp/fD4cDny4ZH9VAJgCjEiX99GCazWZZU/gPwNho+4dvt5tsbP9CgKTTaZpMJswaLpC8F/ChDRSXVa1WuRwk/BnW1gLNQSod5aIxpFIpOp/P1qYQ2m28T4DiUrQHbUCh/dDW7yTt/PEDOf+/h5Cqa0UAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;dGraph&quot; title=&quot;dGraph&quot; src=&quot;/static/c8eada97e0c67a4edaa4a3252e53e782/7f757/dGraph.png&quot; srcSet=&quot;/static/c8eada97e0c67a4edaa4a3252e53e782/5243c/dGraph.png 240w,/static/c8eada97e0c67a4edaa4a3252e53e782/7f757/dGraph.png 450w&quot; sizes=&quot;(max-width: 450px) 100vw, 450px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;vi, vj 是否连通或存在弧，判断 Edge[i][j] 是否等于 1&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:450px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:95%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAAB60lEQVQ4y42UV6syQQyG9///Gq+8ErwQLAiKvWBv2LD3lsOTQ/xm1z3yBZYZZrLJmzdvxpMv9nq9/uvMNQ8Hc3JX21+vVxkOh9Lr9WSz2fjug/9pwGDmIILxeCzlclnXdrstz+fze8Cwi9vtJufzWfeNRkOazaakUikpFotfKWDvudnIju12Ow0EKoIVCgXpdDpSq9W09OPxKPV6PRStF0Zyq9WSZDKpnD0eDw3CipEgEonIdDoNRascUt5isdAArAQbjUbqNJvN9MOsgsPhoEnx3+/3slqt3nfe/X6XarUq/X5fy6Qs10B3uVw+uk8AqMCf5IPB4Dfg6XTSQz44MzSUtFwuNWAY+XwEqlQqyme32xXAKYegM/JJgG23W4nFYtoMQ+Siw+bzuQLJ5XL/EFpWLu3QGpDJZGS9Xn+I2QKDCI3Co082dhmNRt8lgnAymfgQBXkkGbS4Pu+AcAYXdM8mhI7/NZJYPB7XsWQQfLJxneATORCY0snsCtgoQWrpdFoRIvSPkg0yTSiVSj5ugrNNUhpo5bqgfLNMh0FG6ZSCLpFDIpFQ1JyhWc7ZWxNdSnwl0xheFNBls1n9AZSgIRF7ZMJ9Pp9/a9bt/sfzBUq6i4zcRDwYNnYImiYaTb7H4dtbGJSMu//rBf8BWl22PDXf9zkAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;net&quot; title=&quot;net&quot; src=&quot;/static/ea11de3127df39f0f851d8dd59f27071/7f757/net.png&quot; srcSet=&quot;/static/ea11de3127df39f0f851d8dd59f27071/5243c/net.png 240w,/static/ea11de3127df39f0f851d8dd59f27071/7f757/net.png 450w&quot; sizes=&quot;(max-width: 450px) 100vw, 450px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;无向网（无向带权图）类似&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;vertexsNum 个顶点，edgesNum 个边，时间复杂度：O(vertexsNum + vertexsNum ^ 2 + edgesNum) == O(n ^ 2)&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;邻接表&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;邻接矩阵存稀疏图时有极大浪费&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:29.166666666666668%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3UlEQVQY0z2QhwqFMAxF+/9fKIp71YkbFDXvnUANRNNxz01q5B/3fct1XeLiPE+p61qqqpI4jqXrum+9LIs4zfM8X+3Who22bSVJkg/IIYAoihRordV/GIZSlqWCSe6QaGFgbPgcx6HO27apy/u+0ve95HmuAOogCMTzPN0DTu37vmrRreuqk5lxHGXfdwWlaapOxDAM0jSNuk7TpKAsy7QjTOjamXEH4DzPYng7RkHk3oHkEmMBxRQzOmMNiCyKQnVAgTGlYTzo7oEJ9jikGwDUAOiQCegOGOl07v8DAKLGrtBYYTIAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;adjList&quot; title=&quot;adjList&quot; src=&quot;/static/fb1c91f73a5fc55b2728ae818b12bc15/7d769/adjList.png&quot; srcSet=&quot;/static/fb1c91f73a5fc55b2728ae818b12bc15/5243c/adjList.png 240w,/static/fb1c91f73a5fc55b2728ae818b12bc15/ab158/adjList.png 480w,/static/fb1c91f73a5fc55b2728ae818b12bc15/7d769/adjList.png 960w,/static/fb1c91f73a5fc55b2728ae818b12bc15/87339/adjList.png 1440w,/static/fb1c91f73a5fc55b2728ae818b12bc15/73d34/adjList.png 1464w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:85.83333333333334%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAABvUlEQVQ4y4WU2Y7CMAxF8/9/xwMgKGWHtpR9K0vBo2PJkamGmUghSdPcHPu6hPf7Ldat2Xy320me57JYLGQ8HstyuZTj8ajr1Wolp9Mpvm89eKHNZiP3+z2un8+nChRFoZ39/X4v0+lUBQ+HgzRb4Of1eult3W5XsiyLm3VdS1mWMp/PldaI2+22DIdDFeXs+XyWy+WiAOF6vcpgMNDbmW+3W6VBDHoEkySR2WwWKdM01eeIA8CFjBAHbiA3vV4vhsDtVVXpfL1e6z6hQsRhCBknk4nmlj4ajfSdYOH1+3096JuFTM4gQPx2uyklKSIiQgUEMSCiKbxILrxr0HMYEoi8Cez5ua2DL5P/GsSkg0v8xb7cgn9ICJQJ+HRcxTnIoGcP0yy/XuijDk2QgziHoyQaGlLByJqwLURyB8Dj8fj4GD5CZiTZkEDBASgxgzUi7CGMWTz3X4sKekJyRKhQIgQxArhPDSICEWmAnK+K+VdCQkGEg4xGS8kYkYXYzGE0xT+AEDL7ThG0gsZZL+iN+FMQF6ExOoR9yPbn0RT8agrJtzIxEyC0Umq62gw9NPPwW0O41WpJp9OJNfiN8AfTgiMkNd+LYAAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;ALAdjList&quot; title=&quot;ALAdjList&quot; src=&quot;/static/3271058bd13047dc27e12c44f9db6a50/7d769/ALAdjList.png&quot; srcSet=&quot;/static/3271058bd13047dc27e12c44f9db6a50/5243c/ALAdjList.png 240w,/static/3271058bd13047dc27e12c44f9db6a50/ab158/ALAdjList.png 480w,/static/3271058bd13047dc27e12c44f9db6a50/7d769/ALAdjList.png 960w,/static/3271058bd13047dc27e12c44f9db6a50/47d67/ALAdjList.png 1220w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于有向图，邻接表可以轻松获取出度的信息，而入度的信息需要遍历整个邻接表才行；逆邻接表则相反&lt;/p&gt;&lt;/blockquote&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;顶点用一维数组存（也可以用链表，不过数组方便读取信息）&lt;code class=&quot;css-0&quot;&gt;[[data, *firstEdge], ...]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;由于顶点的邻接点个数不定，所以边用链表存 &lt;code class=&quot;css-0&quot;&gt;[adjvex, *next]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:34.166666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABG0lEQVQozzWR666CQAyEef8384eJmBghIoLIRRQFJIhgnHO+Jtuk2710p9Opp3/7fr/6fD5s9fv9LPZ9r+v1qrIslSSJuq5TURTmnPM8t7vn82lO/rIs8liqqrKkaZrk7P1+63K56Hw+WwQ8jmOt12ttNhtlWaZ5ntU0jQEOw6DH4yHvdrvZJQB8atvWAEnmTDFyiMfjUavVSkEQGAGKHQ4Hc/YGyEIFDLZpmlrbAAJ0v9/tnfZgtd1uLVIM4P1+r91upzAMrW1jCDvs9XrZJYamsEKzuq7NT6eTfN9XFEVWDCkgADsibXuIyyeYohHM3KAYCMkAwxIAmAA8jqPlAIxMdGAtMwgYEt1Q3KTRFq1ozxlvzl1XOAXI/wODnxAccorroQAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;ALNetAdjList&quot; title=&quot;ALNetAdjList&quot; src=&quot;/static/d80cff9128363be9e303e8fd59206cd2/7d769/ALNetAdjList.png&quot; srcSet=&quot;/static/d80cff9128363be9e303e8fd59206cd2/5243c/ALNetAdjList.png 240w,/static/d80cff9128363be9e303e8fd59206cd2/ab158/ALNetAdjList.png 480w,/static/d80cff9128363be9e303e8fd59206cd2/7d769/ALNetAdjList.png 960w,/static/d80cff9128363be9e303e8fd59206cd2/357aa/ALNetAdjList.png 1388w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;十字链表&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;解决有向图邻接表入度信息需遍历整个邻接表获取的问题&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;整合邻接表和逆邻接表&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;顶点的一维数组 &lt;code class=&quot;css-0&quot;&gt;[data, firstIn, firstOut]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;边链表 &lt;code class=&quot;css-0&quot;&gt;[tailVex, headVex, *tailLink, *headLink]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:52.916666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABbUlEQVQoz42Sy46CQBBF+f/vwoXRldEFYPCNiO+3InhnTiVlGFfTSaW76epTl1sd6He8328m1XWtPM+12WxUFIX2+72qqtJ/hjMCFr4py1KLxcJiMpnocDjoeDxqNBopjmOlaWo5r9dL1+vV1vf73YQ49A+QeTqd2sUsywyI0sFgoCiKlCSJLpeL5vO5wjBUq9WyM/8LA35L5hBVxOl0MgBgrDifz/YNKyg6HA4tz5UakM14PP7I3u12poqZ4ILbsF6vLbbb7SeHGcbj8TAxATCasFqt7AOV2HMJnwCgbjabablcmmJA7AnOns+nQQ2IdC7fbjczm0NAXKQqa1TiLXmce1GKYQM5fDcgC2A+SKSyPxsgdJxO8xfAUUoOe6ygOGIM+N0UvESZK6SgqwKGIveWBrGmaYgyoD8bB6IMRTwbIM2B+k6no263q3a7rX6/r16vZ8FTQkDQfIO+du+YPVDZbAZvEv+xhcLk83c/JkRIvmCMC9IAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;tenLinkList&quot; title=&quot;tenLinkList&quot; src=&quot;/static/49f43333317e382d80a28c504d81dc52/7d769/tenLinkList.png&quot; srcSet=&quot;/static/49f43333317e382d80a28c504d81dc52/5243c/tenLinkList.png 240w,/static/49f43333317e382d80a28c504d81dc52/ab158/tenLinkList.png 480w,/static/49f43333317e382d80a28c504d81dc52/7d769/tenLinkList.png 960w,/static/49f43333317e382d80a28c504d81dc52/87339/tenLinkList.png 1440w,/static/49f43333317e382d80a28c504d81dc52/76593/tenLinkList.png 1534w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;邻接多重表&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果无向图的邻接表在操作时注重顶点而不注重边，则邻接表没什么问题&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果注重边，由于无向图是没有方向的，其邻接矩阵是对称的，一个边会有两个边节点表示，这时使用邻接表对于边的操作就不方便&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;边：&lt;code class=&quot;css-0&quot;&gt;[iVex, *iLink, jVex, *jLink]&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;将一个边用两个顶点表示，v0 结点有三个边：(v0, v1)、(v3, v0)、(v0, v2)，各个边之间通过 v0 的 link 连接&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;把顶点的边还原成邻接表看，最后一个指针还是 NULL，添加时只需要构建一个边，最后的指针指向这个边的相应 vex，对应 link 为 NULL&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;删除则把指向 vex 的指针和 link 合并成一个，然后把边删除就行&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:62.083333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABVklEQVQoz32T666CQAyEef/XM+gPIiCIclEQUEBQa74mSzYeOE02e6GdTqfF+Xw+wsJ+z9j7/Z7Ptr1eL7nf7zIMg3RdJ23byjiO4hgQO8i+4+h5nuz3e9lsNnI+nyVNU9ntdvru+76cTidN0Pe9OHbWsix12QzZj8ejBEGgexzHurIsUyAA8zyXaZqUrTIE/fF4qOPhcPhTNiVdr1dpmkaez6eWCksYJ0kidV0rO/wcnCiHDDyiWVEUGmwMBlEUabkkBYy3MAyVNWy5A+zA7na7aVb0gjal4GSMbzA0TPADYLvdKjjvvMF+1hAAmBLw2yC+IQXBlMjOG2xhzh3JFNAE03I0WOo0zjTLZni5XMR13Zkh+8xwaWTsxuBMl5HCaInOnOky30k4d3ltqNdmk8ahKdobvbnrYC8F/IIuacpQw9B0GSkwR1bsv1+yqirVEDAz2AbwCzDPnIKslAvEAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;multiyAdj&quot; title=&quot;multiyAdj&quot; src=&quot;/static/c89549f1d00f7433ccf777cf768ea615/7d769/multiyAdj.png&quot; srcSet=&quot;/static/c89549f1d00f7433ccf777cf768ea615/5243c/multiyAdj.png 240w,/static/c89549f1d00f7433ccf777cf768ea615/ab158/multiyAdj.png 480w,/static/c89549f1d00f7433ccf777cf768ea615/7d769/multiyAdj.png 960w,/static/c89549f1d00f7433ccf777cf768ea615/78687/multiyAdj.png 1212w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;边集数组&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;[begin, end, weight]&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;边集数组关注的是边的集合，要查找一个顶点的度需要遍历整个边集，效率不高，更适合对边进行处理，不适合对顶点操作&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;遍历&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用邻接矩阵&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;最小生成树&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;连通图：任意两顶点都连通&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;构造连通图最小代价的生成树&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;Prim&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;以某点为起点，逐渐找到已构建的生成树的顶点上权值最小的边，并将顶点加入生成树，直至所有顶点都加入后得到最小生成树（贪心）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:650px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:80.41666666666667%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB0ElEQVQ4y3WUV48CMQyE8/9/Ek9IwAMSRVTRe++9g+8+S+ayy2EJJUuc8czYu05+4/V66c/f+/8dj0fZ7XbyLdffO3sIJzyfT11vt5vk83kpFAqyWq3EIgxmq/MTwvvBYCDdbleq1aqCDodDmU6nslgs3rlW2O58MOTCaDSS8XisYKfTSfw4HA56PpvNpNfrad71ev1j6FO/3+9SLpclnU5Lu91WuWEm5ilgqVRK4vG47Pf7oGRfbqfTkUajoUnFYlFqtZoyQj7sWSuVijLH03q9HpAdYAgA3Wy1WrJer99sYB2JRNTDcJif7y4bGD5wkcAXWNkZvsEKdnbZWAFokrUpHEKf5PP5rMyQjD/L5fKdCPPNZiPJZDLAEDUos8IO9EwmI7lcTg+bzaaCx2KxgEQ6TpMo2O/3dYUlZFC03W6VrbtcLlIqlRQUAH9MaAKsCM7n87numctsNiuTyUSfuUeDKOJsJJDO2FCFBBsbmCOdQkgiFwL4jSK8ZjJQBajzR8bi8XgoC5IoYCuyAIOZyWVsmFs8B9x9+yAYczzGMyRThIGGSSKRUACKMKu8mljyAeiPhf8GMTbRaFRBePbfHAuKu29fj/8+YdbZ8B3LwfMfTvzJBohHCcIAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;prim&quot; title=&quot;prim&quot; src=&quot;/static/cf349133a0ab20f4e00703869df9c38f/c8518/prim.png&quot; srcSet=&quot;/static/cf349133a0ab20f4e00703869df9c38f/5243c/prim.png 240w,/static/cf349133a0ab20f4e00703869df9c38f/ab158/prim.png 480w,/static/cf349133a0ab20f4e00703869df9c38f/c8518/prim.png 650w&quot; sizes=&quot;(max-width: 650px) 100vw, 650px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;v0 初始化
adjvex[] = v0; lowcost[i] = g.arc[v0][i]&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找到 lowcost 中不在当前生成树中（!= 0）且最小的边的顶点 k = v1，权为 min
v1 放入当前生成树中（lowcost[v1] = 0）
操作（输出）k、min&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;v1
因为 lowcost[v0, v1] == 0（已在当前生成树中），所以不更新 v0, v1
因为 18 &amp;lt; INF 所以更新 lowcost[v2] = 18; adjvex[v2] = v1
因为 12 &amp;lt; INF 所以更新 lowcost[v8] = 12; adjvex[v8] = v1
因为 16 &amp;lt; INF 所以更新 lowcost[v6] = 16; adjvex[v6] = v1
其他的因为当前生成树到其距离 &amp;gt;= 原来的距离，所以不更新&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找到 lowcost 中不在当前生成树中（!= 0）且最小的边的顶点 k = v5，权为 min
v5 放入当前生成树中（lowcost[v5] = 0）
操作（输出）k、min&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;v5
因为 lowcost[v0, v1, v5] == 0（已在当前生成树中），所以不更新 v0, v1, v5
因为 26 &amp;lt; INF 所以更新 lowcost[v4] = 26; adjvex[v4] = v5
其他的因为当前生成树到其距离 &amp;gt;= 原来的距离，所以不更新&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找到 lowcost 中不在当前生成树中（!= 0）且最小的边的顶点 k = v8，权为 min
v8 放入当前生成树中（lowcost[v8] = 0）
操作（输出）k、min&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;v8
因为 lowcost[v0, v1, v5, v8] == 0（已在当前生成树中），所以不更新 v0, v1, v5, v8
因为 21 &amp;lt; INF 所以更新 lowcost[v3] = 21; adjvex[v3] = v8
因为 8 &amp;lt; 12 所以更新 lowcost[v2] = 8; adjvex[v2] = v8
其他的因为当前生成树到其距离 &amp;gt;= 原来的距离，所以不更新&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找到 lowcost 中不在当前生成树中（!= 0）且最小的边的顶点 k = v2，权为 min
v2 放入当前生成树中（lowcost[v2] = 0）
操作（输出）k、min&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;v2
因为 lowcost[v0, v1, v5, v8, v2] == 0（已在当前生成树中），所以不更新 v0, v1, v5, v8, v2
其他的因为当前生成树到其距离 &amp;gt;= 原来的距离，所以不更新&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找到 lowcost 中不在当前生成树中（!= 0）且最小的边的顶点 k = v6，权为 min
v6 放入当前生成树中（lowcost[v6] = 0）
操作（输出）k、min&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;v6
因为 lowcost[v0, v1, v5, v8, v2, v6] == 0（已在当前生成树中），所以不更新 v0, v1, v5, v8, v2, v6
因为 19 &amp;lt; INF 所以更新 lowcost[v7] = 19; adjvex[v7] = v6
其他的因为当前生成树到其距离 &amp;gt;= 原来的距离，所以不更新&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找到 lowcost 中不在当前生成树中（!= 0）且最小的边的顶点 k = v7，权为 min
v7 放入当前生成树中（lowcost[v7] = 0）
操作（输出）k、min&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;v7
因为 lowcost[v0, v1, v5, v8, v2, v6, v7] == 0（已在当前生成树中），所以不更新 v0, v1, v5, v8, v2, v6, v7
因为 7 &amp;lt; 26 所以更新 lowcost[v4] = 7; adjvex[v4] = v7
因为 16 &amp;lt; 21 所以更新 lowcost[v3] = 16; adjvex[v3] = v7
其他的因为当前生成树到其距离 &amp;gt;= 原来的距离，所以不更新&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找到 lowcost 中不在当前生成树中（!= 0）且最小的边的顶点 k = v3，权为 min
v3 放入当前生成树中（lowcost[v3] = 0）
操作（输出）k、min&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;v3
因为 lowcost[v0, v1, v5, v8, v2, v6, v7, v3] == 0（已在当前生成树中），所以不更新 v0, v1, v5, v8, v2, v6, v7, v3
其他的因为当前生成树到其距离 &amp;gt;= 原来的距离，所以不更新&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找到 lowcost 中不在当前生成树中（!= 0）且最小的边的顶点 k = v4，权为 min
v4 放入当前生成树中（lowcost[v4] = 0）
操作（输出）k、min&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;循环完，得到：&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;得最小生成树：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：O(n ^ 2) // 可优化（算法导论 23.2）&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;Kruskal&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找最小权值的边来构建，同时避免形成环路（贪心）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;遍历 e 条边，每个边进行 find，find 的时间复杂度为 O(loge)（树），所以总时间复杂度：O(eloge)&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;最短路径&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;两顶点之间边上权值之和最小的路径&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;Dijkstra&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;从源点出发，每次选择离源点最近的一个顶点前进，然后以该顶点为中心进行扩展，最终得到源点到其余所有点的最短路径（贪心）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;D 到 A&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:712px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:59.583333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABVElEQVQoz3WT646CQAyF5/2f0B8SEuWmgiAogqLdfE3OZHaTbTLpXHra08uE7/driPTn87FhGGyeZ5NM02TP5zOe2fd9b9u2/cKigza6vN/vlmWZVVXljjkfDger69oej4fdbjc7nU5WlqW//cUHHWC2LEsEXC4XZ8DSO7Kuq53PZ1/Ypg4jQ6UKM6VKWm3bWiqcYYXTcRw9GI7T8gQxw8Hr9fJLMeMOYxyw77rOA/MmJ2CpMVjewvV6tePx6JEAvd9v2+/3nrIaVBSF26QBqamaQoN2u53rAEA1EyNpFu8EI12YIgRVQAQbmoSOKQPGMBVSJCrMqJ1qih0dV8rUE+0pp2AAaVoqvM50FfaAccgduHR84tgQFQ0I+pRBd0RWegRsmsbyPPdZxTFvcWw0kOmvwBCHpEspGGzqqMHGIY0iAzn796dggGH61WAqhumo6C7F/wDAAKTsaO5m9wAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;dijkstra&quot; title=&quot;dijkstra&quot; src=&quot;/static/4ff76cf87c19e6d130533ed766a97c80/24e04/dijkstra.png&quot; srcSet=&quot;/static/4ff76cf87c19e6d130533ed766a97c80/5243c/dijkstra.png 240w,/static/4ff76cf87c19e6d130533ed766a97c80/ab158/dijkstra.png 480w,/static/4ff76cf87c19e6d130533ed766a97c80/24e04/dijkstra.png 712w&quot; sizes=&quot;(max-width: 712px) 100vw, 712px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;distance { 点: 该点到原点的最短距离 } // 记录各个点到原点的最短距离&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;path { 点: 最短路径上点的前驱点 } // 记录最短路径&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;found { 点: 是否已找到原点到该点的最短距离 } // 0: false, 1: true&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;初始化
根据 g-&amp;gt;arc[D] 初始化 distance，原点距离自己为 0，distance[D] = 0
path 初始化为全是原点
found 原点不用找，found[D] = 1，其他为 0&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据边的权值最小且没有走过找到 C，走到 C，found[C] = 1
因为 found[D, C] = 1 所以不更新 D, C
因为 3 + 6 &amp;lt; INF 所以更新 distance[F] = 9; path[F] = C
因为 3 + 10 &amp;lt; INF 所以更新 distance[B] = 13; path[B] = C
其他的因为 C 到其距离 &amp;gt;= 原来的距离，所以不更新
走完 C&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据边的权值最小且没有走过找到 E，走到 E，found[E] = 1
因为 found[D, C, E] = 1 所以不更新 D, C, E
因为 4 + 2 &amp;lt; 9 所以更新 distance[F] = 6; path[F] = E
因为 4 + 8 &amp;lt; INF 所以更新 distance[G] = 12; path[G] = E
其他的因为 E 到其距离 &amp;gt;= 原来的距离，所以不更新
走完 E&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据边的权值最小且没有走过找到 F，走到 F，found[F] = 1
因为 found[D, C, E, F] = 1 所以不更新 D, C, E, F
因为 6 + 12 &amp;lt; INF 所以更新 distance[A] = 18; path[A] = F
其他的因为 F 到其距离 &amp;gt;= 原来的距离，所以不更新
走完 F&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据边的权值最小且没有走过找到 B，走到 B，found[B] = 1
因为 found[D, C, E, F, B] = 1 所以不更新 D, C, E, F, B
其他的因为 B 到其距离 &amp;gt;= 原来的距离，所以不更新
走完 B&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据边的权值最小且没有走过找到 A，走到 A，found[A] = 1
因为 found[D, C, E, F, B, A] = 1 所以不更新 D, C, E, F, B, A
其他的因为 A 到其距离 &amp;gt;= 原来的距离，所以不更新
走完 B&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据边的权值最小且没有走过找到 G，走到 G，found[A] = 1
因为 found[D, C, E, F, B, A, G] = 1 所以不更新 D, C, E, F, B, A, G
走完 B&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据 path[A] = F, path[\F] = E, path[\E] = D, path[\D] = D 得最短路径：D -&amp;gt; E -&amp;gt; F -&amp;gt; A&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;权不能是负数&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：O(n ^ 2)&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;Floyd&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在两个顶点之间插入一个或一个以上的中转点，比较经过与不经过中转点的距离哪个更短（动态规划）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:514px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:73.33333333333334%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAABl0lEQVQ4y42U564qMQyE9/2fDQESAgTs0ovovRcffdadKAv741qKkk1cxuOBxP7Z5/Px/XK52O128/P7/bb4Xd/3+93O53MuTpbEl7vdzrrdrqVpGgKez6ddr9cQQEHesyyz5XL5kzSXEKfD4WDH49HK5bINh0NrNBpWqVRsMBhYv9+3Uqlkp9PJUVJcsdoTDvpYLBYeBILVamWv18sej4fvJADtdru1LM2s2Wx6ESULCb8v6vW6zWazHC9xSySsVqsBsbguRMiDnHSvN1D2er2ACuMbTuPCiQJop9Pp2HQ6zU1Y99DA0GLEm83G/RkaBX8QQjKEy3BiUCxZ3B5nYuAbrkNCBfMoo3qr1bL9fv9DfHwej8eujNCyWiOQKQspXMVIvnnVG3pFXvLzKcMBWmu32z4UdPhtEnqRoVWhTCAdRCRhpxqaA7FEzjDQHfzys5Q2MSTGwKAH/wR0jB+H+XwedAg38ZpMJjYajbwgC0oYVq1W8w7RJ3fe8nq9dmkQ8D+mPwp2ISSeDpIi4uWsvWgYsYFQsvkDGFGGGBkyrwQAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;floyd&quot; title=&quot;floyd&quot; src=&quot;/static/5f43aaea7415163de6e7e106ead9e9cb/6cd8a/floyd.png&quot; srcSet=&quot;/static/5f43aaea7415163de6e7e106ead9e9cb/5243c/floyd.png 240w,/static/5f43aaea7415163de6e7e106ead9e9cb/ab158/floyd.png 480w,/static/5f43aaea7415163de6e7e106ead9e9cb/6cd8a/floyd.png 514w&quot; sizes=&quot;(max-width: 514px) 100vw, 514px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;初始化&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;k = 0&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;k = 1
distance[0][1] + distance[1][2] == 3 + 4 &amp;lt; 9 更新：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;distance[0][2] = distance[2][0] = 7;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;path[0][2] = path[0][1] = 1; path[2][0] = path[2][1] = 1;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;distance[0][1] + distance[1][3] == 3 + 13 &amp;lt; INF 更新：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;distance[0][3] = distance[3][0] = 16;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;path[0][3] = path[0][1] = 1; path[3][0] = path[3][1] = 1;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;k = 2
distance[0][2] + distance[2][3] == 7 + 5 == 12 &amp;lt; 16 更新：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;distance[0][3] = distance[3][0] = 12;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;path[0][3] = path[0][2] = 1; path[3][0] = path[3][2] = 2;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;distance[1][2] + distance[2][3] == 4 + 5 == 9 &amp;lt; 13 更新：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;distance[1][3] = distance[3][1] = 9;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;path[1][3] = path[1][2] = 2; path[3][1] = path[3][2] = 2&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;k = 3&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;0 -&amp;gt; 3:&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：O(n ^ 3) 空间复杂度：O(n ^ 2)&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;拓扑排序&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;AOV（Activity On Vertex Network）网：在一个表示工程的有向图无环中，用顶点表示活动，用弧表示顶点之间的优先关系&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;拓扑序列：设 G = (V, E) 是一个具有 n 个顶点的有向图，V 中的顶点序列 v1, v2, …, vn 满足若从顶点 vi 到 vj 有一条路径，则在顶点序列中顶点 vi 必在 vj 之前，则我们称这样的顶点序列为一个拓扑序列&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:436px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:61.66666666666666%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABR0lEQVQoz41T266CQAzc//8knvWBJyIRFAlyVRJREi4xoEBPpie7WThoThNgu922M7NF0IpN0zT7/jcGE/qB5QPruo5OpxMdDgdqmuZPUf0svkIP6OtxHNn3fZ+KoqCqquh4PM6QLvNmCNfoXC4X2m63Kr7b7Wi/33+VgRG+Xi9GAgSPx0Mhi+OY8jznfenf73cu2vc9DcPAcnieR2VZ/iLEKwgCToRGjuOQbdt0u90UAtCVCbC2bbmIZVl8DnHXdbmBkGiw+Xw+uftms1EUpJbSkATLsowMw+BLAxCAwpoLojsKAX4URcqX2lyvVy7wfr/ZP5/PFIbhLA97s0uBJnIsZBOMCqhFYURJkvBaaikNqCCBmsPlkOo067om0zT50tAQaIBsOWq6Lz4NqSwKZKADyqAmY5/yxNpMLQcWGqZpqi7k2+/3A4tUnSaMtTadAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;topological-seq&quot; title=&quot;topological-seq&quot; src=&quot;/static/7a1e08ce8a52f7165de45428d0d847ed/e7d53/topological-seq.png&quot; srcSet=&quot;/static/7a1e08ce8a52f7165de45428d0d847ed/5243c/topological-seq.png 240w,/static/7a1e08ce8a52f7165de45428d0d847ed/e7d53/topological-seq.png 436w&quot; sizes=&quot;(max-width: 436px) 100vw, 436px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;0, 1, 2, 3 是；0, 2, 1, 3 也是&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;拓扑排序：对有向图构造拓扑序列的过程&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;BFS&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据顶点入度判断是否有依赖关系，每次选取入度为 0 的顶点输出&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;没有顺序要求，队列也可以&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;也称入度表法（贪心）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;v 个点 e 条边，for v 之后入度减一的操作有 e 次，所以时间复杂度：O(v + e)&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;DFS&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;深度优先搜索过程中，当到达出度为 0 的顶点时，进行回退，同时记录出度为 0 的顶点，将其入栈，最终出栈的逆序为拓扑序列&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：O(v + e)&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;关键路径&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;AOE（Activity On Edge Network）网：在一个表示工程的带权有向图中，用顶点表示事件，用边表示活动，用边上的权值表示活动的持续时间&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;路径长度：各个活动所持续的时间之和&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;关键路径：从原点到终点具有最大长度的路径叫关键路径（v1-&amp;gt;v2）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;关键活动：关键路径上的活动（e1, e2）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;相比原来拓扑排序多了找最大路径的一步：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：O(v + e)&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;查找&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;静态查找表：只做查找&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;动态查找表：查找是同时插入或删除&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;顺序表查找&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;遍历一遍&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;有序表查找&lt;/h3&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;二分法&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;mid = (low + high) / 2 = low + (high - low) / 2&lt;/code&gt;&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;插值查找&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据查找关键字跟查找表中最大最小的关键字进行比较后的查找&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;mid = low + (high - low) * (key - a[low]) / (a[high] - a[low])&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;相较于二分法不再是每次分一半的查找，认为分布是均匀有序的，根据值分布的位置 &lt;code class=&quot;css-0&quot;&gt;(key - a[low]) / (a[high] - a[low])&lt;/code&gt; 进行查找&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;斐波那契查找&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;// TODO&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;线性索引查找&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;索引就是把一个关键字与它对应的内容相关联的过程&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;索引按结构可分为线性索引、树形索引、多级索引&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;线性索引：索引项集合组织为线性结构，也称索引表&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;稠密索引&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在线性索引中，将数据集中的每个记录对应一个索引项，其索引表中的索引项一定按照关键码有序排列&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:890px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:75%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB70lEQVQ4y32TV6sCQQyF9///IX0QfRJBrKjYsPfee8nlO5BFEe7AMNlM5uTkJBvYP+v9fn+d5/PZVquVXS4Xu16vtt/vbbvd2uFwCGMCnJPJRLvT6dh6vZZ9v99DsNfrJbvX61kkErFyuawdi8UsGo1aMpm08XisNwIcjUZWKpUskUjozGazdjwef9g2m01rtVpixYKl27AGK+Bjs9mI2Xw+FxBBJHk8HnrkMdVq1er1uiqZzWaKn06ntlgsFE9MQObb7aaLbrerC3SiBLQBHFaANBoNGwwG2rABkDcAYUNKDE+nkwDT6bQNh0Np6KUsl0s9JjHJuEdL/IDAFCAIhIAw5AIGXJAVFrvd7kvLdrttmUzG+v2+EgLqyQFXyQTiAIhmoAcX8XhcTOgw7ADP5XJqGoDEEMu7H0BKppR8Pq8TzWD4OU5s/DQGQMoDEKm85BCQgaVkxoJMaEYSFjK4htiVSkVa8gYAAInFhqkAeQCzQqEgRgTByG0A0BkfYwMwPqrA57qjadgUnDAkEBtwspIdYO5qtZoagx9tYUm5z+fze7ARHJBUKqUZpGyyfS66DSDs0JGGsWGIpiRCNg02GQCANmzI6uPiXWahX7FYVKn8QRABhCr4hlTgwb4AIIH/v75dGsqiCsCwScwfxTfnHxsPaEMsaX+9AAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;dense-index&quot; title=&quot;dense-index&quot; src=&quot;/static/6ec6702659e6b224a3339f9573ea971a/dcb99/dense-index.png&quot; srcSet=&quot;/static/6ec6702659e6b224a3339f9573ea971a/5243c/dense-index.png 240w,/static/6ec6702659e6b224a3339f9573ea971a/ab158/dense-index.png 480w,/static/6ec6702659e6b224a3339f9573ea971a/dcb99/dense-index.png 890w&quot; sizes=&quot;(max-width: 890px) 100vw, 890px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有序后可以使用有序表查找，大大提高查找效率&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;分块索引&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;把数据集分成若干块，块内无序（不要求有序，会付出大量时间和空间的代价），块间有序&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:890px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:121.66666666666669%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAABYlAAAWJQFJUiTwAAACaElEQVQ4y5WU147DUAhE/f9flafkIb333nvvhd3DCiu27CiLhOw43GEY4Drya6/Xy+P27fl8er4dDgeZz+eyXq/lfD7L/X53nVjMsWAzP6i93243qdVqkk6nJZPJSKvVktlspj6dTvVJjONnaL/DAMvlskwmEzkej7LdbmW/3yvb4XCoFYQC+sE5FI1GJZfLSa/Xk8ViId1uV4Hs/XQ6BZcclISDlIkPBgNlh57L5VI2m430+/0/wKCm+NlxmIOwKJVKUq/XNUGj0ZBOpyPj8djLMMwxgijp8XgoOwBhdrlcZLVaKTtikMHV8JPRAMBpCoyKxaJUKhUFaLfbyoxySUajHDJT0m63U0d8MuJoxRO7Xq8uQ8aE7ySDPUAuQwtkvuLxuDLAI5GI5PN5V0sYNptNZYmGMAMEdqPRyNsUdOBPGBGIRrAgsxmbwH8kZnQAYGPQkYaZzgrIQViiTbVaVRboAyjMaACyZLNZZU+sNQRHKs9gQ5XsBAJGdtgSRDK2AYBkMqky8B0gnugIU8bHBSQ7K1UoFBTYwMhsRjkcgiXskYUYZpB3JNMuE0xJLLeVzZPDBHGTWIyNDVLYzQNzgCBCJZ7VQ1wO0E20gxWJCCQOwFQqpY3hooAh8pCYTpPc8V8GQYYklEYiZLFZhB2OhmjJDDtBt0zQCqJnLBbTxjAiVGAdZpbRXZvyCfD9gqAcGNJlBtvWzVYPzd3BDrN3YFigYSKR0PI4TNno/q/L4R3QdhmmNIEycd5h6I7Nt4DMH91lXNDQtoX/YKhj8y0gGtJpymVc0I4EvOMw1S7LFxY0UiwAl4TffgBVXCY3Rqbs2QAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;block-index&quot; title=&quot;block-index&quot; src=&quot;/static/ea77551996c9e24aea6395ec04d0a8c9/dcb99/block-index.png&quot; srcSet=&quot;/static/ea77551996c9e24aea6395ec04d0a8c9/5243c/block-index.png 240w,/static/ea77551996c9e24aea6395ec04d0a8c9/ab158/block-index.png 480w,/static/ea77551996c9e24aea6395ec04d0a8c9/dcb99/block-index.png 890w&quot; sizes=&quot;(max-width: 890px) 100vw, 890px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;最大关键码&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;块长&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;块首指针&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;先有序表查找，再顺序查找&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;倒排索引&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;例：两篇文章：&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Books and friends should be few but good.&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;A good book is a good friend.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;style data-emotion-css=&quot;f4lqjx&quot;&gt;.css-f4lqjx{width:100%;margin-top:2rem;margin-bottom:2rem;border-collapse:separate;border-spacing:0;}.css-f4lqjx th,.css-f4lqjx td{text-align:left;padding-top:4px;padding-bottom:4px;padding-right:4px;padding-left:0;border-color:var(--theme-ui-colors-muted,#e2e8f0);border-bottom-style:solid;}&lt;/style&gt;&lt;table class=&quot;css-f4lqjx&quot;&gt;&lt;thead&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;18ma8h6&quot;&gt;.css-18ma8h6{vertical-align:bottom;border-bottom-width:2px;color:var(--theme-ui-colors-heading,#000);}&lt;/style&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;英文单词&lt;/th&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;文章编号&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;15msde0&quot;&gt;.css-15msde0{vertical-align:top;border-bottom-width:1px;}&lt;/style&gt;&lt;td class=&quot;css-15msde0&quot;&gt;a&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;and&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;1&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;be&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;1&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;book&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;1, 2&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;but&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;1&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;few&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;1&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;friend&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;1, 2&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;good&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;1, 2&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;is&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;2&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;should&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;1&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;索引项：次关键码（英文单词）、记录号表（文章编号）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;记录号表储存具有相同次关键字的所有记录的记录号（指针或主记录号）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;由于不是通过记录找属性，而是通过属性找记录，所以叫倒排索引&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有时还可以压缩属性（Android =&amp;gt; &amp;lt; 3, roid&amp;gt; 或 /\w+roid/）&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;二叉排序树&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Binary Sort Tree&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;或者是一颗空树，或者是具有以下性质的二叉树&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;若左子树不为空，则左子树上的值均小于根节点的值&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;若右子树不为空，则右子树上的值均大于根节点的值&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;左右子树均为二叉树&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:55.41666666666667%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABY0lEQVQoz3WTV4/CQAyE9///LcQTLxEiEHrvNfQi8OkbyWgvp7O0irM7O/ZMnPD5fCxexOFwsF6vZx6+77m/T6dTWywWv/ZDEXQ8HgXabDZar9frDxGx2+1svV4Ls91uv/sh7oBnp9Ox0+mk91qt9gXHhNfrVWfgOK9UKiJnPzhov99btVpVfrvdrNlsKgfYbre/HSCz1WrZ4/GwwWAg3OVysTRNlYdY5mg0koTz+Wz3+11FlsulLhCcrVYryQVLnue5/B4Oh+IRIRtubrfb1UUCEOTE8/m0LMvU/fv9tnq9rmIUbTQauoMFYT6f22QysdlspickFMCPOPr9vjCckyMdmXiIGjolD1SGFAmA8YWqxQ/BJTqjEwqOx2MVRSZ4lggB4wWSWZC65OJ8+ri4EsggQTo5XocYTAd0yAWXHI+UFy+VSlYul+Wj+w8Z/ob/OimSec4YJUmiEWNmsYqPgWT+sB8i2EehS3vZMwAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;deleteBST&quot; title=&quot;deleteBST&quot; src=&quot;/static/62b60c214e282acd3def8cd9ca6cc1a9/7d769/deleteBST.png&quot; srcSet=&quot;/static/62b60c214e282acd3def8cd9ca6cc1a9/5243c/deleteBST.png 240w,/static/62b60c214e282acd3def8cd9ca6cc1a9/ab158/deleteBST.png 480w,/static/62b60c214e282acd3def8cd9ca6cc1a9/7d769/deleteBST.png 960w,/static/62b60c214e282acd3def8cd9ca6cc1a9/78687/deleteBST.png 1212w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度与深度有关：O(h)&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;平衡二叉树&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;AVL 树&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当二叉排序树比较平横时，h == logn / 1 + 1 时间复杂度为 O(logn)；当二叉排序树退化成当单链表 h == n，时间复杂度为 O(n)&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;// TODO&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;B 树&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;// TODO&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;哈希表&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;存储位置 = f(关键字)&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在存储位置与关键字之间建立一个确定的对应关系 f，使每一个关键字对应一个存储位置&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;散列函数：f，也称哈希（hash）函数&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;散列表（哈希表）：存记录的存储空间&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;冲突：key1 != key2，但是 hash(key1) == hash(key2)&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;同义词：冲突中的 key1、key2&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;hash 函数的构造方法&lt;/h4&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;计算简单&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;地址分布均匀&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;直接定址法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;hash(key) = a * key + b&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;简单、均匀、无冲突，但需要知道关键字的分不情况，适合查找表较小且连续的情况&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;数字分析法&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;平方取中法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;去平方抽取中间几位数&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;折叠法&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;除留余数法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;散列表长 m &lt;code class=&quot;css-0&quot;&gt;hash(key) == key % p (p &amp;lt;= m)&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;随机数法&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;处理冲突的方法&lt;/h4&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;开放定址法&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;线性探测法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;fi(key) = (fi(key) + di) % p (di = 1, 2, ..., p - 1)&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;堆积：不是同义词却需要争夺一个地址的情况&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;二次探测法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;fi(key) = (fi(key) + di) % p (di = 1 ^ 2, - (1 ^ 2), ..., q ^ 2, - (q ^ 2)) (q &amp;lt;= m / 2)&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;双向寻找可能的位置，防止关键字都聚集在某一片区域&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;随机探测法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;fi(key) = (fi(key) + di) % p (di = 伪随机数列)&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;查找时通过随机数种子找到&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;再散列函数法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;fi(key) = rfi(key) (i = 1, 2, ...)&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;事先准备多个 f&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;链地址法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:596px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:163.33333333333334%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAYAAADZPosTAAAACXBIWXMAABYlAAAWJQFJUiTwAAADKklEQVRIx5WW6VIqQQyFef9n4QWsUpbiB8gisoqiiOyrgAsuCLn3C5WpZpyBe7uqHenpPjnJSdITkb9jt9vp9I/tditBI2w/I+K+GI1G0u/3ZTgcynK59A6v12v5/PyUl5cXfboGPz4+dO319VU2m41EePH+/i6NRkMGg4FueHx8lFKppL8TiYTE43GJRqNyc3MjxWJRnp+fpd1uSyqVklwuJ5eXl3p+PB7vAb+/v2W1Wkmv19PNALVaLbV8f3+vIBy6vb1VUJjizfX1tf5m3t3dyWw22wP+/Pwo/U6nI9PpVC3hOgMDzWZTJ4cwaoO9MLO5WCz2gLg5mUx0A+AwrFarevj8/Fyy2ayyhDVMiXGtVtNwEJqrqyvpdrvK+kAUDgAGU2OIIABgjHXcsgEjYslenoTCY8hmWHIYl92D/5U2/EFu0LEEGMDMY8NA/dMThQlt4oDrTNb4TXxIpaenJ3XdD+j+jlicbDOLFnTAYrGYFAoFubi4kIeHBwW2Cgpy+0AUDuC2uW7xxRhGSB1bD4ujJ4rJTpITP8BRkZQol8taLYSEVHIZ+kG9SqF2AZ3P5xo/kpjqIR9JWkoMI+xx4xbIEIsIQOoACEPYMgCltCg7XMb1ky4jCu4gCuBWKbBBDKqBJ+vMr68vJRDE8lelwM5amGvMqsESPsztg7RBQVhx2H8wLLkDXaZNAYA7xI75r6UXyJBFYmdxdJsDqQN7SxmX+VGGuGqVAhiq8jw7O1NBaGNWfmGChFYKDK0iuCtgRzh476/lUIa4g7JUDU/Y0IHq9bqmUDqdVlAMnUxsA7TSA5AUIn40Bro1TcLS52RzsBeAAGzi2MBtUgsDeHCyH769vWm7ouwsdTgcFqdj678YojZKuh3bVKXkwr4wCJUXQzZS+ADhmlUMm+g61HImk9H/CQf7uV6tCxFjMoOO5fXDSqWiIHxFoDAdhjgCxIFkMumBExryFOW5YhGOs3rR+11GYbeWucAwwLSvAxt4AAFEgx2h8UQh1yyZ3UohXfL5vLqGWIjGwaPXKBtw275tADJRMAJzq2dbD00b1xIJTrowcTXoDg5rXfb+Dy+R0FQhAci2AAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;chain-address&quot; title=&quot;chain-address&quot; src=&quot;/static/17d226e6999e4656f75de113e4372ef8/8ab7a/chain-address.png&quot; srcSet=&quot;/static/17d226e6999e4656f75de113e4372ef8/5243c/chain-address.png 240w,/static/17d226e6999e4656f75de113e4372ef8/ab158/chain-address.png 480w,/static/17d226e6999e4656f75de113e4372ef8/8ab7a/chain-address.png 596w&quot; sizes=&quot;(max-width: 596px) 100vw, 596px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;公共益处区法&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果没有冲突，时间复杂度：O(1)&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;排序&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;稳定性：k1 == k2，若排序之前 k1 在 k2 之前，排序后顺序不变则稳定，顺序改变则不稳定&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;内排序：整个过程中，待排序的所有记录放在内存中（插入排序、交换排序、选择排序、归并排序）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;外排序：由于个数太多，不能全放内存，整个过程需要内外多次交换数据&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:720px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:60.83333333333334%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAAB1bFcYGI//8QAGRAAAgMBAAAAAAAAAAAAAAAAABEBAhAx/9oACAEBAAEFAqpKBQU5n//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/ASf/xAAWEAADAAAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8CIv8A/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAFhEDH/2gAIAQEAAT8hXoiAgtUf/9oADAMBAAIAAwAAABCDL//EABcRAQADAAAAAAAAAAAAAAAAAAABETH/2gAIAQMBAT8QnVv/xAAXEQADAQAAAAAAAAAAAAAAAAAAAREh/9oACAECAQE/EEwiP//EAB0QAQABAwUAAAAAAAAAAAAAAAEAITFhEUFxgeH/2gAIAQEAAT8Qc0V1dpjOsQ8qXOWNLSsrP//Z&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;sort&quot; title=&quot;sort&quot; src=&quot;/static/1b1167c5dbd35f29ba24264887494162/554bf/sort.jpg&quot; srcSet=&quot;/static/1b1167c5dbd35f29ba24264887494162/46946/sort.jpg 240w,/static/1b1167c5dbd35f29ba24264887494162/55489/sort.jpg 480w,/static/1b1167c5dbd35f29ba24264887494162/554bf/sort.jpg 720w&quot; sizes=&quot;(max-width: 720px) 100vw, 720px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;冒泡排序&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;相邻的两两比较，反序则交换&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;最优：已经排好，O(n)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;最差：逆序，(n - 1) + (n - 2) + ... + 1 = n * (n - 1) / 2 = O(n ^ 2)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;平均：O(n ^ 2)&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;简单选择排序&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;找到第 i 小的，放到位置 i 上&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：无论最好和最坏都需要比较 (n - 1) + (n - 2) + ... + 1 = n * (n - 1) / 2 = O(n ^ 2)&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;直接插入排序&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;将元素插入到已排好的有序序列中&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;最优：顺序，只比较一遍，没有移动，O(n)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;最差：逆序，O(n ^ 2)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;平均：O(n ^ 2)&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;希尔排序&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;直接插入排序的升级，都属于插入排序类&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;基本有序：小的基本在前面，大的基本在后面，不等于局部有序&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过一个增量，对相隔一个增量的元素组成的子序列进行简单选择排序，得到基本有序，通过逐渐减小增量得到全部有序&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;跳跃式的移动，不稳定&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：O(n * log n)&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;堆排序&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;简单选择排序的升级，都属于选择排序类&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;堆：完全二叉树，每个节点的值都大于或等于其左右孩子节点的值是大顶堆，每个节点的值都小于或等于其左右孩子节点的值是小顶堆&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;根据完全二叉树的性质得到：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;1 &amp;lt;= i &amp;lt;= (n / 2)&lt;/code&gt;&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;大顶堆：&lt;code class=&quot;css-0&quot;&gt;t[i] &amp;gt;= t[2i] &amp;amp;&amp;amp; t[i] &amp;gt;= t[2i + 1]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;小顶堆：&lt;code class=&quot;css-0&quot;&gt;t[i] &amp;lt;= t[2i] &amp;amp;&amp;amp; t[i] &amp;lt;= t[2i + 1]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;将待排序的序列构成一个大顶堆，之后将根与末尾节点交换，通过调整重新构造成大顶堆，重复后得到有序序列&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:632px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:61.24999999999999%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABdElEQVQoz3WSycrCUAyF+7zufBQXvoYLQaEb3YsITlCH2mrFsbUVZ6uenxNIaf1r4HKn3JwvuTE+nw/yBk3n5/MJtff7jfv9ntx/+xrIMXXkY9rpdEKpVEK5XEYQBLAsC4fDITeo8YsqbVEUoVgsolAoYD6fy9lqtUrWGcJ0IF1vNhtcLhdcr1es12uh2u/32O12OB6PEmw2myEMQzwej6QkGcK0ynK5RKPRQKfTwe12+0ccxzF6vR5qtZrMw+EQ5/M5W8N0qiTp9/uYTCaZlLSmmkWr1cJoNJK9EmdSnk6n8DwPi8VCKMbjsZwxZd6/Xi95yAzoQwGKOo4D27ZFxEjTkapSqcB1XdkzECmazaYI0LrdLqrVqgjRSFWv16VEyafooBJbQn+PRCTm0HQZgMH4Odqj9Fcfw/d9IRsMBvKTtHa7LSS6z6vzrxYzqMC0TNMUde0xpkGRvObN25NO2kYblzRaJ/bWdruVXvwm+Q6Yvuf8B4BFkwrNREVfAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;build-heap&quot; title=&quot;build-heap&quot; src=&quot;/static/5d15e9fd62c35f6a759d7febd93e3e46/7818d/build-heap.png&quot; srcSet=&quot;/static/5d15e9fd62c35f6a759d7febd93e3e46/5243c/build-heap.png 240w,/static/5d15e9fd62c35f6a759d7febd93e3e46/ab158/build-heap.png 480w,/static/5d15e9fd62c35f6a759d7febd93e3e46/7818d/build-heap.png 632w&quot; sizes=&quot;(max-width: 632px) 100vw, 632px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:862px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:60.416666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABhUlEQVQoz3WTZ6oCUQyFZ7fuxcW4AVEUwR+CDQsoYu+9Fyx57ztyBx01kLmTTO5JTpLx7F8ej8dXvd/vfLbdbmej0ciu16ts/L/ueDyCEvSNx2OLx+PW6/U+4pw6+QB0NiDD4dBms5mt12vb7/e23W6t3+9bq9XS+6u4qr1fmQBLp9OiG0yYSqWsUqnIPh6PAt9sNkr8BohQSbPZVIWTycRqtZqtVis/SafTscViobNarSqOOyh+L9izy+Vi0WhU1BAqyefzeodqMpkUvcPhYLFYzOr1uu6cz+dnhQ6MCZJtMBgoE5VNp1NRQl0M9Nz0ASAGH4C0xwckKJvNWiaTkQ3tRCJhp9PJ/x6crlup+XyutiyXyyeg26/b7fYGAK1va/Uq3AUIVqoQOqVSSVloNJmggM0JJYKxOVGWnDgmS4u63a4/PM9RyeVyFgqFLBKJWKPR0DBIhDLNQqEgHxc50WKxqKGUy2W1hzb5gICEw2FNkfXgr2i328rOdFF82E7xuVgS4fsDnIyNrNZ5NBwAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;heap&quot; title=&quot;heap&quot; src=&quot;/static/c9de657c15aa5d6cf7c11f2d036e4e9c/3fb4e/heap.png&quot; srcSet=&quot;/static/c9de657c15aa5d6cf7c11f2d036e4e9c/5243c/heap.png 240w,/static/c9de657c15aa5d6cf7c11f2d036e4e9c/ab158/heap.png 480w,/static/c9de657c15aa5d6cf7c11f2d036e4e9c/3fb4e/heap.png 862w&quot; sizes=&quot;(max-width: 862px) 100vw, 862px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:742px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:61.66666666666666%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABdUlEQVQoz31TyarCQBCcb83X+AlevCh48OhNUEEPAdGDG6K4oFGUuKAm4q71qIYZYhxfwdDMZNLV1V2jEMH7/TZRL+L1euH5fMqK3o3fY1TxC7aE1+sVvV4P7XYby+USu93OWgShEIP+EMX5fEar1UKj0UC328VqtcJiscDj8fhKqmylHw4HHI9HXC4XbLdb+L6PMAwRBIHE/X6PTqeD0Whk2mAqjPeKWK/XKJfLqNVqktCGer0Ox3GQTCbNv1891KCUZrOJ8XgMW48JEiUSCeTz+Q+ijwpnsxn6/b7IJRiHwyE8zzPS5vO5nJ1OJ9mzLSTmOauUhFoqJ5nJZEQOwZ4Vi0XkcjlDMhgMkE6nZUg6YaVSQaFQkKo/pkxWWiPat8lkIkT3+132HAqTbTYb04rpdCpEt9sNih6jHTgAXQWlu64rU/zPUjaLKcqtVqtIpVLCRNBj2WwWpVLpp+n1VONLaal8AVoWL9O89KPtNTBySLaX9QcMYZRgNQsKwwAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;sort-heap&quot; title=&quot;sort-heap&quot; src=&quot;/static/3404dcda11a0bd5d694374198e6277ca/14945/sort-heap.png&quot; srcSet=&quot;/static/3404dcda11a0bd5d694374198e6277ca/5243c/sort-heap.png 240w,/static/3404dcda11a0bd5d694374198e6277ca/ab158/sort-heap.png 480w,/static/3404dcda11a0bd5d694374198e6277ca/14945/sort-heap.png 742w&quot; sizes=&quot;(max-width: 742px) 100vw, 742px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;跳跃式的排序，不稳定&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：构建堆 O(n)，排序要排 n - 1 次，第 i 次 O(log i)，所以排序一共 O(n log n)，总共 O(n log n + n) == O(n log n)&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;归并排序&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:75.41666666666667%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAABz0lEQVQ4y1WTB47DMAwE/f+/BUF67704vTceZoHNOQJkSqZFDld08vl8gsnY7/exXq/jfr/H8XiM0+kU5/M5LpeL9qyv16ves/dZn8cmXtgeDofo9/vRaDSiWq1Gu93WZF2pVKJcLken05H/+XyGh2MkXpCZYFB2u10Fwe52O5GZajabRavVil6vp285c7vd/gmz5RIEOgI1m80YDAYqPzvY44e2VquJlkQ/JUOwWCzkxOKACAo0NQFVrFYrEULOnm/G47FIVTKP6XT61axer8vxfr+/ukHP2G63+o531o8qcrmcKlNAcMm4XC71YjKZiIKJXviHw2G8Xi8dhgTq0WikoEiDtaYJ6GSFkjGfz7UmAcGRg48fj4c0poXwWV90pBrLk7hN0I5hMlt0wu/LYM9BqEkCDJqzV0ALCxllQQU1ekFqi48Em81GhExKJQnUJEWexLpRDlqS0YMLKpVKCsLgQKFQ0ITOZ/P5vM5SuvoQJyRkowX8q2XJ/YshDe+pAh9rEiLJN2C2sfkAfP8p7kEPyoQGPxfCLROQOD8BoYDUmlIu/QYxZWFpFfdrsVgUbZqm0hOrtsn+2CbgEhyAYFjaBMt7JnTIRAUE489i/gGGU2ujFUW8jAAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;merging-sort&quot; title=&quot;merging-sort&quot; src=&quot;/static/6edefd460f9295bf365e95d3fb50614f/7d769/merging-sort.png&quot; srcSet=&quot;/static/6edefd460f9295bf365e95d3fb50614f/5243c/merging-sort.png 240w,/static/6edefd460f9295bf365e95d3fb50614f/ab158/merging-sort.png 480w,/static/6edefd460f9295bf365e95d3fb50614f/7d769/merging-sort.png 960w,/static/6edefd460f9295bf365e95d3fb50614f/2dbf9/merging-sort.png 1302w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;是稳定的排序&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;时间复杂度：sortAndMerge 需要 O(n)，slice 需要 O(log n)，所以总共 O(n log n)&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;快速排序&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;冒泡排序的升级，都属于交换排序类&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过一趟排序将待排元素分割成独立的两部分，其中一部分均比另一部分小，则可继续对这两部分进行排序，以达到整个序列有序&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;partition：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:24.166666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAwklEQVQY041Q2QqEQAzz/79P8L5FRUXxVjyyJKywj1soTTvpkTG2bYPv++i6Dn3fY993sDZNk+KLl2WRj+OIdV3FI+b7MAy47xs047ouzPOMPM8RRRFs20YYhgiCQNjzPDiOgziOVSN+a67r6hjyuFQD8TVe1zQNLMtSMxekaYosyxTLskRRFEiSRDmXMzI3TVMXayAbSGRDXdciHseB53nklPIbf/2VyeVURbUGB1VVpf/gX7RtK/I/9vIol6rO88QH9pZ7YFKxIYYAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;qs1&quot; title=&quot;qs1&quot; src=&quot;/static/eefc16f53e16369e23489ee4955a5fba/7d769/qs1.png&quot; srcSet=&quot;/static/eefc16f53e16369e23489ee4955a5fba/5243c/qs1.png 240w,/static/eefc16f53e16369e23489ee4955a5fba/ab158/qs1.png 480w,/static/eefc16f53e16369e23489ee4955a5fba/7d769/qs1.png 960w,/static/eefc16f53e16369e23489ee4955a5fba/c0d05/qs1.png 1166w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:22.916666666666668%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA30lEQVQY031QyYqEUAz0///LgyCKG9puuLViu+8e1BrqMTRzmkCol9SrhIq07zs8z0PXdWjbFud5Yts2TNMkcF1XHMch6nmevxz/EauqEtr3+41lWSDd9y1INoIggG3beL1eSJIEruvCMAz4vi/e5MlZlgXHcaBpGlRVhWmakGUZWZZBwm+M44iyLL/iuq6RpiniOBbIBUVRCIyiCGEYisF0x1pRFKGRPp8PmE3TCMu0wJpxXRee5wFd/E32mDwB7fIsHEx3EjcxOb3ve2Gdd2VQ9F9wITXDMCDPc+i6jh+qlXVvQrNBcwAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;qs2&quot; title=&quot;qs2&quot; src=&quot;/static/66b89faa548ca09edeb235abdf1d712d/7d769/qs2.png&quot; srcSet=&quot;/static/66b89faa548ca09edeb235abdf1d712d/5243c/qs2.png 240w,/static/66b89faa548ca09edeb235abdf1d712d/ab158/qs2.png 480w,/static/66b89faa548ca09edeb235abdf1d712d/7d769/qs2.png 960w,/static/66b89faa548ca09edeb235abdf1d712d/28203/qs2.png 1094w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:22.499999999999996%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAx0lEQVQY041QR46EQBDj/98DkXNGHGDIggGvbC17XktWd9kVusv4fr8IwxDjOKLve8zzjH3fsSyL7tSP48Dn81E8TZM05qzrqpjetm06jed5cF0XmqaBZVl/9DwPrutqGGmaJuI4RhAEsG1bHnNejzE9A7/gi4qiQJIkYp7nqKpKBWmaSqvrGmVZSouiSAPosZHjONKMruvQtq04DIOa3/cNvpxfYKPzPBVzPfRevhrBr6thlmWawukUCSYS3ClX8R+wxvd9/AB173hyEg1jLQAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;qs3&quot; title=&quot;qs3&quot; src=&quot;/static/bcd362f946d521c07d631653642f7cd3/7d769/qs3.png&quot; srcSet=&quot;/static/bcd362f946d521c07d631653642f7cd3/5243c/qs3.png 240w,/static/bcd362f946d521c07d631653642f7cd3/ab158/qs3.png 480w,/static/bcd362f946d521c07d631653642f7cd3/7d769/qs3.png 960w,/static/bcd362f946d521c07d631653642f7cd3/c1ff3/qs3.png 1168w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:24.583333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAxUlEQVQY001QhwqEUAzz/z9QxL0H4t6K5i4BjwuEPvrapo2BL67rguM4qOsabdti2zbs+45xHLGuq+I0TZjnWRyGQfllWX75vu9xHAeM53lAckie5/A8D7ZtK5Ku6yoGQaA3SXHSNE3Vvu+yLGHgD1RJkkQFvu8jjmMNYHGapgjDUP+WZf0EXlH2aCDX7LpObJpG53Hj+75lRVEUqKoKrzUErcmyTOcSrCXZZ9CzV4Fb8PQXHBBFkfwi2ECc56kLaNF/nvgAMNJ5hpCApaIAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;qs4&quot; title=&quot;qs4&quot; src=&quot;/static/628a2c9ba6d7500b366ce84a0f3c90b5/7d769/qs4.png&quot; srcSet=&quot;/static/628a2c9ba6d7500b366ce84a0f3c90b5/5243c/qs4.png 240w,/static/628a2c9ba6d7500b366ce84a0f3c90b5/ab158/qs4.png 480w,/static/628a2c9ba6d7500b366ce84a0f3c90b5/7d769/qs4.png 960w,/static/628a2c9ba6d7500b366ce84a0f3c90b5/463a7/qs4.png 1170w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:24.166666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA00lEQVQY0z2QiaqFMBBD+//fJqgoiru4ICruG4iaR4bXOxCaacvppOp5HoRhiL7vMY4jjuPAdV1YlkXWdV1lj+u2bdj3XTxV1zXyPEfTNCjLUvbU+744zxNt2yKOY1GWZUiSRC4HQYA0TX9n9BzA931YlgXTNOE4DgzDQNd1UPgv0gmKokhA9BSB7IuiEM+H9B32rusK0LZtGUox5jRNIkJZ3/f9pItxCWVkxhuGAUzHnt81z7MwFF9hBEbhv2mgLu35elVV0tN7nidAikNxmPu+8Qcp5XXz/QDIngAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;qs5&quot; title=&quot;qs5&quot; src=&quot;/static/21ae25ff71b0e875966a52725ad1a5a9/7d769/qs5.png&quot; srcSet=&quot;/static/21ae25ff71b0e875966a52725ad1a5a9/5243c/qs5.png 240w,/static/21ae25ff71b0e875966a52725ad1a5a9/ab158/qs5.png 480w,/static/21ae25ff71b0e875966a52725ad1a5a9/7d769/qs5.png 960w,/static/21ae25ff71b0e875966a52725ad1a5a9/1dbc1/qs5.png 1134w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:24.166666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAvElEQVQY011PyQqFMBDr//+dKO5bVby5byBqJMMbDy8QJtOk7YxZlgVBEKDve+F5nti2DeM4Sl3XFfu+Y55noWpWesMwyJ2u60CY67pwHAeqqoLv+4jjGEVRoK5rWGuRJIn01GRZlnKmfZqmX44fGfzQti08zxPS5IMMs8+yTD50HEfO8jyXjPrUURTJlIYjT9P0rUjc943neaQS1NzCdV2Zhlp9Vm6pvQnDECRX0QdpKlQ3TSNklhP+5xQvJjJ4hx4Dd0kAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;qs6&quot; title=&quot;qs6&quot; src=&quot;/static/5815b81a8c28b99ebc6a5387705b1e5a/7d769/qs6.png&quot; srcSet=&quot;/static/5815b81a8c28b99ebc6a5387705b1e5a/5243c/qs6.png 240w,/static/5815b81a8c28b99ebc6a5387705b1e5a/ab158/qs6.png 480w,/static/5815b81a8c28b99ebc6a5387705b1e5a/7d769/qs6.png 960w,/static/5815b81a8c28b99ebc6a5387705b1e5a/1dbc1/qs6.png 1134w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优化：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优化选取的 pivot：由于 pivot 可以随便选，如果每次都选的最大的数，就会退化成冒泡排序，所以选中等的数最优（通过抽取三个数，选中间的数作为 pivot）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优化交换：使用替代只用一次赋值操作，而交换用三次&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优化小数组时的排序方案：使用了递归，在处理大量数据时可以忽略，但少量数据时会有浪费，在少量数据时（7、50、10，v8 的 Array.prototype.sort 是 10）使用直接插入排序（简单排序中性能最好）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优化递归：迭代减少堆栈深度，将 &lt;code class=&quot;css-0&quot;&gt;if&lt;/code&gt; 改为 &lt;code class=&quot;css-0&quot;&gt;while&lt;/code&gt; 后，因为第一次使用递归后，left 就没用了，所以将 &lt;code class=&quot;css-0&quot;&gt;pivot + 1&lt;/code&gt; 赋值给 &lt;code class=&quot;css-0&quot;&gt;left&lt;/code&gt;，再循环后，下一次 &lt;code class=&quot;css-0&quot;&gt;partition(arr, left, right)&lt;/code&gt; 效果等于 &lt;code class=&quot;css-0&quot;&gt;quickSort(arr, pivot + 1, right)&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[读《MySQL 必知必会》]]></title><link>https://ahabhgk.github.io/读《-my-sql-必知必会》</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-my-sql-必知必会》</guid><pubDate>Sat, 04 Jan 2020 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;主键：一列（或一组列），其值能够唯一区分表中每个行&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;任意两行都不具有相同的主键值&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;每一行都必须具有一个主键（不为 NULL）&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;习惯：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;不更新主键列中的值&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;不重用主键列中的值&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;不在主键列中使用可能会更改的值&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;外键：外键为某个表中的一列，它包含另一个表的主键值，定义了两个表之间的关系&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;信息不重复，从而不浪费时间和空间&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果信息变动，可以只更新表中的单个记录，相关表中的数据不用改动&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;由于数据无重复，显然数据是一致的，这使得处理数据更简单&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;假如你发现某物品(其ID为DTNTR)存在问题，因此想知道生产该物品的供应商生产的其他物品是否也存在这些问题。此查询要求首先找到 生产ID为DTNTR的物品的供应商，然后找出这个供应商生产的其他物品。 下面是解决此问题的一种方法:&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;join&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:600px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:78.75000000000001%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAADHElEQVQozz2SS0vjUBTHD74W8wmEwY0fQFDEhYKbghtRdCsiokv34mJQB8GFO10ICuoH0NF5+JyKjtJp7cPaxmrfam3TWqlJk94maW+SO8dmZkISknvP/55zfucPOmOvwWAhmZQ1TSmXGWOqqgaDQa/XK0mS3+93u90cx8ViMdyilJbKZZmQV45TZRluZ2ftALsfPqSOjwmlCsEX9Xg8drud53mn03l9fR0KhcLhsGmagiAQWbb39e0DXPX2wn5j49f6+jOA88FBidKiILB/F0bj8/eDsZIkVRgL7+ycAuzV1x82NIBraOgEfwDia2sKY3KxaEXrlGqVimGaiqJY4oqmyVhzOv2zpeUbJmtuBvL2djk351hdTaZSoiCYhoFx1UpFVpSXSMS7vExUtVg7Ea+iKIYTCc/BgXN6OutwgGEY0WIxkc/HIhFMYgXJokgYC87MHAMkLy4UXSelEq6XFcXv80UfHtKaRhkD+fnZOzXl39rKFgqyhF1TS4zHhObnUZxyucqUlgl5X5ek10Ih7PW6xsdT29vwq6sLI7IeT5EQbBi3rZFIhGSiUf/m5v+ycYQlWcYASVGcw8NHALDf1HT08WPVNLPZLAbhloUnn887nM5QLBaNRKxyCCHYVy6TwR//p08/UBxdXbU3NFyvrIiaJr69KbXyELemqjmez6XTkihaIJAOEkWHxDnO3trqGRgA1TBufL5btzuVSuEwMCk1TSSu1/L/HRvehmHWaAcCgejdXSYep4YBiJG7vQ3d3z89Pmq6HllcdNhsZyMjVzZb9vwcXXEzMXE1OelbWvLabAmHI3h/fxcKPaWRtwa6rmOriEplLLm3dwjwva7upK5uB+Cyo4NbWNgFSKyvSzyPRnJ0d4vITVEwZbVaBauZiopa9rS7e1wTn1ritrbg589f0HwbG3I+j67C0fCCgBSsyb2LX15eAjc3aJJMLueamjprb7f39//u7MwcHlax7NFR19iYZ3HR3dOTuLzkwmEuEEgmk4VC4V1cKpVyuRyfyYg1b2g1NjgPqutoKdRb/HARq8WG4/E40sWe/wC1yvv5q+5GHgAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;join&quot; title=&quot;join&quot; src=&quot;/static/26356b400ca9075ac90491edd6623eae/ff59c/join.png&quot; srcSet=&quot;/static/26356b400ca9075ac90491edd6623eae/5243c/join.png 240w,/static/26356b400ca9075ac90491edd6623eae/ab158/join.png 480w,/static/26356b400ca9075ac90491edd6623eae/ff59c/join.png 600w&quot; sizes=&quot;(max-width: 600px) 100vw, 600px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;组合查询&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;插入&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;更新删除&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;创建&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;更新表&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;删除表&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;重命名&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;视图&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;重用SQL语句。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;简化复杂的SQL操作。在编写查询后，可以方便地重用它而不必知道它的基本查询细节。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用表的组成部分而不是整个表。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;保护数据。可以给用户授予表的特定部分的访问权限而不是整个表的访问权限。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;更改数据格式和表示。视图可返回与底层表的表示和格式不同的数据。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;因为视图不包含数据，所以每次使用视图时，都 必须处理查询执行时所需的任一个检索。如果你用多个联结 和过滤创建了复杂的视图或者嵌套了视图，可能会发现性能 下降得很厉害&lt;/p&gt;&lt;/blockquote&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;ORDER BY可以用在视图中，但如果从该视图检索数据SELECT中也含有ORDER BY，那么该视图中的ORDER BY将被覆盖。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;视图不能索引，也不能有关联的触发器或默认值。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;视图可以和表一起使用。例如，编写一条联结表和视图的SELECT语句。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一般，应该将视图用于检索(SELECT语句) 而不用于更新(INSERT、UPDATE和DELETE)。&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;存储过程&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;简单安全高性能&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;游标&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;MySQL 中只能用于存储过程和函数&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;触发器&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;DELETE、INSERT、UPDATE&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;只有表支持，视图、临时表都不支持&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;事务&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;事务(transaction)指一组SQL语句;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;回退(rollback)指撤销指定SQL语句的过程;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;提交(commit)指将未存储的SQL语句结果写入数据库表;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;保留点(savepoint)指事务处理中设置的临时占位符(place-holder)，你可以对它发布回退(与回退整个事务处理不同)。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;只能回退 UPDATE、DELETE、INSERT，不能回退 CREATE、DROP、SELECT&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一般使用隐式提交，事务中只能使用 COMMIT&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;安全管理&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;维护&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Redux 源码分析]]></title><link>https://ahabhgk.github.io/redux-源码分析</link><guid isPermaLink="false">https://ahabhgk.github.io/redux-源码分析</guid><pubDate>Fri, 06 Dec 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;随着前端应用逐渐变大，状态也越来越复杂，需要一种状态管理的方案，Redux 就是其中一种&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;总结起来 React 状态管理方案就分为两类：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;外部 Model，通过事件修改状态，组件通过监听订阅状态（通过 Context 连接 React）&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Redux&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Mobx&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;EventBus&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;hox&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过 React Context 提升状态（包括修改状态的方法），在组件中拿到并使用 Context&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;unstated&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;unstated-next&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;reunx&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用外部 Model 的模式由于不依赖于 React，所以不仅适用于 React，在各个框架甚至原生应用中都可以使用；而第二种依赖于 React Context 仅适用于 React 应用，但是十分轻量&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;MVC（backbone.js...）由于当应用变得很大时，会有多个 View 和多个 Model，（双向的）数据流就会变的非常混乱&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:59.583333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABUElEQVQoz42TiaqDQAxF/f+/E6S2UgVtXVrr0sWKuKScQErh4cOBEJ2Z3NybZBxZWcuyqLG6rpO6rqVtW7ler+qxsizlfr9LVVXyer30rrMG9uufz+cXKEkSOZ1OcrvdFJBkAHKmgMZkzVgEBEEgl8tFiqKQMAwljmP1JMjzXO8Mw/CXoYHYer/f0jSNsknTVIOjKFKJAJKARDB+PB7izPMs4zjKNE1qLDzAXLA6AUYdAT8ej2p93+u+ScYcgqgPRjAMzufzlw31gg3fsMEjd7/f6xneYmHpcJmsloEic8CeBSPbpBGcZZnue54nh8NBGcIer00xucg3yXzTXTKjAtYEAExiFOx2O20WBDCVvKUpNiIm23VdTQBTGMMchhDYNDYAIg1Agn3f13HBkP7v2KwNNkBIYlRoBv/Itpp/B3vL06Nxv0+PhsEIZtT39+l9ACWZlf5832zfAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;MVC-bad&quot; title=&quot;MVC-bad&quot; src=&quot;/static/ba26e43f5475d375e6a120ece62ccb81/7d769/MVC-bad.png&quot; srcSet=&quot;/static/ba26e43f5475d375e6a120ece62ccb81/5243c/MVC-bad.png 240w,/static/ba26e43f5475d375e6a120ece62ccb81/ab158/MVC-bad.png 480w,/static/ba26e43f5475d375e6a120ece62ccb81/7d769/MVC-bad.png 960w,/static/ba26e43f5475d375e6a120ece62ccb81/87339/MVC-bad.png 1440w,/static/ba26e43f5475d375e6a120ece62ccb81/2accf/MVC-bad.png 1454w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;所以出现了 Flux，以单向数据流管理状态，React 推崇的核心也是单向数据流，Flux 中单向数据流可以看作是在其整体架构上的延伸，Redux 是也不是 Flux，它遵循了 Flux 的单向数据流的理念，同时简化了 Flux&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:949px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:55.833333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHYVkgQxf/EABkQAQEBAAMAAAAAAAAAAAAAAAECERIhIv/aAAgBAQABBQJr031Ds8TaCiQk/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8BJ//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/ASf/xAAZEAACAwEAAAAAAAAAAAAAAAAAEQEhMUL/2gAIAQEABj8CTgnk1jLKP//EABsQAQADAQADAAAAAAAAAAAAAAEAESExQVFx/9oACAEBAAE/IUO3fNm2mGhfMAkHskXuN+ysCyUgUT//2gAMAwEAAgADAAAAEGgv/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAh/9oACAEDAQE/EAjs/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEhMf/aAAgBAgEBPxCHR6f/xAAbEAEBAAIDAQAAAAAAAAAAAAABEQAxIYGxQf/aAAgBAQABPxBICUCOmKutp4uscoaol+7yxvMbWbTgZU8zecLKvuf/2Q==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;different&quot; title=&quot;different&quot; src=&quot;/static/6cbb5b3b514b72dbf5430aaa94531c1a/353b5/different.jpg&quot; srcSet=&quot;/static/6cbb5b3b514b72dbf5430aaa94531c1a/46946/different.jpg 240w,/static/6cbb5b3b514b72dbf5430aaa94531c1a/55489/different.jpg 480w,/static/6cbb5b3b514b72dbf5430aaa94531c1a/353b5/different.jpg 949w&quot; sizes=&quot;(max-width: 949px) 100vw, 949px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Flux/Redux 这种以单向数据流管理状态更像是一种设计模式&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;👀 Redux 对比 Mobx&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Mobx 和 Redux 的目标都是管理好应用状态，但是最根本的区别在于对数据的处理方式不同。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Redux 认为，数据的一致性很重要，为了保持数据的一致性，要求Store 中的数据尽量范式化，也就是减少一切不必要的冗余，为了限制对数据的修改，要求 Store 中数据是不可改的（Immutable），只能通过 action 触发 reducer 来更新 Store。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Mobx 也认为数据的一致性很重要，但是它认为解决问题的根本方法不是让数据范式化，而是不要给机会让数据变得不一致。所以，Mobx 鼓励数据干脆就“反范式化”，有冗余没问题，只要所有数据之间保持联动，改了一处，对应依赖这处的数据自动更新，那就不会发生数据不一致的问题。&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Redux 和 Mobx 都是一个特定时期的产物，不要因为某个工具或者技术炫酷或者热门而去用它，要根据自己的工作需要去选择工具和技术&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;📜 Redux 三大原则&lt;/h2&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;单一数据源&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;状态是只读的&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;状态修改均有纯函数完成&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:890px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:99.58333333333333%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAABrklEQVQ4y52Ua6uCQBCG/f//K7/YhwhCIi2ke2kX7X6bwzMwB4+5WGdhcHH13eedmV1Pasbr9Xp7dzwe5XQ6yf1+l8fjIa7hucQOh4OkaSrb7VbyPJc4jqXb7Yrv+zKbzWS32+naZrPROd9eLhe34Hq9VioLNsiyTObzuc55sslkMtENEd7v925BPmAURaECWL1er2oboul0KsPhUEajkSwWCxUlPASqYYTszs/szLzVakkYhrqGRUSTJJHVaqXB5p4ruefzWfr9/m8RECSHg8FASXjH2vP51CcBjBKSTASwQzDnJ+hsWAqahgryMRYMnflyufwjwjsoLM+ucFqGFHGzQoXrBKt961UXb7ebtgQJH4/HSmpFsIb+ShAKxKIokk6no21haaAATafKq1uEErJer6etgBCWEYaWvsMFxXsjLIvZAjTYhY5jRh9yzOgGaxdrGadgeQEBjlUQBNq4djrqLgWn5TIhJJAhZgOLH1W5KkhAQr6wjVXo2u22Nrvremu8vmhqkm65wjbiHwtWbVBV5uQTQipvR/FfhAhi0W5qiL8irOtF6OyeM8omwR+qYBZpWOx5SwAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;redux-flow&quot; title=&quot;redux-flow&quot; src=&quot;/static/0d7919b48d430cf2b04769f0ed264dba/dcb99/redux-flow.png&quot; srcSet=&quot;/static/0d7919b48d430cf2b04769f0ed264dba/5243c/redux-flow.png 240w,/static/0d7919b48d430cf2b04769f0ed264dba/ab158/redux-flow.png 480w,/static/0d7919b48d430cf2b04769f0ed264dba/dcb99/redux-flow.png 890w&quot; sizes=&quot;(max-width: 890px) 100vw, 890px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;相比 Flux 可以看出，Redux 没有 Dispatcher，Store 是单一的，Store 通过 Reducers 纯函数获取新的 State，使得状态的修改变得简单、纯粹、可测试，并且可以追踪每次变化，实现了时间旅行&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;🗜 middleware&lt;/h2&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;It provides a third-party extension point between dispatching an action, and the moment it reaches the reducer.&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;它提供了一个分类处理 action 的机会。在 middleware 中，你可以检阅每一个流过的 action，挑选出特定类型的 action 进行相应操作，给你一次改变 action 的机会&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;3.1 Redux 为什么需要 middleware&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;middleware 大部分都是用来处理异步，因为 Redux 的 reducer 必须要是一个纯函数，不能有任何的副作用，所以 Redux 引入了 middleware，在 action 没有到 reducer 的时候就拦截 action 并进行副作用的操作&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果 reducer 不纯（我们当然可以写成不纯的），就可以在 reducer 中处理副作用，但这样不仅代码难看（async reducer() =&amp;gt; await ...），而且没有可预测性、组织性……&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;也正因为 reducer 是纯函数，我们通过 middleware 进行的异步操作和在一些大项目中对 action 的特殊需求的一些处理，才可以很好的进行组织管理&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;🐦 高阶 reducer&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;higher-order-reducer:: reducer =&amp;gt; reducer&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;高阶 reducer 就是指将 reducer 作为参数或者返回值的函数&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;combineReducers 其实就是一个高阶 reducer，因为 combineReducers 就是将一个 reducer 对象作为参数，最后返回顶层的 reducer&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;reducer 的复用：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  我们两个组件，它们的功能是相同的，都是 LOAD_DATA，我们能不能让它们共用一个 reducer？&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  不能，因为当一个组件出发 action 时，另一个组件的状态也会改变&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  所以在一个应用中，不同模块间的 actionType 必须是全局唯一的&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  我们可以用增加前缀的方法解决：&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;reducer 增强&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;  redux-undo：&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;📝 源码分析&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;5.1 createStore&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;createStore 其实就把 reducer 包了一层，根本没有 store，只是暴露出几个接口，方便操作，并用发布订阅模式实现了 state 改变时执行订阅的函数的功能，然后在一开始实现 enhancer，供 applyMiddleware 使用&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;reducer、preloadedState/initialState 都得自己写，Redux 为我们干的很少&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;5.2 combineReducers&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;combineReducers 使我们更方便的组织 state，它干的就是将所有的 reducers 执行，使相应的 reducer 更新相应的 state，最终得到总共的新的 state&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;5.3 compose&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;compose 就是典型的函数式编程中的组合函数，用于组合多个 enhancers 成一个 enhancer&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;5.4 applyMiddleware&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;applyMiddleware 可以对特定类型的 action 进行操作&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;createStore 中的 dispatch 由于有对 action 是否为 plainObject 的检测，所以只能 dispatch plainObject，而中间件可以穿入其他类型的 action（redux-thunk...）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;实现就是通过传入旧的 createStore 返回增强过的 store，从旧的 createStore 中提取出原来 dispatch，然后对原来的 dispatch 进行包裹（增强），检测特定类型的 action 并进行的一些操作，然后仍然创建一个 plainObject 的 action，使用原来的 dispatch 派发掉&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;简单的 middleware，在打印日志之前输出当前的时间戳：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对应 redux-thunk 源码：&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;ref&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;深入 react 技术栈&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzIxNjgwMDIzMA==&amp;amp;mid=2247484209&amp;amp;idx=1&amp;amp;sn=1a33a2c8cb58ae98e4f8080ab59da06f&amp;amp;chksm=9782cdb8a0f544ae4101a1a7453e8f5a320d9f338c92bf4a6ce6ae31c6228fd5887a091d7987&amp;amp;mpshare=1&amp;amp;scene=23&amp;amp;srcid=1024nQu5koC1MkPZfll5npNZ&amp;amp;sharer_sharetime=1571885623450&amp;amp;sharer_shareid=ff850364fdc08ae532955239c841ceda%23rd&quot; class=&quot;css-1od09yo&quot;&gt;完全理解 redux&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[读《前端性能优化原理与实践》- 应用]]></title><link>https://ahabhgk.github.io/读《前端性能优化原理与实践》-应用</link><guid isPermaLink="false">https://ahabhgk.github.io/读《前端性能优化原理与实践》-应用</guid><pubDate>Fri, 23 Aug 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Lazy-Load&lt;/h2&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:42.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAPoAAAD6AG1e1JrAAABGklEQVQoz01QSW4EIQzk/+/KLR/IIVKOmSRNs9tAGzrFotFIJaswtqts9fbpvn6sM8ev1oc+TqN98JxTogHiRCtuQpszJU7q/eP79EU4UySOVLlkypzw5qtc9QVXFWQW6oxKPx5SarDRHNZqF30COf+M045jToGeyCnPuRuZiur33a5Wcy1UCheQLr1LA+5299YXNpf+zKBL3f1GiiPDKpoHcsXHmDi9LV54J6UIBJo0qTKawbwNFLHk+HCngyW0YYXoYuUK7k4PzyAoQzEEUKmWAbThHoLBEMiXTBEkMX6ozVPJJbty2pnKc2eCsIsTaQoOTVwRbrFRsGG5WAXJpzCckjLaYlvU4dTeBNgDvBkRmTk0vX4tIIMR//CjCIJKsK2wAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;lazy-load&quot; title=&quot;lazy-load&quot; src=&quot;/static/cdac330bbb8a15e6c39d5008b720d730/7d769/lazy-load.png&quot; srcSet=&quot;/static/cdac330bbb8a15e6c39d5008b720d730/5243c/lazy-load.png 240w,/static/cdac330bbb8a15e6c39d5008b720d730/ab158/lazy-load.png 480w,/static/cdac330bbb8a15e6c39d5008b720d730/7d769/lazy-load.png 960w,/static/cdac330bbb8a15e6c39d5008b720d730/f3baa/lazy-load.png 1280w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;事件的节流（throttle）与防抖（debounce）&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;scroll 事件，resize 事件、鼠标事件（比如 mousemove、mouseover 等）、键盘事件（keyup、keydown 等）都存在被频繁触发的风险，频繁触发回调导致的大量计算会引发页面的抖动甚至卡顿&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;“节流”与“防抖”的本质&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这两个东西都以闭包的形式存在。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;它们通过对事件对应的回调函数进行包裹、以自由变量的形式缓存时间信息，最后用 setTimeout 来控制事件的触发频率。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;节流的中心思想在于：在某段时间内，不管你触发了多少次回调，我都只认第一次，并在计时结束时给予响应（第一次触发的 scroll 事件对应的回调才会执行，而“一段时间内”触发的后续的 scroll 回调都会被节流阀无视掉）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;防抖的中心思想在于：我会等你到底。在某段时间内，不管你触发了多少次回调，我都只认最后一次&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;性能检测工具&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/reference&quot; class=&quot;css-1od09yo&quot;&gt;Devtool Performance&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;https://developers.google.com/web/tools/lighthouse/?hl=zh-cn&quot; class=&quot;css-1od09yo&quot;&gt;Lighthouse&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/API/Performance&quot; class=&quot;css-1od09yo&quot;&gt;Performance API&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《前端性能优化原理与实践》- 渲染]]></title><link>https://ahabhgk.github.io/读《前端性能优化原理与实践》-渲染</link><guid isPermaLink="false">https://ahabhgk.github.io/读《前端性能优化原理与实践》-渲染</guid><pubDate>Thu, 22 Aug 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;SSR&lt;/h2&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;strong class=&quot;css-0&quot;&gt;本该浏览器做的事情，分担给服务器去做&lt;/strong&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;SEO&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;首屏渲染&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;服务器压力大&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在实践中，我一般会建议大家先忘记服务端渲染这个事情——服务器稀少而宝贵，但首屏渲染体验和 SEO 的优化方案却很多——我们最好先把能用的低成本“大招”都用完。除非网页对性能要求太高了，以至于所有的招式都用完了，性能表现还是不尽人意，这时候我们就可以考虑向老板多申请几台服务器，把服务端渲染搞起来了~&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;浏览器运行机制&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;浏览器内核可以分成两部分：渲染引擎（Layout Engine 或者 Rendering Engine）和 JS 引擎。早期渲染引擎和 JS 引擎并没有十分明确的区分，但随着 JS 引擎越来越独立，内核也成了渲染引擎的代称。渲染引擎又包括了 HTML 解释器、CSS 解释器、布局、网络、存储、图形、音视频、图片解码器等等零部件。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;目前市面上常见的浏览器内核可以分为这四种：Trident（IE）、Gecko（火狐）、Blink（Chrome、Opera）、Webkit（Safari）。&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;CSS 选择器优化&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;CSS 选择符是从右到左进行匹配的。我们这个看似“没毛病”的选择器，实际开销相当高：浏览器必须遍历页面上每个 li 元素，并且每次都要去确认这个 li 元素的父元素 id 是不是 myList&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;它会匹配所有元素，所以浏览器必须去遍历每一个元素&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;避免使用通配符，只对需要用到的元素进行选择。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;关注可以通过继承实现的属性，避免重复匹配重复定义。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;少用标签选择器。如果可以，用类选择器替代&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;减少嵌套。后代选择器的开销是最高的，因此我们应该尽量将选择器的深度降到最低（最高不要超过三层），尽可能使用类来关联每一个标签元素&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;CSS 渲染阻塞&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;默认情况下，CSS 是阻塞的资源。浏览器在构建 CSSOM 的过程中，不会渲染任何已处理的内容。即便 DOM 已经解析完毕了，只要 CSSOM 不 OK，那么渲染这个事情就不 OK（这主要是为了避免没有 CSS 的 HTML 页面丑陋地“裸奔”在用户眼前）。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;我们知道，只有当我们开始解析 HTML 后、解析到 link 标签或者 style 标签时，CSS 才登场，CSSOM 的构建才开始。很多时候，DOM 不得不等待 CSSOM。因此我们可以这样总结：&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;CSS 是阻塞渲染的资源。需要将它尽早、尽快地下载到客户端，以便缩短首次渲染的时间。&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;事实上，现在很多团队都已经做到了尽早（将 CSS 放在 head 标签里）和尽快（启用 CDN 实现静态资源加载速度的优化）。&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;JS 阻塞&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;JS 引擎是独立于渲染引擎存在的。我们的 JS 代码在文档的何处插入，就在何处执行。当 HTML 解析器遇到一个 script 标签时，它会暂停渲染过程，将控制权交给 JS 引擎。JS 引擎对内联的 JS 代码会直接执行，对外部 JS 文件还要先获取到脚本、再进行执行。等 JS 引擎运行完毕，浏览器又会把控制权还给渲染引擎，继续 CSSOM 和 DOM 的构建。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:689px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:16.249999999999996%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAd2EUH//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAE/IX//2gAMAwEAAgADAAAAEAgv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRAAAwADAAAAAAAAAAAAAAAAAAEhEUGx/9oACAEBAAE/EFzIrWbZ/9k=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;defer-async&quot; title=&quot;defer-async&quot; src=&quot;/static/244a0c3246f534e96ce88124e3978261/4cbe9/defer-async.jpg&quot; srcSet=&quot;/static/244a0c3246f534e96ce88124e3978261/46946/defer-async.jpg 240w,/static/244a0c3246f534e96ce88124e3978261/55489/defer-async.jpg 480w,/static/244a0c3246f534e96ce88124e3978261/4cbe9/defer-async.jpg 689w&quot; sizes=&quot;(max-width: 689px) 100vw, 689px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;DOM 优化&lt;/h2&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;把 DOM 和 JavaScript 各自想象成一个岛屿，它们之间用收费桥梁连接。——《高性能 JavaScript》&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:618px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:39.166666666666664%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABnUlEQVQoz41Rz0sCURB+b4tCWImIIA+CBOGhpC5Jh6hDh45WqBXpoZNeA2WP4kUMsW6LFwXFgyJpiKLnIEFwEX+tq3hUlED/he1zUYmgcODjvZk3830z8wiBORwO8tOGwyFjNpuVe6PRIL1ejwwGA8Wv1WpkabNYLGqv12uY3mVZJqlUina7Xer3+6nT6VwJh8OKn8lkmHkNpVQNqBYk2WxWeYxGoyYkivClSCTCI7T6n/hUEHYC3MygXzwGAoHtdDr9EYvFbt1u934ikRBCodADRt1CR/ccx+1ZrdYrl8ulabfbpslkcoAyLcMwjyzLHqlUqnP4dmBTIQSZvlgsvs0F4L/wPP8kSRIHUlkQBKlUKn1Vq1URO5Q7nU4eaQYQ3hmNxl2dTnc8I9QqBFBmc7ncez6f92J0Ozr99Pl82/1+fwefYhuNRmqMuIFzvV6vXyN+iDIWhDacZ8AlYALWSDweV3YYDAa1hULhOZlMvno8HsOS/6gBLoBTQL2IgoT5nYkuKfZFKpUKbbVapNlsElEUSblcpuPxmP4hQL8B7BW4JJYccOAAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;bridge&quot; title=&quot;bridge&quot; src=&quot;/static/9729da9c861f5962526aa49c9d81b170/e2d37/bridge.png&quot; srcSet=&quot;/static/9729da9c861f5962526aa49c9d81b170/5243c/bridge.png 240w,/static/9729da9c861f5962526aa49c9d81b170/ab158/bridge.png 480w,/static/9729da9c861f5962526aa49c9d81b170/e2d37/bridge.png 618w&quot; sizes=&quot;(max-width: 618px) 100vw, 618px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当我们修改 DOM 引发了 Render Tree 的改变，就会引发重绘甚至回流&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;重绘不一定导致回流，回流一定会导致重绘&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;减少 DOM 操作&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;最“贵”的操作：改变 DOM 元素的几何属性&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这个改变几乎可以说是“牵一发动全身”——当一个DOM元素的几何属性发生变化时，所有和它相关的节点（比如父子节点、兄弟节点等）的几何属性都需要进行重新计算，它会带来巨大的计算量。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;常见的几何属性有 width、height、padding、margin、left、top、border 等等&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;“价格适中”的操作：改变 DOM 树的结构&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这里主要指的是节点的增减、移动等操作。浏览器引擎布局的过程，顺序上可以类比于树的前序遍历——它是一个从上到下、从左到右的过程。通常在这个过程中，当前元素不会再影响其前面已经遍历过的元素。&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;最容易被忽略的操作：获取一些特定属性的值&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;offsetTop、offsetLeft、 offsetWidth、offsetHeight、scrollTop、scrollLeft、scrollWidth、scrollHeight、clientTop、clientLeft、clientWidth、clientHeight —— 这些值有一个共性，就是需要通过即时计算得到。因此浏览器为了获取这些值，也会进行回流。&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Event Loop 与异步更新策略&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;img src=&quot;./event-loop&quot; alt=&quot;event-loop&quot; class=&quot;css-0&quot;/&gt;&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;渲染的时机&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;假如我想要在异步任务里进行DOM更新，我该把它包装成 micro 还是 macro 呢？&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;现在 task 被推入的 macro 队列。但因为 script 脚本本身是一个 macro 任务，所以本次执行完 script 脚本之后，下一个步骤就要去处理 micro 队列了，再往下就去执行了一次 render&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;那么我们结束了对 script 脚本的执行，紧接着就去处理 micro-task 队列，micro-task 处理完，DOM 修改好了，紧接着就可以走 render 流程了——不需要再消耗多余的一次渲染，不需要再等待一轮事件循环，直接为用户呈现最即时的更新结果。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;因此，我们更新 DOM 的时间点，应该尽可能靠近渲染的时机。当我们需要在异步任务中实现 DOM 修改时，&lt;strong class=&quot;css-0&quot;&gt;把它包装成 micro 任务是相对明智的选择&lt;/strong&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;Vue状态更新手法：nextTick&lt;/code&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《前端性能优化原理与实践》- http-存储优化]]></title><link>https://ahabhgk.github.io/读《前端性能优化原理与实践》-http-存储优化</link><guid isPermaLink="false">https://ahabhgk.github.io/读《前端性能优化原理与实践》-http-存储优化</guid><pubDate>Wed, 21 Aug 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;浏览器缓存&lt;/h2&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;浏览器缓存机制有四个方面，它们按照获取资源时请求的优先级依次排列如下：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Memory Cache&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Service Worker Cache&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;HTTP Cache&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Push Cache（HTTP2 的新特性）&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Memory Cache&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;从优先级上来说，它是浏览器最先尝试去命中的一种缓存。从效率上来说，它是响应速度最快的一种缓存。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;内存缓存是快的，也是“短命”的。它和渲染进程“生死相依”，当进程结束后，也就是 tab 关闭以后，内存里的数据也将不复存在。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;内存是有限的，很多时候需要先考虑即时呈现的内存余量，再根据具体的情况决定分配给内存和磁盘的资源量的比重——资源存放的位置具有一定的随机性。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;规律：资源存不存内存，浏览器秉承的是“节约原则”。我们发现，Base64 格式的图片，几乎永远可以被塞进 memory cache，这可以视作浏览器为节省渲染开销的“自保行为”；此外，体积不大的 JS、CSS 文件，也有较大地被写入内存的几率——相比之下，较大的 JS、CSS 文件就没有这个待遇了，内存资源是有限的，它们往往被直接甩进磁盘。&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Service Worker Cache&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Service Worker 是一种独立于主线程之外的 Javascript 线程。它脱离于浏览器窗体，因此无法直接访问 DOM。这样独立的个性使得 Service Worker 的“个人行为”无法干扰页面的性能，这个“幕后工作者”可以帮我们实现离线缓存、消息推送和网络代理等功能。我们借助 Service worker 实现的离线缓存就称为 Service Worker Cache。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://www.villainhr.com/page/2017/01/08/Service%20Worker%20%E5%85%A8%E9%9D%A2%E8%BF%9B%E9%98%B6&quot; class=&quot;css-1od09yo&quot;&gt;Service Worker 全面进阶&lt;/a&gt;&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Http Cache&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;分为强缓存和协商缓存。优先级较高的是强缓存，在命中强缓存失败的情况下，才会走协商缓存。&lt;/p&gt;&lt;style data-emotion-css=&quot;1slx2ud&quot;&gt;.css-1slx2ud{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1slx2ud{font-size:1.5rem;}}@media screen and (min-width:768px){.css-1slx2ud{font-size:1.875rem;}}&lt;/style&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;强缓存&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;利用 http 头中的 Expires 和 Cache-Control 两个字段来控制&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;强缓存中，当请求再次发出时，浏览器会根据其中的 expires 和 cache-control 判断目标资源是否“命中”强缓存，若命中则直接从缓存中获取资源，&lt;strong class=&quot;css-0&quot;&gt;不会再与服务端发生通信&lt;/strong&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:660px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:15%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAcklEQVQI14WNwQ6EIAxE/f8vJNoINmoXqUEggcCBtfFgsqedTN5pXmbovSOi1lo4Pdlw+9hD+v2XQWQAUEoZY2CCGefRjsuC1xVKKSmllznnEEJr7UcmInl2zq24EtNe95NPGcnaex9jFIovJjPXWl/5Bk+kqYnHr0jQAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;strong-cache&quot; title=&quot;strong-cache&quot; src=&quot;/static/c3d9dcef20cbd15f5082dd52d71942b2/c6e1a/strong-cache.png&quot; srcSet=&quot;/static/c3d9dcef20cbd15f5082dd52d71942b2/5243c/strong-cache.png 240w,/static/c3d9dcef20cbd15f5082dd52d71942b2/ab158/strong-cache.png 480w,/static/c3d9dcef20cbd15f5082dd52d71942b2/c6e1a/strong-cache.png 660w&quot; sizes=&quot;(max-width: 660px) 100vw, 660px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;style data-emotion-css=&quot;1g1owk0&quot;&gt;.css-1g1owk0{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1g1owk0{font-size:1.25rem;}}@media screen and (min-width:768px){.css-1g1owk0{font-size:1.5rem;}}&lt;/style&gt;&lt;h5 class=&quot;css-1g1owk0&quot;&gt;expires（http1.0）&lt;/h5&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当服务器返回响应时，在 Response Headers 中将过期时间（时间戳）写入 expires 字段&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;它最大的问题在于对“本地时间”的依赖。如果服务端和客户端的时间设置可能不同，或者我直接手动去把客户端的时间改掉，那么 expires 将无法达到我们的预期。&lt;/p&gt;&lt;h5 class=&quot;css-1g1owk0&quot;&gt;cache-control（http1.1）&lt;/h5&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;s-maxage 优先级高于 max-age，在依赖各种代理的大型架构中，我们不得不考虑代理服务器的缓存问题。s-maxage 就是用于表示 cache 服务器上（比如 cache CDN）的缓存的有效时间的，并只对 public 缓存有效&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;strong class=&quot;css-0&quot;&gt;public 与 private&lt;/strong&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果我们为资源设置了 public，那么它既可以被浏览器缓存，也可以被代理服务器缓存；如果我们设置了 private，则该资源只能被浏览器缓存。private 为默认值。但多数情况下，public 并不需要我们手动设置，比如有很多线上网站的 cache-control 是这样的：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:756px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:33.75%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAAAyklEQVQY042QUa+DIAyF9/9/4MgELCAMmVMBnTpNtnsSc+8e7oNrmqYJfD09PQkhiMgYo7XmnIcQ3l/HqWmaoiicc9ZawPsspRT6mNIB7L2HmqmskOWyLE/kE2WZHo9jZQgCrsGbaprnaZrXdR3GMcbk67BtW85DH2MfE/LW3K27DsP4gRljioixsxSisk5IKknX4aaNxQo7YKy7t93V13hKOX88wx4OhgqrXddfuMy/sw/Wxs44EmDot23HJcE/KSNKtf94/Ys/+Ae3TIxIn2R8dQAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;header&quot; title=&quot;header&quot; src=&quot;/static/58aa15d50895edba31e6604fb25d708c/ee7ce/header.png&quot; srcSet=&quot;/static/58aa15d50895edba31e6604fb25d708c/5243c/header.png 240w,/static/58aa15d50895edba31e6604fb25d708c/ab158/header.png 480w,/static/58aa15d50895edba31e6604fb25d708c/ee7ce/header.png 756w&quot; sizes=&quot;(max-width: 756px) 100vw, 756px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;设置了 s-maxage，没设置 public，那么 CDN 还可以缓存这个资源吗？答案是肯定的。因为明确的缓存信息（例如“max-age”）已表示响应是可以缓存的。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;strong class=&quot;css-0&quot;&gt;no-store与no-cache&lt;/strong&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;no-cache 绕开了浏览器：我们为资源设置了 no-cache 后，每一次发起请求都不会再去询问浏览器的缓存情况，而是直接向服务端去确认该资源是否过期（即走我们下文即将讲解的协商缓存的路线）。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;no-store 比较绝情，顾名思义就是不使用任何缓存策略。在 no-cache 的基础上，它连服务端的缓存确认也绕开了，只允许你直接向服务端发送请求、并下载完整的响应。&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;协商缓存：浏览器与服务器合作之下的缓存策略&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;协商缓存机制下，浏览器需要向服务器去询问缓存的相关信息，进而判断是重新发起请求、下载完整的响应，还是从本地获取缓存的资源。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果服务端提示缓存资源未改动（Not Modified），资源会被重定向到浏览器缓存，这种情况下网络请求对应的状态码是 304（如下图）。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:710px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:14.166666666666666%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAb0lEQVQI132LQQ6DIBAA/f/7SKoGKMvCLotYbWv0BuUBppPMYQ4zMDMRpZQAwIMvUpayvrattVZrbX8ZtNZKKWPMNE6znR84GuuI+byu/f3Zu9/OcT8jorVWRMBBXOPzcIhEnCQvIZIPQXLueTv/AFcGqTqZMwklAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;304&quot; title=&quot;304&quot; src=&quot;/static/5fb9cb2e2a002872e8fcf9953f13f161/6f406/304.png&quot; srcSet=&quot;/static/5fb9cb2e2a002872e8fcf9953f13f161/5243c/304.png 240w,/static/5fb9cb2e2a002872e8fcf9953f13f161/ab158/304.png 480w,/static/5fb9cb2e2a002872e8fcf9953f13f161/6f406/304.png 710w&quot; sizes=&quot;(max-width: 710px) 100vw, 710px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h5 class=&quot;css-1g1owk0&quot;&gt;Last-Modified&lt;/h5&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Last-Modified 是一个时间戳，如果我们启用了协商缓存，它会在首次请求时随着 Response Headers 返回：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;随后我们每次请求时，会带上一个叫 If-Modified-Since 的时间戳字段，它的值正是上一次 response 返回给它的 last-modified 值：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;服务器接收到这个时间戳后，会比对该时间戳和资源在服务器上的最后修改时间是否一致，从而判断资源是否发生了变化。如果发生了变化，就会返回一个完整的响应内容，并在 Response Headers 中添加新的 Last-Modified 值；否则，返回如上图的 304 响应，Response Headers 不会再添加 Last-Modified 字段。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;弊端：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;我们编辑了文件，但文件的内容没有改变。服务端并不清楚我们是否真正改变了文件，它仍然通过最后编辑时间进行判断。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当我们修改文件的速度过快时（比如花了 100ms 完成了改动），由于 If-Modified-Since 只能检查到以秒为最小计量单位的时间差，所以它是感知不到这个改动的——该重新请求的时候，反而没有重新请求了。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这两个场景其实指向了同一个 bug——服务器并没有正确感知文件的变化。为了解决这样的问题，Etag 作为 Last-Modified 的补充出现了。&lt;/p&gt;&lt;h5 class=&quot;css-1g1owk0&quot;&gt;Etag&lt;/h5&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Etag 是由服务器为每个资源生成的唯一的标识字符串，这个标识字符串是基于文件内容编码的，只要文件内容不同，它们对应的 Etag 就是不同的&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Etag 和 Last-Modified 类似，当首次请求时，我们会在响应头里获取到一个最初的标识符字符串，举个例子，它可以是这样的：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;那么下一次请求时，请求头里就会带上一个值相同的、名为 if-None-Match 的字符串供服务端比对了：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Etag 的生成过程需要服务器额外付出开销，会影响服务端的性能，这是它的弊端。因此启用 Etag 需要我们审时度势。正如我们刚刚所提到的——Etag 并不能替代 Last-Modified，它只能作为 Last-Modified 的补充和强化存在。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:788px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:47.91666666666667%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABSUlEQVQoz42SC6uCQBCF/f+/LSkI7YEZaqX5rFDLSie+gRW7cC93YBl3Z87ZM2e15Jd4v99yv9+l6zp5PB76PQyD/BXUrefzKW3bKoDFvixLiaJI1uu1rFYrcV1X5vO5+L6vNXq4yGDAv14vJbVOp5M2FUUheZ4raL/fjysMQ9ntdro8z5MgCGSz2Yht23K5XBQDPo5jJbUgmkaSJPKfSNP0aw8xaq0sy8bDvu/F7BmJJhMooMaZUT0NanitCuu6luPxqIR4xagATaYHAmMDvm63W/UOy8j0qEIAvOjtdlNCPMQb/MB8Yzw1XpFe8vl81jo4zr4Ip8FoGI+Sw+GgyvCLC5gEMIqY6KeHOjKPQBMbQI7j6O/Ci5pfBjWQz2YzvWyxWMhyuRxxZHqUkCdHAaYiGyIuaZpGx2Fdr1fNKDSZXoMjV1WlVnwAMrD6QIxyWV8AAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;Etag&quot; title=&quot;Etag&quot; src=&quot;/static/57318d1985f1643277492e897351b1b3/af094/Etag.png&quot; srcSet=&quot;/static/57318d1985f1643277492e897351b1b3/5243c/Etag.png 240w,/static/57318d1985f1643277492e897351b1b3/ab158/Etag.png 480w,/static/57318d1985f1643277492e897351b1b3/af094/Etag.png 788w&quot; sizes=&quot;(max-width: 788px) 100vw, 788px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;指南&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:595px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:100.83333333333333%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAEnUlEQVQ4y4WUe0zTVxTHf7YM1ClsC/vDZJhsxG0ZbgRDxliM8gfLpokI6gAZyFCBMMMEHDBZgPCmKA/HSwRsKS3QQh/QN33x64vS0hZoaSnlXRAQkE0lOLd49/v9lGQbA09yc+/N+dzvOefekwvdhV5abkQMNkdfTnKpp/Z40IQa9xa21AMZ7hQO7JFNqD6A+s9VnsC4gIz3sLHNBmAybkxLww3POt5A91QuHKuwOEGPcvgPrsr8F09jed6rHwfCgbEZPHRwH8pUU2l4tnwIV01iYBqNdD60k7k0tksDWQqzjMJVytoFKm0bX6mi92r7+BprLeLfD/lAe/95oLqF8SpjL+iLdCRjKaf+yKCC4mft7/C9n5UYWpmXFHSnKOHz8G98Dr06g0tM+fmz9JyygJS83DNFzTXBPbD50zae8lhpHdEdBSqI1JeiqOC0hbMAwBR4vqYFq7MyAJ4YAAALwGZglaOQfPm3d7ph04uBiVUAjziBwrIA1LZFMOR8Atq4cBzK9MFiV5uhCz+sacdBZm1H2qJD9OvkMPu2Vd9ZsTDGLV6ydxebtU3HULgAgjzJXEUqiSm+Q2JJGohMcROJLaul8PUl8YRSHwRxhXYzjy9LDhCFoycoImNQI7EzIu9mfnJlMy3kVn1r4BaTGvnhu720wtPkpuyYFnLuD+Mm5imrrvOsQUE5DtkGu1zXnHI3q1H6Jgqz5PqMuQ0ABForYPUZQY/KDEyzj4HE4AB+Hx31RhmVmFgCwDoAm8NgY0kFNlc0yDU5weqMZOm/Ce67/l3GJ7fJ/GRCPTWrpoWRjbRGTlEtNbOCJAyHPCEvFOpoKPWatvQkOoZYSRYdPQ25qpSZUU4GklwUpIdbIx0mVtL0KOeKiFJWIO6suKGX1l3mNV87vBVFwy8P7hfVJjDohIJ++f0b82OCKPMALbKTTDi07c4W7AIk3XkANkzg6bIKWdsBWo7VwCKg/uKy0rcWJ8RIfWsY8wwrbxwZKwDJrAxlkIT2zll5LnYjAw8NyFu+thuZ347q6GEiVs0lRmtxrIRRev5ucYzXVtBucs5xAa0kkkm9dXVARgpH+DCEj5DzGrA7VYub9+z4yhlVnA/uMeC84uqWksKqe80lNcSa8mZmYSNLffX/eKOS8m8xJG38yrQEPz5pdsNeWapL/x0pSIc0ssw0BTRji8C5CYDWvrT59n7oIOLao1d2uDwYF+K1MhImZlK3bY8Ul1mNzWeu5LsnZjf4ZVUxfIJCvj958Vq+f2ZFl290WuUR1I8IQt4BF3btZSj/lwTo4QQfi9YvaQxcdvCaFmzdlQaYRHQY6fVr08K6OQs7F/08UCY26vTugoT8H6E/13V4dD2ipSUDMAseP1CC5SkxeLqEvvwEslc8RPsUqyY6BHqthX/lj81HPd3c4sODvYmV6YcvXQj2T40/93HO9aj3Q0/6Yj2XlZnwerGUm8nQ4KQWh67Z8q5TGptC3asTCLjKbpVQy5X2DUn61KMwGXFjn3BY5NndBX/KToHM8wasZJ6SHWeY7H8hM4geKUak6/CQ+JHKLHs2OKEZQdzY53r+YuiOWn8Dyk2G+sl92h8AAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;http-cache-guide&quot; title=&quot;http-cache-guide&quot; src=&quot;/static/940cea4b40aa1b26112a229c0ad59a4b/54787/http-cache-guide.png&quot; srcSet=&quot;/static/940cea4b40aa1b26112a229c0ad59a4b/5243c/http-cache-guide.png 240w,/static/940cea4b40aa1b26112a229c0ad59a4b/ab158/http-cache-guide.png 480w,/static/940cea4b40aa1b26112a229c0ad59a4b/54787/http-cache-guide.png 595w&quot; sizes=&quot;(max-width: 595px) 100vw, 595px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当我们的资源内容不可复用时，直接为 Cache-Control 设置 no-store，拒绝一切形式的缓存；否则考虑是否每次都需要向服务器进行缓存有效确认，如果需要，那么设 Cache-Control 的值为 no-cache；否则考虑该资源是否可以被代理服务器缓存，根据其结果决定是设置为 private 还是 public；然后考虑该资源的过期时间，设置对应的 max-age 和 s-maxage 值；最后，配置协商缓存需要用到的 Etag、Last-Modified 等参数。&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Push Cache&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;https://jakearchibald.com/2017/h2-push-tougher-than-i-thought/&quot; class=&quot;css-1od09yo&quot;&gt;http2 push tougher than I thought&lt;/a&gt;&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Push Cache 是缓存的最后一道防线。浏览器只有在 Memory Cache、HTTP Cache 和 Service Worker Cache 均未命中的情况下才会去询问 Push Cache。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Push Cache 是一种存在于会话阶段的缓存，当 session 终止时，缓存也随之释放。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;不同的页面只要共享了同一个 HTTP2 连接，那么它们就可以共享同一个 Push Cache。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;本地存储&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Cookie&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Cookie 的本职工作并非本地存储，而是“维持状态”。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在 Web 开发的早期，人们亟需解决的一个问题就是状态管理的问题：HTTP 协议是一个无状态协议，服务器接收客户端的请求，返回一个响应，故事到此就结束了，服务器并没有记录下关于客户端的任何信息。那么下次请求的时候，如何让服务器知道“我是我”呢？&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在这样的背景下，Cookie 应运而生。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Cookie 说白了就是一个存储在浏览器里的一个小小的文本文件，它附着在 HTTP 请求上，在浏览器和服务器之间“飞来飞去”。它可以携带用户信息，当服务器检查 Cookie 的时候，便可以获取到客户端的状态。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:640px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:112.5%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsSAAALEgHS3X78AAADdklEQVQ4y31U+2scVRTef8r+5F9QLRRBQdESquIjtSgpCFVKrQiGlmKKdks3EVe3rTExtElTbCtFRLFSsRCTum6yu/Pa3dmZnffce+e9fnNn3KQpePZy9t6Ze+455/u+O5UxtyzL0jTNuKXckiTBfPy/Vin+KKWO49i2bVnWxHue92RAwnM8Fox9pmkqiixwk2XZMAzf9/Pde2xfKWUw9gVhmGY4OIuT1HVdXdeR/8nM6lD3fVIG4zzTsjf+bimK9Oivh81HG63mlm3ZTt5G7na2m9v/bD24/+v69eUsiQ8eP11fu1vUXyGUDobajtD76vKFY68ePnHspQ9mXh/2VUYDx3LiKPr41PGZ6RffnHr2+UMHbNN86rmp6pVl3k5aicJwe3tnZBgc8/EEP9dxPdf3XQ/A4wkjVB/omNTqVx9ubBYEVSbNcIqSCUlZmmEFn8RJFEbw+bMkjYIQfow02X+AFbthhFBjZFimbY5Mz/V8D8n93IMPJ1+inP3ByKaqQxXdD7We0pcFWRGVQV91bJfHENfxAAFxiW05lDKecMKz6+fZTKvbFURB6rYFWVTErohIRhn1KfEI8UkYhIAwieMyGKVGUdzuCMRnlEQFZqAKJYy0EbIVeip8QNnK7Z9aXYVjlFWiOLZtZ7PZ+fnenZl3jlypV681aqZhBjRAWkBwfanxdW2u8eXnjYUvtEH/6dfery6ulVSB57YgSH3t3t31995+oT5/vj4/pw81NGIaVsCCq/Vq7eKnC5fOLlTPDfu9g1PT9aUbZTCgGqgqZUG+jkui0Rs6ZPh5ZN/d+uW3+5LcK8ve+4Lfx6RQxe41ihMgxEcynpyzj6owDCGG0jBlu2IoBpaoKH8VRHk5k2DHcUGyLPckUZIlRRLkkWZAEkV52Ie0wA8oCB0BXEA5u1cSHUIGkiSDZ6Erqn0VUEFheAW5FkPXdEMzqOMyzyf8VubB4LkrSnFBPe8cCsVW3A1QVQAWhXFAo3GaXl5a+2OzWQLGgkAbGVutzs2VxdkzJz6bPVmd+2SESNuDSBgLapfOnp89+dGH028dPezZzoGX37347eoenjuCoAz+fPD76vfXbq0u37l1gwe7kBfa/vGHtdvrK4uNhQvnzsRh9Mwrb8x/8x1vJ83lia8XZewxesBOFBfYFvTk6Kb5pNlqtzsiJRTP/wXb9eqg6Pu04QAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;cookie&quot; title=&quot;cookie&quot; src=&quot;/static/9ed89cb12d2336e72408ee8c8b011ad9/1bed9/cookie.png&quot; srcSet=&quot;/static/9ed89cb12d2336e72408ee8c8b011ad9/5243c/cookie.png 240w,/static/9ed89cb12d2336e72408ee8c8b011ad9/ab158/cookie.png 480w,/static/9ed89cb12d2336e72408ee8c8b011ad9/1bed9/cookie.png 640w&quot; sizes=&quot;(max-width: 640px) 100vw, 640px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;安全&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果一个网站使用cookies作为会话标识符，攻击者可以通过窃取一套用户的cookies来冒充用户的请求。从服务器的角度，它是没法分辨用户和攻击者的，因为用户和攻击者拥有相同的身份验证&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;网络窃听：&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;网络上的流量可以被网络上任何计算机拦截，特别是未加密的开放式WIFI。这种流量包含在普通的未加密的HTTP清求上发送Cookie。在未加密的情况下，攻击者可以读取网络上的其他用户的信息，包含HTTP Cookie的全部内容，以便进行中间的攻击。比如：拦截cookie来冒充用户身份执行恶意任务（银行转账等）。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;解决办法：服务器可以设置secure属性的cookie，这样就只能通过https的方式来发送cookies了。&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;DNS 缓存中毒&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;跨站点脚本XSS&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用跨站点脚本技术可以窃取cookie。当网站允许使用javascript操作cookie的时候，就会发生攻击者发布恶意代码攻击用户的会话，同时可以拿到用户的cookie信息。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;例子：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当用户点击这个链接的时候，浏览器就会执行onclick里面的代码，结果这个网站用户的cookie信息就会被发送到abc.com攻击者的服务器。攻击者同样可以拿cookie搞事情。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;解决办法：可以通过cookie的HttpOnly属性，设置了HttpOnly属性，javascript代码将不能操作cookie。&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;跨站请求伪造CSRF&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;例如，SanShao可能正在浏览其他用户XiaoMing发布消息的聊天论坛。假设XiaoMing制作了一个引用ShanShao银行网站的HTML图像元素，例如，&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果SanShao的银行将其认证信息保存在cookie中，并且cookie尚未过期，(当然是没有其他验证身份的东西)，那么SanShao的浏览器尝试加载该图片将使用他的cookie提交提款表单，从而在未经SanShao批准的情况下授权交易。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;解决办法：增加其他信息的校验（手机验证码，或者其他盾牌）。&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Web Storage&lt;/h3&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;Local Storage 与 Session Storage 的区别&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;两者的区别在于生命周期与作用域的不同。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;生命周期：Local Storage 是持久化的本地存储，存储在其中的数据是永远不会过期的，使其消失的唯一办法是手动删除；而 Session Storage 是临时性的本地存储，它是会话级别的存储，当会话结束（页面被关闭）时，存储内容也随之被释放。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;作用域：Local Storage、Session Storage 和 Cookie 都遵循同源策略。但 Session Storage 特别的一点在于，即便是相同域名下的两个页面，只要它们不在同一个浏览器窗口中打开，那么它们的 Session Storage 内容便无法共享。&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;Web Storage 的特性：&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;存储容量大： Web Storage 根据浏览器的不同，存储容量可以达到 5-10M 之间。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;仅位于浏览器端，不与服务端发生通信。&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;应用场景&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Local Storage：图片内容丰富的电商网站会用它来存储 Base64 格式的图片字符串，有的网站还会用它存储一些不经常更新的 CSS、JS 等静态资源。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Session Storage：微博的 Session Storage 就主要是存储你本次会话的浏览足迹&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;IndexedDB&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;IndexedDB 是一个运行在浏览器上的非关系型数据库。既然是数据库了，那就不是 5M、10M 这样小打小闹级别了。理论上来说，IndexedDB 是没有存储上限的（一般来说不会小于 250M）。它不仅可以存储字符串，还可以存储二进制数据。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;IndexedDB 可以看做是 LocalStorage 的一个升级，当数据的复杂度和规模上升到了 LocalStorage 无法解决的程度，我们毫无疑问可以请出 IndexedDB 来帮忙。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在一些需要写博客的网站，比如CSDN、慕课网 都看到了有使用 IndexedDB，用 IndexedDB 来存储文章草稿似乎很合适。&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;CDN&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;CDN 的核心点有两个，一个是缓存，一个是回源。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这两个概念都非常好理解。对标到上面描述的过程，“缓存”就是说我们把资源 copy 一份到 CDN 服务器上这个过程，“回源”就是说 CDN 发现自己没有这个资源（一般是缓存的数据过期了），转头向根服务器（或者它的上层服务器）去要这个资源的过程。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;CDN 往往被用来存放静态资源。上文中我们举例所提到的“根服务器”本质上是业务服务器，它的核心任务在于生成动态页面或返回非纯静态页面，这两种过程都是需要计算的。业务服务器仿佛一个车间，车间里运转的机器轰鸣着为我们产出所需的资源；相比之下，CDN 服务器则像一个仓库，它只充当资源的“栖息地”和“搬运工”。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;所谓“静态资源”，就是像 JS、CSS、图片等不需要业务服务器进行计算即得的资源。而“动态资源”，顾名思义是需要后端实时动态生成的资源，较为常见的就是 JSP、ASP 或者依赖服务端渲染得到的 HTML 页面。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;什么是“非纯静态资源”呢？它是指需要服务器在页面之外作额外计算的 HTML 页面。具体来说，当我打开某一网站之前，该网站需要通过权限认证等一系列手段确认我的身份、进而决定是否要把 HTML 页面呈现给我。这种情况下 HTML 确实是静态的，但它和业务服务器的操作耦合，我们把它丢到CDN 上显然是不合适的。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;业务服务器的域名是这个：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;www.taobao.com&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;而 CDN 服务器的域名是这个：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;g.alicdn.com&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;再看另一方面，我们讲到 Cookie 的时候，为了凸显 Local Storage 的优越性，曾经提到过：&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Cookie 是紧跟域名的。同一个域名下的所有请求，都会携带 Cookie。大家试想，如果我们此刻仅仅是请求一张图片或者一个 CSS 文件，我们也要携带一个 Cookie 跑来跑去（关键是 Cookie 里存储的信息我现在并不需要），这是一件多么劳民伤财的事情。Cookie 虽然小，请求却可以有很多，随着请求的叠加，这样的不必要的 Cookie 带来的开销将是无法想象的……&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;同一个域名下的请求会不分青红皂白地携带 Cookie，而静态资源往往并不需要 Cookie 携带什么认证信息。把静态资源和主页面置于不同的域名下，完美地避免了不必要的 Cookie 的出现！&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《前端性能优化原理与实践》- http 请求优化]]></title><link>https://ahabhgk.github.io/读《前端性能优化原理与实践》-http-请求优化</link><guid isPermaLink="false">https://ahabhgk.github.io/读《前端性能优化原理与实践》-http-请求优化</guid><pubDate>Tue, 20 Aug 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;HTTP 优化有两个大的方向：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;减少请求次数&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;减少单次请求所花费的时间&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Http 压缩&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;HTTP 压缩就是以缩小体积为目的，对 HTTP 内容进行重新编码的过程&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;压缩 Gzip，服务端要花时间；解压 Gzip，浏览器要花时间，所以不是极端迷你的超小型文件，都建议试试 Gzip。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Gzip 并不保证针对每一个文件的压缩都会使其变小。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Gzip 压缩背后的原理，是在一个文本文件中找出一些重复出现的字符串、临时替换它们，从而使整个文件变小。根据这个原理，文件中代码的重复率越高，那么压缩的效率就越高，使用 Gzip 的收益也就越大。反之亦然。&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Gzip 对于文本文件（js、css、ttf...）收益会比较大，对于多媒体文件则没有必要采用 Gzip，因为多数多媒体文件本身就是采用了有损压缩。对有损压缩的文件再进行 Gzip，效果不显著。&lt;/p&gt;&lt;/blockquote&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Webpack 的 Gzip 和服务端的 Gzip&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一般来说，Gzip 压缩是服务器的活儿：服务器了解到我们这边有一个 Gzip 压缩的需求，它会启动自己的 CPU 去为我们完成这个任务。而压缩文件这个过程本身是需要耗费时间的，大家可以理解为我们以服务器压缩的时间开销和 CPU 开销（以及浏览器解析压缩文件的开销）为代价，省下了一些传输过程中的时间开销。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;既然存在着这样的交换，那么就要求我们学会权衡。服务器的 CPU 性能不是无限的，如果存在大量的压缩需求，服务器也扛不住的。服务器一旦因此慢下来了，用户还是要等。Webpack 中 Gzip 压缩操作的存在，事实上就是为了在构建过程中去做一部分服务器的工作，为服务器分压。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;因此，这两个地方的 Gzip 压缩，谁也不能替代谁。它们必须和平共处，好好合作。作为开发者，我们也应该结合业务压力的实际强度情况，去做好这其中的权衡。&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;图片&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;图片压缩工具：&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://tinypng.com/&quot; class=&quot;css-1od09yo&quot;&gt;https://tinypng.com/&lt;/a&gt;&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;JPEG/JPG&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;关键字：有损压缩、体积小、加载快、不支持透明&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：有损压缩。JPG的压缩方式仍然是一种高质量的压缩方式：当我们把图片体积压缩至原有体积的 50% 以下时，JPG 仍然可以保持住 60% 的品质。此外，JPG 格式以 24 位存储单个图，可以呈现多达 1600 万种颜色，足以应对大多数场景下对色彩的要求，这一点决定了它压缩前后的质量损耗并不容易被我们人类的肉眼所察觉&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：当它处理矢量图形和 Logo 等线条感较强、颜色对比强烈的图像时，人为压缩导致的图片模糊会相当明显。此外，JPEG 图像不支持透明度处理&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用场景：JPG 适用于呈现色彩丰富的图片，在我们日常开发中，JPG 图片经常作为大的背景图、轮播图或 Banner 图出现。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;PNG-8 与 PNG-24&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;关键字：无损压缩、质量高、体积大、支持透明&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：PNG（可移植网络图形格式）是一种无损压缩的高保真的图片格式。PNG 图片具有比 JPG 更强的色彩表现力，对线条的处理更加细腻，对透明度有良好的支持&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：体积太大&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用场景：呈现小的 Logo、颜色简单且对比强烈的图片或背景等。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;SVG&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;SVG（可缩放矢量图形）是一种基于 XML 语法的图像格式。它和本文提及的其它图片种类有着本质的不同：SVG 对图像的处理不是基于像素点，而是是基于对图像的形状描述。&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;关键字：文本文件、体积小、不失真、兼容性好&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：文件体积更小，可压缩性更强。作为矢量图，它最显著的优势还是在于图片可无限放大而不失真这一点上。这使得 SVG 即使是被放到视网膜屏幕上，也可以一如既往地展现出较好的成像品质——1 张 SVG 足以适配 n 种分辨率。SVG 是文本文件。我们既可以像写代码一样定义 SVG，把它写在 HTML 里、成为 DOM 的一部分，也可以把对图形的描述写入以 .svg 为后缀的独立文件（SVG 文件在使用上与普通图片文件无异）。这使得 SVG 文件可以被非常多的工具读取和修改，具有较强的灵活性。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：渲染成本比较高，SVG 存在着其它图片格式所没有的学习成本（它是可编程的）。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Base64&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Base64 并非一种图片格式，而是一种编码方式。Base64 和雪碧图一样，是作为小图标解决方案而存在的（减少 Http 请求），可使用 Webpack 的 url-loader。&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;关键字：文本文件、依赖编码、小图标解决方案&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：Base64 是一种用于传输 8Bit 字节码的编码方式，通过对图片进行 Base64 编码，我们可以直接将编码结果写入 HTML 或者写入 CSS，从而减少 HTTP 请求的次数。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：Base64 编码后，图片大小会膨胀为原文件的 4/3（这是由 Base64 的编码原理决定的）。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用场景：图片的实际尺寸很小（不超过 2kb 左右），图片无法以雪碧图的形式与其它小图结合（合成雪碧图仍是主要的减少 HTTP 请求的途径，Base64 是雪碧图的补充），图片的更新频率非常低（不需我们重复编码和修改文件内容，维护成本较低）&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;WebP&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;WebP 是今天在座各类图片格式中最年轻的一位，它于 2010 年被提出， 是 Google 专为 Web 开发的一种旨在加快图片加载速度的图片格式，它支持有损压缩和无损压缩。&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;关键字：年轻的全能型选手&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：WebP 像 JPEG 一样对细节丰富的图片信手拈来，像 PNG 一样支持透明，像 GIF 一样可以显示动态图片——它集多种图片文件格式的优点于一身。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：兼容性，WebP 还会增加服务器的负担——和编码 JPG 文件相比，编码同样质量的 WebP 文件会占用更多的计算资源。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用场景：&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在浏览器环境支持 WebP 的情况下，优先使用 WebP 格式，否则就把图片降级为 JPG 格式（本质是对图片的链接地址作简单的字符串切割）。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;此外，还有另一个维护性更强、更加灵活的方案——把判断工作交给后端，由服务器根据 HTTP 请求头部的 Accept 字段来决定返回什么格式的图片。当 Accept 字段包含 image/webp 时，就返回 WebP 格式的图片，否则返回原图。这种做法的好处是，当浏览器对 WebP 格式图片的兼容支持发生改变时，我们也不用再去更新自己的兼容判定代码，只需要服务端像往常一样对 Accept 字段进行检查即可。&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《前端性能优化原理与实践》- 开篇]]></title><link>https://ahabhgk.github.io/读《前端性能优化原理与实践》-开篇</link><guid isPermaLink="false">https://ahabhgk.github.io/读《前端性能优化原理与实践》-开篇</guid><pubDate>Mon, 19 Aug 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;从输入 URL 到页面加载完成，发生了什么？&lt;/h2&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;DNS 解析&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;TCP 连接&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;HTTP 请求抛出&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;服务端处理请求，HTTP 响应返回&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;浏览器拿到响应数据，解析响应内容，把解析的结果展示给用户&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;对应优化&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;前两个过程的优化往往需要我们和团队的服务端工程师协作完成，前端单方面可以做的努力有限，先介绍 DNS 解析和 TCP 连接&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;DNS 解析&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;浏览器 DNS 缓存和 DNS prefetch&lt;/p&gt;&lt;style data-emotion-css=&quot;1slx2ud&quot;&gt;.css-1slx2ud{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1slx2ud{font-size:1.5rem;}}@media screen and (min-width:768px){.css-1slx2ud{font-size:1.875rem;}}&lt;/style&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;DNS&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;DNS(Domain Name System, 域名系统)，是域名和 IP 地址相互映射的一个分布式数据库。DNS 查询就是将域名转换成 IP 的过程，这个过程短的话 2ms 几乎无感，长则可能达到几秒钟。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当浏览器访问一个域名的时候，需要解析一次 DNS，获得对应域名的 IP 地址。在解析过程中，按照&lt;strong class=&quot;css-0&quot;&gt;浏览器缓存、系统缓存（系统 DNS 缓存、本地 hosts（域名解析文件） 文件）、路由器缓存、ISP(运营商)DNS缓存、根域名服务器、顶级域名服务器、主域名服务器&lt;/strong&gt;的顺序，逐步读取缓存，直到拿到 IP 地址。&lt;/p&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;DNS 度量数据：chrome://histograms/DNS&lt;/p&gt;&lt;/blockquote&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;浏览器 DNS 缓存&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;浏览器DNS缓存的时间跟DNS服务器返回的TTL值无关。&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;TTL(Time-To-Live)，就是一条域名解析记录在DNS服务器中的存留时间。&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;浏览器在获取网站域名的实际IP地址后会对其IP进行缓存，减少网络请求的损耗。每种浏览器都有一个固定的DNS缓存时间，其中Chrome的过期时间是1分钟，在这个期限内不会重新请求DNS。Chrome浏览器看本身的DNS缓存时间比较方便，在地址栏输入：&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;chrome://net-internals/#dns&lt;/p&gt;&lt;/blockquote&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;DNS prefetch&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;提前解析之后可能会用到的域名，使解析结果缓存到&lt;strong class=&quot;css-0&quot;&gt;系统缓存&lt;/strong&gt;（Chromium）中，缩短DNS解析时间，来提高网站的访问速度。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;现代浏览器在 DNS Prefetch 上做了两项工作：&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;html 源码下载完成后，会解析页面的包含链接的标签，提前查询对应的域名。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于访问过的页面，浏览器会记录一份域名列表，当再次打开时，会在 html 下载的同时去解析 DNS。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;DNS预解析分为以下两种：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;自动解析&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;浏览器使用超链接的href属性来查找要预解析的主机名。当遇到a标签，浏览器会自动将href中的域名解析为IP地址，这个解析过程是与用户浏览网页并行处理的。但是为了确保安全性，在HTTPS页面中不会自动解析。&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;手动解析&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在页面添加如下标记：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;上面的link标签会让浏览器预取&amp;quot;g.alicdn.com&amp;quot;的解析&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;希望在HTTPS页面开启自动解析功能时，添加如下标记：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;希望在HTTP页面关闭自动解析功能时，添加如下标记：&lt;/p&gt;&lt;style data-emotion-css=&quot;1g1owk0&quot;&gt;.css-1g1owk0{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1g1owk0{font-size:1.25rem;}}@media screen and (min-width:768px){.css-1g1owk0{font-size:1.5rem;}}&lt;/style&gt;&lt;h5 class=&quot;css-1g1owk0&quot;&gt;使用&lt;/h5&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对静态资源域名做手动 dns prefetching。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对 js 里会发起的跳转、请求做手动 dns prefetching。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;不用对超链接做手动 dns prefetching，因为 chrome 会自动做 dns prefetching。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对重定向跳转的新域名做手动 dns prefetching，比如：页面上有个 A 域名的链接，但访问 A 会重定向到 B 域名的链接，这么在当前页对 B 域名做手动 dns prefetching 是有意义的。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h5 class=&quot;css-1g1owk0&quot;&gt;其他&lt;/h5&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;假设页面 head 里面有个 css 链接, 在当前页的 head 里加上对应的手动 dns prefetching 的 link 标签，实际上并没有好处。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;普遍来说合理的 dns prefetching 能对页面性能带来 50ms ~ 300ms 的提升，有人做了这方面的统计。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如 chromium 的官方文档所说，dns prefetching 的网络消耗是极低极低的&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如 chromium 的官方文档所说，chrome 使用 8 个线程专门做 dns prefetching 而且 chrome 本身不做 dns 记录的 cache，是直接从操作系统读 dns —— 也就是说，直接修改系统的 dns 记录或者 host 是可以直接影响 chrome 的。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;TCP 链接&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;长连接、预连接、接入 SPDY 协议（http2）&lt;/p&gt;&lt;h4 class=&quot;css-1slx2ud&quot;&gt;预连接&lt;/h4&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;preconnect 允许浏览器在一个 HTTP 请求正式发给服务器前预先执行一些操作，这包括 DNS 解析，TLS 协商，TCP 握手，这消除了往返延迟并为用户节省了时间。可以这样使用：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:724px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:41.25%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABmElEQVQY013QTWsTYRAH8P0I+g3Fm+ClB896EBH1JKjgoYooaqmKVqlFSBpiaLptIKE22W3S7Sab3WQ32ezbPK/7Mj5tUcThx8xtmPlr4yXYC5jGuROjm2BelFjw/zBGADICGagB5C8tSrMYipn91uzccI9v1vZf3tu2Hu0MHu4Ylx587594UVkgYSXnec7pBUYh0ygBSnkadlfeFvhfR+PD3UHQNLymMbvgNs3IHn1wutfmR9f39Pt3tk7ufhvc/tJ/3TrV1ApOieC5lEgZCl6UkpaS/UELKdLobOW3k6A99491c9romj9/Wb2RozkhTMLMWclpjFQiViXm/F+VVMcxYAi0oqwQjHCSSZVCmmhRRiKQQXDoTTbJ4nPfam8cuJ8644+dyaXNg/FsGSOKqmBYCiEYAFGVJIn6OeUCfePW4McVu3G1trv2uO49qxtP60PlSW34vDHc7jnv9u33uv2qZR1NlqUUlLI0TTVyHpiI/NbcehHY62Slo7q9EojqB1lV571nB+tN683emeq66S7mM98PwjD8DZqBp35a5sKqAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;preconnect&quot; title=&quot;preconnect&quot; src=&quot;/static/2f78ec6156602c2734781d6e54f10568/a579b/preconnect.png&quot; srcSet=&quot;/static/2f78ec6156602c2734781d6e54f10568/5243c/preconnect.png 240w,/static/2f78ec6156602c2734781d6e54f10568/ab158/preconnect.png 480w,/static/2f78ec6156602c2734781d6e54f10568/a579b/preconnect.png 724w&quot; sizes=&quot;(max-width: 724px) 100vw, 724px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;顺便介绍下其他 pre...&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;prefetch&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果我们确定某个资源将来一定会被使用到，我们可以让浏览器预先请求该资源并放入浏览器缓存中。例如，一个图片和脚本或任何可以被浏览器缓存的资源：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;HTTP Header: &lt;code class=&quot;css-0&quot;&gt;Link: &amp;lt;/uploads/images/pic.png&amp;gt;; rel=prefetch&lt;/code&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;与 DNS 预解析不同，预获取真正请求并下载了资源，并储存在缓存中。但预获取还依赖于一些条件，某些预获取可能会被浏览器忽略&lt;/p&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这对 webfonts 性能提升非常明显。目前，字体文件必须等到 DOM 和 CSS 构建完成之后才开始下载，使用预获取就可以轻松绕过该瓶颈。—— Bram Stein 的帖子&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这项技术有为很多有交互网站提速的潜力，但并不会应用在所有地方。对于某些站点来说，太难猜测用户下一步的动向，对于另一些站点，提前获取资源可能导致数据过期失效。还有很重要的一点，不要过早进行 prefetch，否则会降低你当前浏览的页面的加载速度 —— Google Developers&amp;quot;&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;PS：要测试资源的预获取有点困难，但在 Chrome 和 Firefox 的网络面板中都有资源预获取的记录。还需要记住，预获取的资源没有同源策略的限制。&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Prerender&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这是一个核武器，因为 prerender 可以预先加载文档的所有资源：&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Preload&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一般来说，最好使用 preload 来加载你最重要的资源，比如图像，CSS，JavaScript 和字体文件。这不要与浏览器预加载混淆，浏览器预加载只预先加载在HTML中声明的资源。preload 指令事实上克服了这个限制并且允许预加载在 CSS 和JavaScript 中定义的资源，并允许决定何时应用每个资源。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Preload 与 prefetch 不同的地方就是它专注于当前的页面，并以高优先级加载资源，Prefetch 专注于下一个页面将要加载的资源并以低优先级加载。同时也要注意 preload 并不会阻塞 window 的 onload 事件。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用 preload 指令的好处包括：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;允许浏览器来设定资源加载的优先级因此可以允许前端开发者来优化指定资源的加载。&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;赋予浏览器决定资源类型的能力，因此它能分辨这个资源在以后是否可以重复利用。&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;浏览器可以通过指定 as 属性来决定这个请求是否符合 content security policy。&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;浏览器可以基于资源的类型（比如 image/webp）来发送适当的 accept 头。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;举例&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这里有一个非常基本的预加载图像的例子：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这里有一个预加载字体的例子，记住：如果你的预加载需要 CORS 的跨域请求，那么也要加上 crossorigin 的属性。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这里有一个通过 HTML 和 JavaScript 预加载样式表的例子：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;来自 filament group 的 Scott Jehl 也有了一些相关研究并写了 async loaded styles using markup 说明了 preload 是不阻塞页面渲染的！&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;思维导图&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:60.83333333333334%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABYlAAAWJQFJUiTwAAABnElEQVQoz32SW4/UMAyF5///M16AFexc2qbNPXES20mn7TOZWRaBYJHOQxT507GPfSK6v2sj3ru4Hcx7Cjm4mAExc/QJQkYoSizD+eptqPXoyOknyRtl4uDQezOOxZrsQzSuBOCMyUMOQD7ocQzaEq6ltJzrO4wrW02FKXNJ1ACydU4qggwuOGW9dgVKN2esWtrpJpwJT7i3GoEhY3/w5oFnFefFitlkICoVM5WEWCrRythiSH2i7veAO1Cd6b+tboX2q8bzZM/CjzoXProMrBfR7XOvfNZ3j/0xc20bFbwzJdql8q+GVdoCVAttkOE2e+kx5HXWEFNlvv8W8P2EVJ0yYLynQ8d6C9sSqvJFwP4yhS+DHRQgrWvdmf4gHzDXfS3NvVwyrVvbuB6z50WG2ZSvZznK2BeBdMe/yKczrtQO+n5bdJwtjIsRnj4L9+k8CY/43OdHOvXQsB1N6DwqWVrvUSaeHAx9H31QE0uu9MzpX/DbhQCtr0PPhyeFkzaXiWaTesTfrhjxv/DbkUgfpEuLI6HjbS4ufcT80g8rAZNW9Ug6DgAAAABJRU5ErkJggg==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;mind&quot; title=&quot;mind&quot; src=&quot;/static/dafc3f2b9c32e52392a6ae0be9aed0d8/7d769/mind.png&quot; srcSet=&quot;/static/dafc3f2b9c32e52392a6ae0be9aed0d8/5243c/mind.png 240w,/static/dafc3f2b9c32e52392a6ae0be9aed0d8/ab158/mind.png 480w,/static/dafc3f2b9c32e52392a6ae0be9aed0d8/7d769/mind.png 960w,/static/dafc3f2b9c32e52392a6ae0be9aed0d8/87339/mind.png 1440w,/static/dafc3f2b9c32e52392a6ae0be9aed0d8/88b03/mind.png 1920w,/static/dafc3f2b9c32e52392a6ae0be9aed0d8/39a3d/mind.png 2478w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 适配器模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-适配器模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-适配器模式</guid><pubDate>Sun, 14 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;适配器模式别名叫包装器，作用是解决两个软件实体间的接口不兼容的问题。使用适配器模式之后，原本由于接口不兼容而不能工作的两个软件实体可以一起工作&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;通过适配器适配接口&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;假设我们正在编写一个渲染地图的页面。目前从第三方资源里获得了城市以及它们所对应的 ID，并且成功地渲染到页面中&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;之后由于更换接口，数据中城市的 ID 不一样了，我们用适配器进行适配：&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;与其他类似模式区别&lt;/h2&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;适配器模式主要用来解决两个已有接口之间不匹配的问题，它不考虑这些接口是怎样实现的，也不考虑它们将来可能会如何演化。适配器模式不需要改变已有的接口，就能够使它们协同作用&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;装饰者模式和代理模式也不会改变原有对象的接口，但装饰者模式的作用是为了给对象增加功能。装饰者模式常常形成一条长的装饰链，而适配器模式通常只包装一次。代理模式是为了控制对对象的访问，通常也只包装一次&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;外观模式的作用倒是和适配器比较相似，有人把外观模式看成一组对象的适配器，但外观模式最显著的特点是定义了一个新的接口&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 状态模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-状态模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-状态模式</guid><pubDate>Sat, 13 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;状态模式的关键是区分事物内部的状态，事物内部状态的改变往往会带来事物的行为改变&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;将状态封装成独立的类，并将请求委托给当前的状态对象，当对象的内部状态改变时，会带来不同的行为变化，我们使用的对象，在不同的状态下具有截然不同的行为，这个对象看起来是从不同的类中实例化而来的，实际上这是使用了委托的效果&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;例子&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一个电灯开关，按一下开灯，再按一下关灯&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;现在我们编写了一个状态机，简单而缜密，可惜世界上不止一种电灯，有的灯按一下开关是强光，再按一下是弱光，再按一下才关闭，如果我们进行修改，就会发现之前的代码不符合开放封闭原则&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;重构&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通常我们谈到封装，一般都会优先封装对象的行为，而不是对象的状态。但在状态模式中刚好相反，状态模式的关键是把事物的每种状态都封装成单独的类，跟此种状态有关的行为都被封装在这个类的内部&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;继续优化，console.log 所代表的一系列操作，可以使用代理模式，当访问新的状态时，由代理（Proxy 的 get）触发 console.log 等一系列操作&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;State 抽象类&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;JavaScript 中没有抽象类，我们只能这样实现&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;状态模式和策略模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;策略模式和状态模式的相同点是，它们都有一个上下文、一些策略或者状态类，上下文把请求委托给这些类来执行&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;它们之间的区别是策略模式中的各个策略类之间是平等又平行的，它们之间没有任何联系，所以客户必须熟知这些策略类的作用，以便客户可以随时主动切换算法；而在状态模式中，状态和状态对应的行为是早已被封装好的，状态之间的切换也早被规定完成，“改变行为”这件事情发生在状态模式内部。对客户来说，并不需要了解这些细节。这正是状态模式的作用所在&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;JavaScript 的状态模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用强制更改 this 指向，将状态对象的方法进行委托&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;优缺点&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;定义了状态与行为之间的关系，并将它们封装在一个类里。通过增加新的状态类，很容易增加新的状态和转换&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;避免Context无限膨胀，状态切换的逻辑被分布在状态类中，也去掉了Context中原本过多的条件分支&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;用对象代替字符串来记录当前状态，使得状态的切换更加一目了然&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Context中的请求动作和状态类中封装的行为可以非常容易地独立变化而互不影响&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;会在系统中定义许多状态类&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;由于逻辑分散在状态类中，虽然避开了不受欢迎的条件分支语句，但也造成了逻辑分散的问题，我们无法在一个地方就看出整个状态机的逻辑&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 装饰器模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-装饰器模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-装饰器模式</guid><pubDate>Fri, 12 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在程序开发中，许多时候都并不希望某个类天生就非常庞大，一次性包含许多职责。那么我们就可以使用装饰者模式。装饰者模式可以动态地给某个对象添加一些额外的职责，而不会影响从这个类中派生的其他对象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在传统的面向对象语言中，给对象添加功能常常使用继承的方式，但是继承的方式并不灵活，还会带来许多问题：一方面会导致超类和子类之间存在强耦合性，当超类改变时，子类也会随之改变；另一方面，继承这种功能复用方式通常被称为“白箱复用”，“白箱”是相对可见性而言的，在继承方式中，超类的内部细节是对子类可见的，继承常常被认为破坏了封装性，使用继承还会带来另外一个问题，在完成一些功能复用的同时，有可能创建出大量的子类，使子类的数量呈爆炸性增长&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;装饰者模式能够在不改变对象自身的基础上，在程序运行期间给对象动态地添加职责。跟继承相比，装饰者是一种更轻便灵活的做法，这是一种“即用即付”的方式&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;例子&lt;/h2&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;包装器&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;从功能上而言，decorator 能很好地描述这个模式，但从结构上看，wrapper 的说法更加贴切。装饰者模式将一个对象嵌入另一个对象之中，实际上相当于这个对象被另一个对象包装起来，形成一条包装链。请求随着这条链依次传递到所有的对象，每个对象都有处理这条请求的机会&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;JavaScript 的装饰者模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Vue 中的数组的变异方法 push() pop() shift() unshift() splice() sort() reverse()&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于对象方法的装饰，我们常会遇到 this 指向的问题&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;AOP 装饰函数&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;但有时人们并不喜欢这种原型污染，我们用函数实现&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;装饰者模式与代理模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;装饰者模式和第6章代理模式的结构看起来非常相像，这两种模式都描述了怎样为对象提供一定程度上的间接引用，它们的实现部分都保留了对另外一个对象的引用，并且向那个对象发送请求。代理模式和装饰者模式最重要的区别在于它们的意图和设计目的&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;代理模式的目的是，当直接访问本体不方便或者不符合需要时，为这个本体提供一个替代者。本体定义了关键功能，而代理提供或拒绝对它的访问，或者在访问本体之前做一些额外的事情&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;装饰者模式的作用就是为对象动态加入行为&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;代理模式强调一种关系（Proxy与它的实体之间的关系），这种关系可以静态的表达，也就是说，这种关系在一开始就可以被确定。而装饰者模式用于一开始不能确定对象的全部功能时。代理模式通常只有一层代理-本体的引用，而装饰者模式经常会形成一条长长的装饰链&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;装饰者模式是实实在在的为对象增加新的职责和行为，而代理做的事情还是跟本体一样&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 中介者模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-中介者模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-中介者模式</guid><pubDate>Thu, 11 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;中介者模式的作用就是解除对象与对象之间的紧耦合关系。增加一个中介者对象后，所有的相关对象都通过中介者对象来通信，而不是互相引用，所以当一个对象发生改变时，只需要通知中介者对象即可。中介者使各对象之间耦合松散，而且可以独立地改变它们之间的交互。中介者模式使网状的多对多关系变成了相对简单的一对多关系&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;中介者模式是迎合迪米特法则的一种实现。迪米特法则也叫最少知识原则，是指一个对象应该尽可能少地了解另外的对象（类似不和陌生人说话）。如果对象之间的耦合性太高，一个对象发生改变之后，难免会影响到其他的对象，在中介者模式里，对象之间几乎不知道彼此的存在，它们只能通过中介者对象来互相影响对方&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;例子&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;假如做一个魅族手机订购页面，我们可以选择手机颜色和购买数量，对应颜色的手机也有库存，现在客户可以选择颜色，输入数量，如果数量合理且不超过库存则可以购买，下方会显示选择的颜色和数量，可以购买时底部购买按钮才可以点击&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;现在由于 colorSelector 和 numberSelector 在变化时都要判断 canBuy，colorDisplay 依赖于 numberSelector，没有解耦，如果要增加内存的选择则要修改很多&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;引入中介者：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;之后我们想要增加需求，只需改动中介者就行&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;优缺点&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;中介者模式使各个对象之间得以解耦，以中介者和对象之间的一对多关系取代了对象之间的网状多对多关系。各个对象只需关注自身功能的实现，对象之间的交互关系交给了中介者对象来实现和维护&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;系统中会新增一个中介者对象，因为对象之间交互的复杂性，转移成了中介者对象的复杂性，使得中介者对象经常是巨大的。中介者对象自身往往就是一个难以维护的对象&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;中介者模式可以非常方便地对模块或者对象进行解耦，但对象之间并非一定需要解耦。在实际项目中，模块或对象之间有一些依赖关系是很正常的。毕竟我们写程序是为了快速完成项目交付生产，而不是堆砌模式和过度设计。关键就在于如何去衡量对象之间的耦合程度。一般来说，如果对象之间的复杂耦合确实导致调用和维护出现了困难，而且这些耦合度随项目的变化呈指数增长曲线，那我们就可以考虑用中介者模式来重构代码&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 职责链模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-职责链模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-职责链模式</guid><pubDate>Wed, 10 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系，将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;职责链模式的最大优点：请求发送者只需要知道链中的第一个节点，从而弱化了发送者和一组接收者之间的强联系&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;无论是作用域链、原型链，还是DOM节点中的事件冒泡，我们都能从中找到职责链模式的影子。职责链模式还可以和组合模式结合在一起，用来连接部件和父部件，或是提高组合对象的效率&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;一个例子&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;假设魅族 16 的网购，客户可选择订单模式，第一种是缴纳定金 500，之后则不会因为库存而买不到货，并且会获得优惠卷 200 优惠卷；第二种是缴纳定金 200，之后则不会因为库存而买不到货，并且会获得优惠卷 100 优惠卷；第三种是普通购买模式，即不交定金，可能缺货，且没有优惠卷，其中选择第一种或第二种模式后如果不交定金，则会变为第三种模式&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于客户会是怎样的购买模式，如果不使用设计模式，就会有很多分枝判断语句，而且没有解耦，不符合开封封闭原则&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当让这种情况可以用策略模式来优化，但这次来看使用职责链模式怎么优化：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;虽然相较于也一堆条件分支的结构要清晰很多，但请求在链条传递中非常僵硬，传递请求的代码耦合在业务函数中，依然违反开放封闭原则，如果有一天要增加、拆除或者移动一个节点，就必须得先砸烂这根链条&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;结果同上，而且当我们可以灵活的修改和扩展，符合开放封闭原则，比如在最开始增加一个开始判断订单类型的职责，这对用户体验可能好点：&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;异步的职责链&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在开发中，我们经常会遇到一些异步的问题，比如我们要在节点函数中发起一个 ajax 异步请求，异步请求返回的结果才能决定是否继续在职责链中 passReq，这时就不需要让节点同步的返回 nextNode，我们增加一个 next 方法，手动返回 nextNode&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在 Promise 中，resolve 就相当于 next 方法，这里我们写一个更简单的 Promise，简单到变形，但相比之前简易版的更强大（当然没有原生的强大）&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;AOP 实现职责链&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;利用JavaScript的函数式特性，有一种更加方便的方法来创建职责链&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;JavaScript 中，函数也是对象，由此让它支持异步：&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;优缺点&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;解耦了请求发送者和N个接收者之间的复杂关系，由于不知道链中的哪个节点可以处理你发出的请求，所以你只需把请求传递给第一个节点即可&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;链中的节点对象可以灵活地拆分重组。增加或者删除一个节点，或者改变节点在链中的位置都是轻而易举的事情&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可以手动指定起始节点，请求并不是非得从链中的第一个节点开始传递&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;我们不能保证某个请求一定会被链中的节点处理，在这种情况下，我们可以在链尾增加一个保底的接受者节点来处理这种即将离开链尾的请求&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使得程序中多了一些节点对象，可能在某一次的请求传递过程中，大部分节点并没有起到实质性的作用，它们的作用仅仅是让请求传递下去，从性能方面考虑，我们要避免过长的职责链带来的性能损耗&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 享元模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-享元模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-享元模式</guid><pubDate>Tue, 09 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;享元（flyweight）模式是一种用于性能优化的模式，“fly”在这里是苍蝇的意思，意为蝇量级。享元模式的核心是运用共享技术来有效支持大量细粒度的对象。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;享元模式要求将对象的属性划分为内部状态与外部状态（状态在这里通常指属性）。享元模式的目标是尽量减少共享对象的数量，关于如何划分内部状态和外部状态，下面的几条经验提供了一些指引：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;内部状态存储于对象内部。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;内部状态可以被一些对象共享。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;内部状态独立于具体的场景，通常不会改变。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;外部状态取决于具体的场景，并根据场景而变化，外部状态不能被共享。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这样一来，我们便可以把所有内部状态相同的对象都指定为同一个共享的对象。而外部状态可以从对象身上剥离出来，并储存在外部。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;剥离了外部状态的对象成为共享对象，外部状态在必要时被传入共享对象来组装成一个完整的对象。虽然组装外部状态成为一个完整对象的过程需要花费一定的时间，但却可以大大减少系统中的对象数量，相比之下，这点时间或许是微不足道的。因此，享元模式是一种用时间换空间的优化模式。&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;文件上传&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;两种上传类型：plugin、flash&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可见每个文件都要有一个 Upload 对象，当上传的文件极多时，会开销极大甚至造成内存不足&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可以用享元模式优化：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;享元模式重构之前的代码里一共创建了 6 个 upload 对象，而通过享元模式重构之后，对象的数量减少为 2，更幸运的是，就算现在同时上传 2000 个文件，需要创建的 upload 对象数量依然是 2&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;很容易让人联想到 JavaScript 的原型：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;之前虽然只有两个 upload 对象（内部状态），但对文件的描述对象（外部状态）仍然不会减少，这里的 prototype 用于做内部状态，一共也是两个，构造函数通过传参构造出外部状态&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;由此用原型模式实现了享元模式，可见很多设计模式之间是相通的，而连通它们的是为了提高代码可维护性的设计原则&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;使用场景&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一般来说，以下情况发生时便可以使用享元模式：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一个程序中使用了大量的相似对象&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;由于使用了大量对象，造成很大的内存开销&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对象的大多数状态都可以变为外部状态&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;剥离出对象的外部状态之后，可以用相对较少的共享对象取代大量对象&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;对象池&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过创建时的 create，onload 时的 recover，实现只用一个 iframe 对象在网页上创建多个 iframe，减小了空间上的损耗&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 模版方法模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-模版方法模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-模版方法模式</guid><pubDate>Mon, 08 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;模板方法模式由两部分结构组成，第一部分是抽象父类，第二部分是具体的实现子类。通常在抽象父类中封装了子类的算法框架，包括实现一些公共方法以及封装子类中所有方法的执行顺序。子类通过继承这个抽象类，也继承了整个算法结构，并且可以选择重写父类的方法。&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Coffee or Tea&lt;/h2&gt;&lt;style data-emotion-css=&quot;f4lqjx&quot;&gt;.css-f4lqjx{width:100%;margin-top:2rem;margin-bottom:2rem;border-collapse:separate;border-spacing:0;}.css-f4lqjx th,.css-f4lqjx td{text-align:left;padding-top:4px;padding-bottom:4px;padding-right:4px;padding-left:0;border-color:var(--theme-ui-colors-muted,#e2e8f0);border-bottom-style:solid;}&lt;/style&gt;&lt;table class=&quot;css-f4lqjx&quot;&gt;&lt;thead&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;18ma8h6&quot;&gt;.css-18ma8h6{vertical-align:bottom;border-bottom-width:2px;color:var(--theme-ui-colors-heading,#000);}&lt;/style&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;泡咖啡&lt;/th&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;泡茶&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;15msde0&quot;&gt;.css-15msde0{vertical-align:top;border-bottom-width:1px;}&lt;/style&gt;&lt;td class=&quot;css-15msde0&quot;&gt;泡咖啡&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;泡茶&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;把水煮沸&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;把水煮沸&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;用沸水冲泡咖啡&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;用沸水浸泡茶叶&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;把咖啡倒进杯子&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;把茶水倒进杯子&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;加糖和牛奶&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;加柠檬&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;分离逻辑共同点：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;把水烧开&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;用沸水冲泡饮料&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;把饮料倒进杯子&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;加调料&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;抽象类&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;模板方法模式是一种严重依赖抽象类的设计模式。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在 Java 中，类分为两种，一种为具体类，另一种为抽象类。具体类可以被实例化，抽象类不能被实例化。如果有人编写了一个抽象类，那么这个抽象类一定是用来被某些具体类继承的。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;抽象方法被声明在抽象类中，抽象方法并没有具体的实现过程，当子类继承了这个抽象类时，必须重写父类的抽象方法。由于 JavaScript 没有在语言层面支持抽象类，所以只能让其方法抛出错误，保证子类能重写方法&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;钩子方法&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有一些客人喝咖啡是不加调料（糖和牛奶）的。既然Beverage作为父类，已经规定好了冲泡饮料的4个步骤，那么有什么办法可以让子类不受这个约束呢？&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;放置钩子是隔离变化的一种常见手段。我们在父类中容易变化的地方放置钩子，钩子可以有一个默认的实现，究竟要不要“挂钩”，这由子类自行决定。钩子方法的返回结果决定了模板方法后面部分的执行步骤，也就是程序接下来的走向，这样一来，程序就拥有了变化的可能。&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;好莱坞原则&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;底层组件将自己挂钩到高层组件中，而高层组件会决定什么时候、以何种方式去使用这些底层组件&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;模板方法模式是好莱坞原则的一个典型使用场景，它与好莱坞原则的联系非常明显，当我们用模板方法模式编写一个程序时，就意味着子类放弃了对自己的控制权，而是改为父类通知子类，哪些方法应该在什么时候被调用。作为子类，只负责提供一些设计上的细节。除此之外，好莱坞原则还常常应用于其他模式和场景，例如发布-订阅模式和回调函数。&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;真的需要继承吗？&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在好莱坞原则的指导之下，下面这段代码可以达到和继承一样的效果。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可以看出 JavaScript 的强大灵活性：工厂创建构造函数&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在JavaScript中，我们很多时候都不需要依样画瓢地去实现一个模版方法模式，高阶函数是更好的选择&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 组合模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-组合模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-组合模式</guid><pubDate>Sun, 07 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在程序设计中，有一些和“事物是由相似的子事物构成”类似的思想。组合模式就是用小的子对象来构建更大的对象，而这些小的子对象本身也许是由更小的“孙对象”构成的。&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;组合宏命令&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;基本对象可以被组合成更复杂的组合对象，组合对象又可以被组合，这样不断递归下去，这棵树的结构可以支持任意多的复杂度。在树最终被构造完成之后，让整颗树最终运转起来的步骤非常简单，只需要调用最上层对象的 execute 方法。每当对最上层的对象进行一次请求时，实际上是在对整个树进行深度优先的搜索，而创建组合对象的程序员并不关心这些内在的细节，往这棵树里面添加一些新的节点对象是非常容易的事情。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;组合模式最大的优点在于可以一致地对待组合对象和基本对象。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;客户不需要知道当前处理的是宏命令还是普通命令，只要它是一个命令，并且有execute方法，这个命令就可以被添加到树中。&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;组合模式例子——扫描文件夹&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;扫描部分的代码很简单，跟上面的很像，这里只看删除文件夹或文件的部分&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当我们删除文件（夹）时，实际上是在它的上层文件夹中删除的，这时就需要子节点保存父节点的引用&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;很容易让人联想到 Vue 中的组件&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;注意点&lt;/h2&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;组合模式并不是父子关系：组合模式是一种 HAS-A（聚合）的关系，而不是 IS-A。组合对象包含一组叶对象，但 Leaf 并不是 Composite 的子类。组合对象把请求委托给它所包含的所有叶对象，它们能够合作的关键是拥有相同的接口。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对叶对象操作的一致性：组合模式除了要求组合对象和叶对象拥有相同的接口之外，还有一个必要条件，就是对一组叶对象的操作必须具有一致性。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;双向映射关系：有些复杂的情况我们必须给父节点和子节点创建双向映射关系，但有时这种相互间的引用相当复杂，而且对象之间产生了过多的耦合性，修改或者删除一个对象都变得困难，此时我们可以引入中介者模式来管理这些对象。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;用职责链模式提高组合模式性能：在组合模式中，如果树的结构比较复杂，节点数量很多，在遍历树的过程中，性能方面也许表现得不够理想。有时候我们确实可以借助一些技巧，在实际操作中避免遍历整棵树，有一种现成的方案是借助职责链模式。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;何时使用&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;表示对象的部分-整体层次结构：组合模式可以方便地构造一棵树来表示对象的部分-整体结构。特别是我们在开发期间不确定这棵树到底存在多少层次的时“候。在树的构造最终完成之后，只需要通过请求树的最顶层对象，便能对整棵树做统一的操作。在组合模式中增加和删除树的节点非常方便，并且符合开放-封闭原则。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;客户希望统一对待树中的所有对象：组合模式使客户可以忽略组合对象和叶对象的区别，客户在面对这棵树的时候，不用关心当前正在处理的对象是组合对象还是叶对象，也就不用写一堆if、else语句来分别处理它们。组合对象和叶对象会各自做自己正确的事情，这是组合模式最重要的能力。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;优缺点&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;组合模式可以让我们使用树形方式创建对象的结构。我们可以把相同的操作应用在组合对象和单个对象上。在大多数情况下，我们都可以忽略掉组合对象和单个对象之间的差别，从而用一致的方式来处理它们。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;它可能会产生一个这样的系统：系统中的每个对象看起来都与其他对象差不多。它们的区别只有在运行的时候会才会显现出来，这会使代码难以理解。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果通过组合模式创建了过多对象，可能会让系统负担不起&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 命令模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-命令模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-命令模式</guid><pubDate>Sat, 06 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;命令模式是最简单和优雅的模式之一，命令模式中的命令（command）指的是一个执行某些特定事情的指令。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;命令模式最常见的应用场景是：有时候需要向某些对象发送请求，但是并不知道请求的接收者是谁，也不知道被请求的操作是什么。此时希望用一种松耦合的方式来设计程序，使得请求发送者和请求接收者能够消除彼此之间的耦合关系。&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;菜单程序&lt;/h2&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;JavaScript 中的命令模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;传统 OOP 语言中，命令模式的由来，其实是回调（callback）函数的一个面向对象的替代品&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;JavaScript 作为将函数作为一等对象的语言，跟策略模式一样，命令模式也早已融入到了 JavaScript 语言之中。运算块不一定要封装在 command.execute 方法中，也可以封装在普通函数中。函数作为一等对象，本身就可以被四处传递。即使我们依然需要请求“接收者”，那也未必使用面向对象的方式，闭包可以完成同样的功能。&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;撤销与重做&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;撤销：增加一个储存状态信息的栈，比如小球移动，就要有一个储存位置的栈，撤销时就是调用移动方法把小球移动到原来的位置&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;重做：如果状态信息比较复杂，比如 Canvas 画图，可以用一个 command 栈储存命令，每次撤销就是去掉最后的命令，把栈中的命令重新执行一遍，当然性能消耗较大&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;命令队列&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当一个命令执行需要一定时间，需要命令队列&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;事件循环中的事件队列&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;浏览器的 UI 队列&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;当一个事件结束时，该如何通知队列，进行下一个任务，通常是使用异步，还可以使用发布订阅模式&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;宏命令&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;宏命令是一组命令的集合，通过执行宏命令的方式，可以一次执行一批命令&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有点像组合模式&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;事件循环的命令模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;事件队列 - 命令队列&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;宏任务 - 宏命令&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;微任务 - 命令&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;不由得又让人想到了 Promise 🤣&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Promise 中的 executor 中的任务是同步任务就同步执行，是异步就异步执行，源码就是 executor(resolve, reject) 没什么可说的，这里说一下他的微任务（then）的实现：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;熟悉事件循环的都可以看出它的执行顺序：&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;new Promise(cb)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;console.log(1) // 同时 setTimeout 在浏览器的定时器线程挂起&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;两个 then 方法把 cb &lt;strong class=&quot;css-0&quot;&gt;加入&lt;/strong&gt; onFulfilledCallbacks&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;console.log(4)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;距步骤 2 一秒后 setTimeout 把 cb 加入执行队列&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;执行队列为空，执行 cb，resolve(2)&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;resolve 时 onFulfilledCallbacks 中的 cb 依次执行&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;关键就是第 7 步中的 onFulfilledCallbacks.forEach(cb =&amp;gt; cb(self.value)) 是在 resolve 时依次全部执行了，由此实现的微任务&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 发布订阅模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-发布订阅模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-发布订阅模式</guid><pubDate>Fri, 05 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;发布—订阅模式又叫观察者模式，它定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知。在JavaScript开发中，我们一般用事件模型来替代传统的发布—订阅模式。&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;发布—订阅模式可以广泛应用于异步编程中，这是一种替代传递回调函数的方案。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;发布—订阅模式可以取代对象之间硬编码的通知机制，一个对象不用再显式地调用另外一个对象的某个接口。发布—订阅模式让两个对象松耦合地联系在一起，虽然不太清楚彼此的细节，但这不影响它们之间相互通信。当有新的订阅者出现时，发布者的代码不需要任何修改；同样发布者需要改变时，也不会影响到之前的订阅者。只要之前约定的事件名没有变化，就可以自由地改变它们。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;DOM 上的 addEventListener 简单模拟&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;DOM（document object module）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;及 document 对象，HTMLDocument 对象的一个实例&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在控制台中输入，查看其原型链（继承关系）：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;null -- Object.prototype -- EventTarget.prototype -- Node.prototype -- Document.prototype -- HTMLDocument.prototype&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;其中 addEventListener 和 removeEventListener 在 EventTarget.prototype 对象上，所以可以在 DOM 元素上使用此方法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;思路是对 onevent（onclick...）方法封装&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Promise 中的发布订阅模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这里只关注其中的发布订阅模式，不关注一些异步的处理和其他的方法，&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;&quot; class=&quot;css-1od09yo&quot;&gt;具体实现点我&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;以上只是很简单的一个实现，还很不完善&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;大体思路就是 then 方法给成功后和失败后的栈添加函数，相当于&lt;strong class=&quot;css-0&quot;&gt;订阅&lt;/strong&gt;，executer 执行中调用 resolve 或 reject，相当于&lt;strong class=&quot;css-0&quot;&gt;发布&lt;/strong&gt;，之后执行栈中的函数&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;Vue 中的发布订阅模式&lt;/h2&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Vue 源码中的 Dep&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过 addSub 方法添加 watcher 对象，由 notify 方法通知每个 watcher（订阅者），使其调用 update 方法，以此更新视图（watcher 监视可能会变化的节点，例：{{ }}、v-if... ）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;每个 Vue 实例都对应一个 Dep，所以其中的 subs 就是一个数组，而如果我们设计时，一个 Dep 可能观察多个对象，比如教务处人员会在学生挂科时通知他，这时让 sub 是一个对象&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Vue 中一种简易的状态管理方式 eventBus（总线）&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有时两个非父子组件的通信，如果项目不是很大，可以用 eventBus&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;https://cn.vuejs.org/v2/guide/migration.html#dispatch-%E5%92%8C-broadcast-%E6%9B%BF%E6%8D%A2&quot; class=&quot;css-1od09yo&quot;&gt;eventBus 状态管理&lt;/a&gt;&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;必须先订阅后发布吗？&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可以做一个队列，储存发布的消息，订阅之后执行队列就可以实现先发布后订阅了&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;JavaScript 中的发布订阅模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;其实传统 OOP 语言中的发布订阅模式与 Vue 中的比较像，是把订阅者传入到发布者中，Vue 源码由于代码量相对较大，用传统的模式会更易于维护，更加适合&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;而 addEventListener 则更贴近 JavaScript 的特性：高阶函数&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;优缺点&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;为时间上的解耦&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对象之间的解耦&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;它的应用非常广泛，既可以用在异步编程中，也可以帮助我们完成更松耦合的代码编写。发布—订阅模式还可以用来帮助实现一些别的设计模式，比如中介者模式。从架构上来看，无论是 MVC 还是 MVVM，都少不了发布—订阅模式的参与，而且JavaScript 本身也是一门基于事件驱动的语言。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;创建订阅者本身要消耗一定的时间和内存，而且当你订阅一个消息后，也许此消息最后都未发生，但这个订阅者会始终存在于内存中。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;发布—订阅模式虽然可以弱化对象之间的联系，但如果过度使用的话，对象和对象之间的必要联系也将被深埋在背后，会导致程序难以跟踪维护和理解。特别是有多个发布者和订阅者嵌套到一起的时候，要跟踪一个bug不是件轻松的事情。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 迭代器模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-迭代器模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-迭代器模式</guid><pubDate>Thu, 04 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;迭代器模式是指提供一种方法顺序访问一个聚合对象中的各个元素，而又不需要暴露该对象的内部表示。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;迭代器模式可以把迭代的过程从业务逻辑中分离出来，在使用迭代器模式之后，即使不关心对象的内部构造，也可以按顺序访问其中的每个元素。&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;内部迭代器&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;forEach, map, reduce...&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;外部迭代器&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;必须显式地请求迭代下一个元素&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;增加了调用的复杂度，但也增强了灵活性，可以手动控制迭代地过程或顺序&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;两个数组的 compare&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;简化成 ES6 常见的模拟：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;由上面 Iterator 代码可以看出一个&lt;strong class=&quot;css-0&quot;&gt;生成器生成一个迭代器对象&lt;/strong&gt;，迭代器的 next 方法进行迭代（流程控制），next 返回 value 和 done&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;ES6 迭代器&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;ES6 中的 Iterator 的作用有三个：&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;为各种数据结构，提供一个统一的、简便的访问接口&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使得数据结构的成员能够按某种次序排列&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;ES6 创造了一种新的遍历命令for...of循环，Iterator 接口主要供for...of消费。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;ES6 规定，默认的 Iterator 接口部署在数据结构的Symbol.iterator属性，或者说，一个数据结构只要具有Symbol.iterator属性，就可以认为是“可遍历的”（iterable）。Symbol.iterator属性本身是一个函数，就是当前数据结构默认的遍历器生成函数。执行这个函数，就会返回一个遍历器。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;ES6 的有些数据结构原生具备 Iterator 接口（比如数组），即不用任何处理，就可以被for...of循环遍历。原因在于，这些数据结构原生部署了Symbol.iterator属性（详见下文），另外一些数据结构没有（比如对象）。凡是部署了Symbol.iterator属性的数据结构，就称为部署了遍历器接口。调用这个接口，就会返回一个遍历器对象。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;原生具备 Iterator 接口的数据结构如下：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Array&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Map&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Set&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;String&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;TypedArray&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;函数的 arguments 对象&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;NodeList 对象&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;对象实现 for-of&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;用 generator 优化：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;其实对象本来就是无序的，完全没必要用 for-of，实现 for-of 遍历只是为了学习，更推荐用：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Object.keys()&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Object.entries()&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;for-in（可能会遍历到原型链上，更推荐前两个）&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;流程控制&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;http://es6.ruanyifeng.com/#docs/generator-async&quot; class=&quot;css-1od09yo&quot;&gt;Generator 函数的异步应用&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;a href=&quot;http://es6.ruanyifeng.com/#docs/async&quot; class=&quot;css-1od09yo&quot;&gt;async 函数&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 代理模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-代理模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-代理模式</guid><pubDate>Wed, 03 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;代理模式是为一个对象提供一个代用品或占位符，以便控制对它的访问&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;保护代理与虚拟代理&lt;/h2&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;保护代理：代理帮主体过滤掉一些请求&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;虚拟代理：把一些开销很大的对象，延迟到真正需要它的时候才去创建&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;虚拟代理实现图片预加载&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;图片加载完成前的 loading 展位图&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可进一步改进，封装成组件，暴露 setLoadingSrc 和 setSrc&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;代理和主体接口的一致性&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果有一天我们不再需要预加载图片，保证接口的一致性可以让我们在&lt;strong class=&quot;css-0&quot;&gt;任何使用代理的地方切换成本体&lt;/strong&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在 JavaScript 中，如果代理对象和本体对象都是一个函数，函数必然都能被执行，则可认为他们有一致的“接口”&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;虚拟代理合并 http 请求&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一个文件列表，点击 checkbox 上传相应文件，如果选中过快，频繁的网络请求是一笔极大的开销&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可以将多次网络请求（几秒钟内的）合并成一次，减小服务器的压力&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;缓存代理&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缓存计算结果：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;进一步解耦，修改为创建代理的工厂，更有通用性&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缓存请求：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;略&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;ES6 中的代理模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;style data-emotion-css=&quot;1od09yo&quot;&gt;.css-1od09yo{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;}.css-1od09yo:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;http://es6.ruanyifeng.com/#docs/proxy&quot; class=&quot;css-1od09yo&quot;&gt;Proxy、Reflect&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;new Proxy() 这个实例就是对象的代理&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;其他代理模式&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;防火墙代理：控制网络资源的访问，保护主题不让“坏人”接近。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;远程代理：为一个对象在不同的地址空间提供局部代表，在 Java 中，远程代理可以是另一个虚拟机中的对象。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;保护代理：用于对象应该有不同访问权限的情况。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;智能引用代理：取代了简单的指针，它在访问对象时执行一些附加操作，比如计算一个对象被引用的次数。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;写时复制代理：通常用于复制一个庞大对象的情况。写时复制代理延迟了复制的过程，当对象被真正修改时，才对它进行复制操作。写时复制代理是虚拟代理的一种变体，DLL（操作系统中的动态链接库）是其典型运用场景。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 策略模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-策略模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-策略模式</guid><pubDate>Tue, 02 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;定义一系列的算法，把它们一个个封装起来，并且使它们可以相互替换。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;“并且使它们可以相互替换”，这句话在很大程度上是相对于静态类型语言而言的。因为静态类型语言中有类型检查机制，所以各个策略类需要实现同样的接口。当它们的真正类型被隐藏在接口后面时，它们才能被相互替换。而在JavaScript这种“类型模糊”的语言中没有这种困扰，任何对象都可以被替换使用。因此，JavaScript中的“可以相互替换使用”表现为它们具有相同的目标和意图。&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;计算奖金&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;员工的奖金与他的绩效有关&lt;/p&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;第一版&lt;/h3&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;函数体庞大，包含多个判断分支&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺乏弹性，如果修改 S 的倍数，需要在内部修改，违反开放封闭原则&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可复用行差&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;策略模式重构&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;将算法的使用和算法的实现分开&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一个基于策略模式的程序至少由两部分组成。第一个部分是一组策略类，策略类封装了具体的算法，并负责具体的计算过程。 第二个部分是环境类 Context，Context 接受客户的请求，随后把请求委托给某一个策略类。要做到这点，说明 Context 中要维持对某个策略对象的引用&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;JavaScript 的策略模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;静态类型中需要通过组合，把策略（算法）封装到类中传到环境类里&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;JavaScript 函数也是对象，所以更简单和直接的做法是把strategy直接定义为函数&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有点像用一个对象做映射（map）&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;多态在策略模式中的体现&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;Context 并没有计算奖金的能力，而是把这个职责委托给了某个策略对象。每个策略对象负责的算法已被各自封装在对象内部。当我们对这些策略对象发出“计算奖金”的请求时，它们会返回各自不同的计算结果，这正是对象多态性的体现，也是“它们可以相互替换”的目的。替换Context中当前保存的策略对象，便能执行不同的算法来得到我们想要的结果。&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;策略模式实现动画&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;动画开始时，小球所在的原始位置&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;小球移动的目标位置&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;动画开始时的准确时间点&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;小球运动持续的时间&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;广义的“算法”&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;指一些业务规则&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;表单验证&lt;/h2&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;用户名不为空&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;密码长度不小于六位&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;手机号码必须符合格式&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;第一版&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;策略模式重构&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;策略：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;环境：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;调用：&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;优缺点&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;避免多个分支&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;符合开放封闭原则&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可复用&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过组合和委托代替继承，更轻便&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;程序中会有许多策略对象，但实际上比堆砌在 Context 中好&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;strategy 要向客户暴露它的所有实现，违反最少知识原则&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;一等函数对象与策略模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;除了将策略封装成对象，还可以将分散在程序中的函数作为策略进行传入&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 单例模式]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-单例模式</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-单例模式</guid><pubDate>Mon, 01 Jul 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;保证一个类仅有一个实例，并提供一个访问它的全局访问点&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;有一些对象我们往往只需要一个，比如线程池、全局缓存、浏览器中的window对象等&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;只能通过 Singleton.getInstance 来获取，不能通过 new，增加“不透明性”&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;透明的单例模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用闭包和自执行函数，阅读不方便&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;CreateDiv 的构造函数实际上负责了两件事情。第一是创建对象和执行初始化init方法，第二是保证只有一个对象。不符合“单一职责原则”&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;代理实现&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对 CreateDiv 进行解藕&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;JavaScript 中的单例模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;前面提到的几种单例模式的实现，更多的是接近传统面向对象语言中的实现，单例对象从“类”中创建而来。在以类为中心的语言中，这是很自然的做法&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;但JavaScript其实是一门无类（class-free）语言，也正因为如此，生搬单例模式的概念并无意义。在JavaScript中创建对象的方法非常简单，既然我们只需要一个“唯一”的对象，为什么要为它先创建一个“类”呢？&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;可通过命名空间和闭包防止全局变量的污染来创建单例&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;惰性单例&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;instance 实例对象总是在我们调用Singleton.getInstance 的时候才被创建，而不是在页面加载好的时候就创建&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;页面登录弹窗：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;与第一段代码一样，违反单一职责原则，不能通用于其他标签&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;通用的惰性单例&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;先对逻辑进行抽象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;抽离管理单例，封装在 getSingle 中，创建对象的具体方法 fn 作为参数传入&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;进一步简化&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;页面弹窗：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这种单例模式的用途远不止创建对象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;比如页面中一个列表，渲染完后添加事件委托，之后动态获取数据并最加渲染 li，click 事件只需第一次绑定就好&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用 jQ 的 one：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用单例：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;（这个例子有更简单方便的实现，这里只是一个例子）&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《JavaScript 设计模式与开发实践》- 设计原则]]></title><link>https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-设计原则</link><guid isPermaLink="false">https://ahabhgk.github.io/读《-java-script-设计模式与开发实践》-设计原则</guid><pubDate>Sun, 30 Jun 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;设计准则&lt;/h2&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;《UNIX/LINUX 设计哲学》&lt;/code&gt;&lt;/p&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;小即是美&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;每一个程序只做好一件事&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;快速建立原型&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;舍弃高效率而取可移植性&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;采用纯文本来存储数据（可读性，不用二进制存）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;充分利用软件的杠杆效应（软件复用）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用 shell 脚本来提杠杆效应和可移植性&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;避免强制的用户界面&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;让每个程序都称为过滤器&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;允许用户定制环境&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;尽量使操作系统内核小而轻量化&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用小写字母并尽量简短&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;沉默是金（fail 时返回 0 或空）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;各部分之和大于整体&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;寻求 90% 的解决方案&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;六大设计原则&lt;/h2&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;单一职责原则（SRP）&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;一个程序只做好一件事&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;若果功能过于复杂就拆分开，每个部分保持独立&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;并不是所有的职责都应该一一分离。一方面，如果随着需求的变化，有两个职责总是同时变化，那就不必分离他们；另一方面，职责的变化轴线仅当它们确定会发生变化时才具有意义，即使两个职责已经被耦合在一起，但它们还没有发生改变的征兆，那么也许没有必要主动分离它们，在代码需要重构的时候再进行分离也不迟&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;我们未必要在任何时候都一成不变地遵守原则。在实际开发中，因为种种原因违反 SRP 的情况并不少见。比如 jQuery 的 attr 等方法，就是明显违反SRP原则的做法。jQuery 的 attr 是个非常庞大的方法，既负责赋值，又负责取值，这对于 jQuery 的维护者来说，会带来一些困难，但对于 jQuery 的用户来说，却简化了用户的使用在方便性与稳定性之间要有一些取舍。具体是选择方便性还是稳定性，并没有标准答案，而是要取决于具体的应用环境&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：降低了单个类或者对象的复杂度，按照职责把对象分解成更小的粒度，这有助于代码的复用，也有利于进行单元测试。当一个职责需要变更的时候，不会影响到其他的职责。&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：增加编写代码的复杂度。当我们按照职责把对象分解成更小的粒度之后，实际上也增大了这些对象之间相互联系的难度&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;最少知识原则（LKP）&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;软件实体（类、对象、系统、模块、函数、变量……）应当尽可能少地与其他实体发生相互作用&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;尽量减少对象之间的交互&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;中介者模式、外观模式（定义了一个高层接口，这个接口使子系统更加容易使用）&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:42.083333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFklEQVQoz02SCaqEQAxEvf+dBK8hiIK47/uu+bxAhj/Q0+l0paqS1nnfV57n0bXvuyzLIvd96/m6Lvm+T7quk2maNDbseZ6yrqvunKlhOSS3bROIx3GUPM81JgfRcRxaiBixCZKr61pxEBKTc4ZhkDRN1c08z8IZwrZtpSzLn0t+RgLGXLFjxMQdkn3f/whYFEIOAHJiFjFOEYmiSFzXlTAMVcxG5wBgDlVVSRAEkmWZkhdFoUKAaPN/q+B93xfP85QQE2DVIX8AmqbRC2YIOWdcQYI6beMMLMVg2GmXMYDlTgnpH2eQJEmipNYyhBRwTzwMowqDZfZxHGtHPM7Pob0inwaXKAMgDwnKRo4Q7dsDYQasEf4BWJtmTqXSd04AAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;外观模式&quot; title=&quot;外观模式&quot; src=&quot;/static/95a70531cd6357f90961d5b44cf25e5b/7d769/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F.png&quot; srcSet=&quot;/static/95a70531cd6357f90961d5b44cf25e5b/5243c/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F.png 240w,/static/95a70531cd6357f90961d5b44cf25e5b/ab158/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F.png 480w,/static/95a70531cd6357f90961d5b44cf25e5b/7d769/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F.png 960w,/static/95a70531cd6357f90961d5b44cf25e5b/815f9/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F.png 1162w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;优点：减少了对象之间的依赖&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;缺点：有可能增加一些庞大到难以维护的第三者对象&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;在实际开发中，是否选择让代码符合最少知识原则，要根据具体的环境来定&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;开放封闭原则（OCP）&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;软件实体（类、模块、函数……）应该是对扩展开放，但对修改封闭&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;增加需求时，扩展新代码，而非修改已有代码&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;这是软件设计的终极目标&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;AOP、FP&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;过多的条件分支语句是造成程序违反开放-封闭原则的一个常见原因。每当需要增加一个新的if语句时，都要被迫改动原函数，利用对象的&lt;strong class=&quot;css-0&quot;&gt;多态性&lt;/strong&gt;来让程序遵守开放-封闭原则，是一个常用的技巧：&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;strong class=&quot;css-0&quot;&gt;封装变化&lt;/strong&gt;，可以把系统中稳定不变的部分和容易变化的部分隔离开来。在系统的演变过程中，我们只需要替换那些容易变化的部分，如果这些部分是已经被封装好的，那么替换起来也相对容易。而变化部分之外的就是稳定的部分。在系统的演变过程中，稳定的部分是不需要改变的&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;strong class=&quot;css-0&quot;&gt;放置挂钩（hook）&lt;/strong&gt;也是分离变化的一种方式。我们在程序有可能发生变化的地方放置一个挂钩，挂钩的返回结果决定了程序的下一步走向。这样一来，原本的代码执行路径上就出现了一个分叉路口，程序未来的执行方向被预埋下多种可能性。&lt;strong class=&quot;css-0&quot;&gt;回调函数&lt;/strong&gt;是一种特殊的挂钩。我们可以把一部分易于变化的逻辑封装在回调函数里，然后把回调函数当作参数传入一个稳定和封闭的函数中。当回调函数被执行的时候，程序就可以因为回调函数的内部逻辑不同，而产生不同的结果&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;让程序一开始就尽量遵守开放-封闭原则，并不是一件很容易的事情。一方面，我们需要尽快知道程序在哪些地方会发生变化，这要求我们有一些“未卜先知”的能力。另一方面，留给程序员的需求排期并不是无限的，所以我们可以说服自己去接受不合理的代码带来的第一次愚弄。在最初编写代码的时候，先假设变化永远不会发生，这有利于我们迅速完成需求。当变化发生并且对我们接下来的工作造成影响的时候，可以再回过头来封装这些变化的地方。然后确保我们不会掉进同一个坑里&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;里氏置换原则&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;子类能覆盖父类&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;父类能出现的地方子类就能出现&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;接口独立原则&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;保持接口的单一独立，避免出现“胖接口”&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;类似 S，关注于接口&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;依赖倒置原则&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;面对接口编程，依赖于抽象而不依赖于具体&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;使用方只关注接口而不关注具体类的实现&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;面向接口编程&lt;/h2&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;库或模块的 API&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;interface 关键字产生的完全抽象的类，专门负责类与类之间的联系&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;“面向接口编程”中的接口，更为抽象，接口是对象能响应的请求的集合&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;面向接口编程”也可以看成面向抽象编程，即针对超类型中的 abstract 方法编程，接口在这里被当成 abstract 方法中约定的契约行为。这些契约行为暴露了一个类或者对象能够做什么，但是不关心具体如何去做&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;interface 同样可以用于向上转型，这也是让对象表现出多态性的一条途径，实现了同一个接口的两个类就可以被相互替换使用&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;JavaScript 是否需要抽象类和 interface&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;抽象类和interface的作用主要都是以下两点：&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;通过向上转型来隐藏对象的真正类型，以表现对象的多态性。&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;约定类与类之间的一些契约行为。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;对于 JavaScript 而言，因为 JavaScript 是一门动态类型语言，类型本身在 JavaScript 中是一个相对模糊的概念。也就是说，不需要利用抽象类或者 interface 给对象进行“向上转型”。除了 number、string、boolean 等基本数据类型之外，其他的对象都可以被看成“天生”被“向上转型”成了 Object 类型&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;因为不需要进行向上转型，接口在 JavaScript 中的最大作用就退化到了检查代码的规范性。比如检查某个对象是否实现了某个方法，或者检查是否给函数传入了预期类型的参数。如果忽略了这两点，有可能会在代码中留下一些隐藏的 bug。比如我们尝试执行 obj 对象的 show 方法，但是 obj 对象本身却没有实现这个方法，或者 show 是 obj 的一个属性，此时我们不得不加一些防御性代码来进行判断&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;用鸭子类型进行接口检查&lt;/h3&gt;&lt;style data-emotion-css=&quot;1gtwvjp&quot;&gt;.css-1gtwvjp{border-left-color:var(--theme-ui-colors-primary,#6b46c1);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1gtwvjp p{font-style:italic;}&lt;/style&gt;&lt;blockquote class=&quot;css-1gtwvjp&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;如果它走起路来像鸭子，叫起来也像鸭子，那么它就是鸭子&lt;/p&gt;&lt;/blockquote&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;鸭子类型是动态类型语言面向对象设计中的一个重要概念。利用鸭子类型的思想，不必借助超类型的帮助，就能在动态类型语言中轻松地实现本章提到的设计原则：面向接口编程，而不是面向实现编程&lt;/p&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;23 种设计模式&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;将不变的部分和变化的部分隔开，进行封装&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;创建型&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;封装创建对象的变化&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;工厂模式（工厂方法模式、抽象工厂模式、建造者模式）&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;单例模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;原型模式&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;结构型&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;封装对象之间的组合关系&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;适配器模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;装饰器模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;代理模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;外观模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;桥接模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;组合模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;享元模式&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;行为型&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;封装对象的行为变化&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;策略模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;模版方法模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;观察之模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;迭代器模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;职责链模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;命令模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;备忘录模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;状态模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;访问者模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;中介者模式&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;解释器模式&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;面试题&lt;/h2&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;画出 UML 类图，写出代码。&lt;/p&gt;&lt;ol class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;打车时，可以打专车或者快车。任何车都有车牌号和名称。不同车价格不同，快车每公里 1 元，专车每公里 2 元。行程开始时，显示车辆信息，行程结束时，显示打车金额（假定行程就 5 公里）&lt;/li&gt;&lt;/ol&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;UML:&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:500px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:73.33333333333334%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqUlEQVQ4y41T3UuaURx+X2UfF7GLNXD5jn1cjTbYLgfbTV0Ei8HYxWDsZn+CXghjeFFtOJwXQYlQCV0EUgmGiVLq/BpLB4KKVmKJOivNTDMvLKW9nT1HxE2tth8cznl/z/k95/l9vAxzgen1+otgRqFQdDpVKpVgbm6uR6fTccvLy2KLxcLNzs6Kx8bGLlFcqVReBjGHO5zVahXPz89zWKKRkRGW4mq1upVwYmKiJ5fLlcrlcm1tba2yv79/nM/nKy6X6wnF7Xb708PDQ1IsFivxeLwC+5XJZH6Oj4/fpLjJZGJbCKenp7mtrS1KQlKpFF8qlcje3h4/MzMzCFgApe9ARqLR6GkwGDzF4xTPaTQaMY1HRq2ESPVWNpsleJVQUmpQQZBeH8WR/starUZ2dnbI7u4uoQ/iblmr1XIUN5vNrYQI6I7FYl9XVla8Gxsb3wqFwnco9iDVh42UHkGVF4R+qEwC/5FIJIyjo6PdFF9YWGCZ/7GlpSXW7XYLG58CkUjE9ff39+J8gzp4nmdDoZAQYgTIsn7JZrMxDKQzyLJlnWFdf52poqvnjhhGgEFHmcnJySaZ0+l87PV6B7E/R9Pe+ny+Fw6H487U1FQX/AMGg+E1SvEK/gGPx9OH2CsdcyuTyShhvR6omfXk5IQkk0mCetUbhX0IJeilfkwD2d7eJgcHB7SRR4uLi3dpHB74U0+pVNokRPGNaAxZX18/CgQCx/SMen3A4N+nj8BfjUQi1XA4zOOcNxqNt2kcsmDPVIjXnaTNMAEfUfQH7X4o5NHpex0KJRJJk3B1dfUNSJXpdHoI6uj64vf7nyHw+ubm5meM0DCwYeyf0OX36PK1xl/V2c5zuvxPQ7qtDrlc3iSrVqsCnIVYgsYS4h9n0WGm3U/3+vzBUE/mN8t4HTqSO/ewAAAAAElFTkSuQmCC&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;uml1&quot; title=&quot;uml1&quot; src=&quot;/static/eb93df73ed8095ef4a1edebb6bddb5ca/c6e3d/uml1.png&quot; srcSet=&quot;/static/eb93df73ed8095ef4a1edebb6bddb5ca/5243c/uml1.png 240w,/static/eb93df73ed8095ef4a1edebb6bddb5ca/ab158/uml1.png 480w,/static/eb93df73ed8095ef4a1edebb6bddb5ca/c6e3d/uml1.png 500w&quot; sizes=&quot;(max-width: 500px) 100vw, 500px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;JS:&lt;/li&gt;&lt;/ul&gt;&lt;ol start=&quot;2&quot; class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;某停车场，分 3 层，每层 100 车位。每个车位都能监控到车辆的驶入和离开。车辆进入前，显示每层的空余车位数量；车辆进入时，摄像头可识别车牌号和时间；车辆出来时，出口显示器显示车牌号和停车时长。&lt;/li&gt;&lt;/ol&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;UML：&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:858px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:58.333333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACRUlEQVQoz51SS4uSURg+831SRAsJihYNBhVDl0W0CaJNl4Fg+gOCxMzCJGjlKpCYXTgUSDmLSYySFqE/wI2gIp+iFl7xrni/38XLCKKn51jCNItieuHjnPO9533e53nOS+RyOS+TyURer5fXarW8VCoVKZVKwkKhUJATR6lU+tbpdCKJROJHtVr9Xq/X45FI5A7LJZNJ7sSAAClRxHw+p6vIZDKbLAfwU61Wiy8UCvxkMuGbzSan1+tJu93mBoMBF4/HuX6/z4EQFw6HfwF6PJ6nkLttNptfCoLwzO127wQCgYvkPyKVShFSLpd16CJAng2MLN1u153L5TYajYa4Vqu9QH4buR2we57P57fG4/FaNpu9XywWH6P5w3Q6/QhAD5xO55klKi4lAEghi06n06Vkv99/1263b7E95FCWZ1GpVPwqlUqC9XA2m1HYQReLBR2NRjQYDN5Y0cyADYWXFN2XhaFQ6J7FYtlkTcD2EGymw+GQgrGgVqsl0Wg0hcccwMsGvGwDuIaaa0tAvOirWCx2AMBPvV5PC3A9AC6DAWe1Wm9D8i3IvYn1KibhAqvRaDRi+H0eQJcgWYL6dZxFK8mvUfAZD2PA/iM6GyB545jfIvx/D9AvAPiKpgac941Go/joJYfDQQhkdOixwNg8YRcAfJqtJpNpnXl2NJh3Lpfr+m+VPPZkJVkJTz5gpt7he4sX3Ye0Kyzn8/mWg63T6c7Ckl1I3AO7N5iGPTDchSXnWB6v/e+Zgi9rbIWsv96z2Wx/nH8CCtXlM6naIzkAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;uml2&quot; title=&quot;uml2&quot; src=&quot;/static/192155656d488ca2ec51dde31f3979b1/bca77/uml2.png&quot; srcSet=&quot;/static/192155656d488ca2ec51dde31f3979b1/5243c/uml2.png 240w,/static/192155656d488ca2ec51dde31f3979b1/ab158/uml2.png 480w,/static/192155656d488ca2ec51dde31f3979b1/bca77/uml2.png 858w&quot; sizes=&quot;(max-width: 858px) 100vw, 858px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[读《高性能 JavaScript》]]></title><link>https://ahabhgk.github.io/读《高性能-java-script》</link><guid isPermaLink="false">https://ahabhgk.github.io/读《高性能-java-script》</guid><pubDate>Wed, 19 Jun 2019 16:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;1xz4htx&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#2d3748));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;1bkk5q4&quot;&gt;.css-1bkk5q4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1bkk5q4{font-size:1rem;}}@media screen and (min-width:768px){.css-1bkk5q4{font-size:1.25rem;}}&lt;/style&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:35.833333333333336%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABT0lEQVQozz2R2XKDMAxF8/9f1yadaZrCpISAweAFL2TydCpD04eLhEc6V5YPKSVSToQQ8M5jjcEZu53ldZWY2WsyWWK0huQs9n6jPr3jpmmvKzWiQ9s01Jdv6q8L6tpg7oqhaUnaEGdHjpFVGnKK5FmzaNE4MNfSczpiJX/BNmB3a/l8P3E+fdBUNVHP+HEm9aVxInYaX6bXI0H3eC/RDeixRQ93gRTDx24qtziUzyyuBax6hZ/lygWUMo/nk84sVLeea9ejZBUxenKQuFgW7+Q/omVyNRQzvwPLBI0aOH7XvF0qfoynE/BdplUxs+aVJXlcdJI/tp1Zbxllam1H6qbi2lyxzuzA4rIIdJJH0dbhQvxX2Uv+24+LFuMnBtMzCcjJlPVPxfnySa96YSwctobygqJ1lWuK+1ryP71gr5oQAyEtqKlANdqIpnE7L3W/Yp8QyAFt9/oAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;高性能 JavaScript&quot; title=&quot;高性能 JavaScript&quot; src=&quot;/static/bf32a44416b5e00da42058d7c763f97d/7d769/%E9%AB%98%E6%80%A7%E8%83%BDJavaScript.png&quot; srcSet=&quot;/static/bf32a44416b5e00da42058d7c763f97d/5243c/%E9%AB%98%E6%80%A7%E8%83%BDJavaScript.png 240w,/static/bf32a44416b5e00da42058d7c763f97d/ab158/%E9%AB%98%E6%80%A7%E8%83%BDJavaScript.png 480w,/static/bf32a44416b5e00da42058d7c763f97d/7d769/%E9%AB%98%E6%80%A7%E8%83%BDJavaScript.png 960w,/static/bf32a44416b5e00da42058d7c763f97d/87339/%E9%AB%98%E6%80%A7%E8%83%BDJavaScript.png 1440w,/static/bf32a44416b5e00da42058d7c763f97d/39a40/%E9%AB%98%E6%80%A7%E8%83%BDJavaScript.png 1874w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;style data-emotion-css=&quot;1bzbprl&quot;&gt;.css-1bzbprl{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:0.5rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1bzbprl{font-size:2.25rem;}}@media screen and (min-width:768px){.css-1bzbprl{font-size:3rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;加载与执行&lt;/h2&gt;&lt;style data-emotion-css=&quot;1u9n620&quot;&gt;.css-1u9n620{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:1rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-1u9n620{font-size:1.875rem;}}@media screen and (min-width:768px){.css-1u9n620{font-size:2.25rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;放到 body 底部&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;脚本解析和执行会阻塞页面渲染&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;减少脚本(请求)数量&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;脚本的 defer, async 属性&lt;/h3&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;都是并行下载，不阻塞页面，defer 需等页面加载好后执行，async 是自动执行defer 属性的脚本标签可以放到文档任何位置&lt;/p&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;脚本的懒加载&lt;/h3&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;数据存取&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;作用域链(执行上下文栈)&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;原型链&lt;/h3&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;DOM 编程&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;访问和修改 DOM 消耗大&lt;/h3&gt;&lt;style data-emotion-css=&quot;15rlv7r&quot;&gt;.css-15rlv7r li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width:768px){.css-15rlv7r li{font-size:1.25rem;}}&lt;/style&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;尽可能少的访问和修改 DOM&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;innerHTML = 和 +=&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;每次 += 都会访问修改 DOM，而把要改的内容赋给 html 字符串变量，之后一次性赋给 innerHTML 只会访问修改一次 DOM&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;HTMLCollection 与 NodeList&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;HTMLCollection 是动态的(实时性)，实时访问 DOM，消耗大，NodeList 是静态的，不需要实时访问DOMgetElementBy 方式返回 HTMLCollection，查找快但之后操作慢，querySelector 方式返回 NodeList，以 CSS 选择器查找，查找慢但之后操作快，且数据是有不变性的&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;过滤没用节点&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;childNodes, firstChild, nextSibling 不区分元素节点和其他节点(注释、文本节点)，children 只包含元素节点&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;回流和重绘&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;页面渲染流程&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;浏览器队列修改批量执行来优化回流&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;强制刷新对列的方法：offsetTop, offsetLeft, offsetWidth, offsetHeight, scrollTop, scrollLeft, scrollWidth, scrollHeight, clientTop, clientLeft, clientWidth, clientHeight, getComputedStyle()&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;最小化回流和重绘&lt;/p&gt;&lt;p class=&quot;css-1bkk5q4&quot;&gt;cssText += ，修改 class内存中批量修改 DOM(1 createDocumentFragment, createElement  2 隐藏元素修改后重新显示 el.style.display: none  3 cloneNode 修改后替换原有元素)缓存布局信息(offsetLeft……)元素脱离文档流(position)&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;事件委托&lt;/h3&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;算法和流程控制&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;for of 循环数组，for in 遍历对象&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;1.多个离散判断用 switch 2.嵌套 if 3.查找表映射&lt;/h3&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;1.递归做缓存 2.es6 尾递归&lt;/h3&gt;&lt;h2 class=&quot;css-1bzbprl&quot;&gt;UI 界面&lt;/h2&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;浏览器 UI 线程，事件队列&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;单线程&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;定时器异步执行&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;如果时间队列中已经存在由同一个 setInterval 创建的任务，那么后续任务不会被添加&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;高频率多个定时器影响性能(最好间隔1秒以上)&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;css-1u9n620&quot;&gt;Web Worker&lt;/h3&gt;&lt;ul class=&quot;css-15rlv7r&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;处理大量数据，复杂数学运算(图像、视频)，处理数组……&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Worker 对象，onmessage 接受信息，postMessage 传递数据&lt;/li&gt;&lt;/ul&gt;</content:encoded></item></channel></rss>